const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/utils-Dc41pFlL.js","assets/excel-G1qE2FwJ.js"])))=>i.map(i=>d[i]);
import{p as No,a as Rr,n as _,o as Po,l as Ae,j as g,u as e,b as Lo,i as Oo,s,d as re,t as F,h as L,e as b,g as Go,M as Ee,N as qe,m as o,f as $r,v as r,A as ve,F as ge,O as Et,P as Je,Q as Ro,k as y,x as c,y as x,q as ye,R as pr,D as yr,r as ur,S as bt,T as vt,c as mt,H as Cr,C as Mt,z as zt,U as At,V as Tt,W as Ht,X as jt}from"./svelte-CFZEjrxY.js";import{S as Ge}from"./ui-CHfsb5jC.js";import{g as gt,W as Vo,S as po,a as Uo,b as Wo,c as qo,p as Wr,L as _t,I as dt,U as Rt,s as Nt}from"./Loader-DZc-WlDL.js";import{e as kt,F as xt,t as ft}from"./index-DpeCngsV.js";import{_ as ht}from"./pdf-CBBHH09D.js";var Pt=y('<div class="flex-1 flex items-center justify-center"><div class="text-center"><div class="animate-spin w-8 h-8 border-4 border-indigo-500 border-t-transparent rounded-full mx-auto mb-4"></div> <p>Cargando datos...</p></div></div>'),Lt=y('<span class="ml-2 px-2 py-1 text-xs bg-indigo-100 dark:bg-indigo-900 text-indigo-800 dark:text-indigo-200 rounded-full">Activos</span>'),Ot=y("<option> </option>"),Gt=y("<option> </option>"),Vt=y('<p class="text-[10px] sm:text-xs text-amber-600 dark:text-amber-400 mt-1">Este docente no tiene registros de materias</p>'),Ut=y("<option> </option>"),Wt=y('<p class="text-[10px] sm:text-xs text-amber-600 dark:text-amber-400 mt-1">No hay grados para los filtros seleccionados</p>'),qt=y("<option> </option>"),Jt=y('<p class="text-[10px] sm:text-xs text-amber-600 dark:text-amber-400 mt-1">No hay motivos para los filtros seleccionados</p>'),Yt=y('<div class="flex-1 flex items-center justify-center"><div class="text-center py-12 px-4"><svg class="w-16 h-16 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <p class="text-sm sm:text-base">No se encontraron registros con los filtros seleccionados</p></div></div>'),Kt=y('<button class="text-indigo-600 dark:text-indigo-400 hover:underline font-medium text-left truncate w-full"> </button>'),Xt=y('<tr class="border-b transition-colors hover:bg-black/5 dark:hover:bg-white/5 text-xs"><td class="p-2"> </td><td class="p-2 truncate max-w-[150px]"> </td><td class="p-2 truncate max-w-[150px]"> </td><td class="p-2 text-center"> </td><td class="p-2 truncate max-w-[150px]"><!></td><td class="p-2 text-center"><span><span> </span> </span></td><td class="p-2 text-center"> </td><td class="p-2"><span class="truncate block max-w-xs text-xs"> </span></td></tr>'),Zt=y('<button class="text-indigo-600 dark:text-indigo-400 hover:underline font-medium text-left truncate w-full"> </button>'),Qt=y('<tr class="border-b transition-colors hover:bg-black/5 dark:hover:bg-white/5 text-xs"><td class="p-2 whitespace-nowrap"> </td><td class="p-2"><span class="truncate block max-w-[120px]"> </span></td><td class="p-2 truncate max-w-[120px]"> </td><td class="p-2"><span class="truncate block max-w-[100px]"><!></span></td><td class="p-2 text-center"><span><span> </span> </span></td><td class="p-2 whitespace-nowrap text-center"> </td><td class="p-2 whitespace-nowrap text-center"> </td></tr>'),ea=y('<button class="font-semibold text-xs text-indigo-600 dark:text-indigo-400 truncate hover:underline text-left w-full"> </button>'),ra=y('<p class="font-semibold text-xs text-indigo-600 dark:text-indigo-400 truncate"> </p>'),oa=y('<div class="text-[10px] p-1.5 rounded"><div class="flex items-start"><svg class="w-3 h-3 mr-1 mt-0.5 flex-shrink-0 opacity-60" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <span class="line-clamp-1"> </span></div></div>'),ta=y('<div class="border rounded-lg p-2 transition-colors hover:bg-black/5 dark:hover:bg-white/5"><div class="flex justify-between items-center mb-1.5"><div class="flex-1 min-w-0"><!> <p class="text-[10px] opacity-75"> </p></div> <div class="flex flex-col items-end ml-2 flex-shrink-0"><span><span> </span> </span> <span class="text-[10px] font-semibold"> </span></div></div> <div class="flex gap-3 text-[10px] mb-1.5"><div class="flex items-center flex-1 min-w-0"><svg class="w-3 h-3 mr-1 opacity-60 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg> <span class="truncate"> </span></div> <div class="flex items-center flex-1 min-w-0"><svg class="w-3 h-3 mr-1 opacity-60 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg> <span class="truncate"> </span></div></div> <!></div>'),aa=y('<div class="hidden lg:flex flex-1 flex-col overflow-hidden min-h-0"><div class="flex-1 overflow-auto min-w-full border rounded-lg"><table class="w-full border-collapse text-sm min-w-[800px]"><thead class="sticky top-0 z-10 border-b"><tr><th class="text-left p-2 font-semibold whitespace-nowrap">Fecha</th><th class="text-left p-2 font-semibold whitespace-nowrap">Docente</th><th class="text-left p-2 font-semibold whitespace-nowrap">Materia</th><th class="text-center p-2 font-semibold whitespace-nowrap">Grado</th><th class="text-left p-2 font-semibold whitespace-nowrap">Estudiante</th><th class="text-center p-2 font-semibold whitespace-nowrap">Motivo</th><th class="text-center p-2 font-semibold whitespace-nowrap">Horas</th><th class="text-left p-2 font-semibold whitespace-nowrap">Observaciones</th></tr></thead><tbody></tbody></table></div></div> <div class="hidden md:flex lg:hidden flex-1 overflow-auto"><div class="min-w-full border rounded-lg"><table class="w-full border-collapse text-xs"><thead class="sticky top-0 z-10 border-b"><tr><th class="text-left p-2 font-semibold whitespace-nowrap">Fecha</th><th class="text-left p-2 font-semibold whitespace-nowrap">Docente</th><th class="text-left p-2 font-semibold whitespace-nowrap">Materia</th><th class="text-left p-2 font-semibold whitespace-nowrap">Estudiante</th><th class="text-center p-2 font-semibold whitespace-nowrap">Motivo</th><th class="text-center p-2 font-semibold whitespace-nowrap">Horas</th><th class="text-center p-2 font-semibold whitespace-nowrap">Grado</th></tr></thead><tbody></tbody></table></div></div> <div class="flex-1 overflow-y-auto md:hidden px-1"><div class="space-y-2"></div></div>',1),sa=y('<div class="p-3 sm:p-4 border-b"><div class="flex items-center justify-between mb-2 sm:mb-3"><h3 class="text-lg font-semibold">Filtros <!></h3> <button class="text-sm px-3 py-1 rounded-lg border transition-colors hover:bg-black/5 dark:hover:bg-white/5">Limpiar filtros</button></div> <div class="mb-3 p-1.5 sm:p-2 bg-indigo-50 dark:bg-indigo-900/20 rounded-lg"><p class="text-[10px] sm:text-xs font-medium mb-1.5">R√°pido: Fechas</p> <div class="flex items-center mb-2"><input id="checkFiltrarFecha" type="checkbox" class="w-4 h-4 rounded text-indigo-600 focus:ring-indigo-500 border-gray-300 dark:border-gray-600 dark:bg-zinc-700"/> <label for="checkFiltrarFecha" class="ml-2 text-xs font-medium">Activar filtro por fechas</label></div> <div class="flex flex-wrap gap-1 sm:gap-2"><button class="text-[10px] sm:text-xs px-1.5 sm:px-2 py-1 bg-white dark:bg-zinc-800 border rounded hover:bg-indigo-100 dark:hover:bg-indigo-800/50 transition-colors">Hoy</button> <button class="text-[10px] sm:text-xs px-1.5 sm:px-2 py-1 bg-white dark:bg-zinc-800 border rounded hover:bg-indigo-100 dark:hover:bg-indigo-800/50 transition-colors">√öltimos 7 d√≠as</button> <button class="text-[10px] sm:text-xs px-1.5 sm:px-2 py-1 bg-white dark:bg-zinc-800 border rounded hover:bg-indigo-100 dark:hover:bg-indigo-800/50 transition-colors">√öltimos 30 d√≠as</button> <button class="text-[10px] sm:text-xs px-1.5 sm:px-2 py-1 bg-white dark:bg-zinc-800 border rounded hover:bg-indigo-100 dark:hover:bg-indigo-800/50 transition-colors">Mes actual</button> <button class="text-[10px] sm:text-xs px-1.5 sm:px-2 py-1 bg-white dark:bg-zinc-800 border rounded hover:bg-indigo-100 dark:hover:bg-indigo-800/50 transition-colors">√öltimo trimestre</button></div></div> <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4"><div class="flex gap-3 sm:gap-4"><div class="flex-1 space-y-1.5 sm:space-y-2"><label for="filtroDocente" class="block text-xs sm:text-sm font-medium">Docente</label> <select id="filtroDocente" class="w-full px-2 sm:px-3 py-1.5 sm:py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none text-xs sm:text-sm"><option>Todos los docentes</option><!></select></div> <div class="flex-1 space-y-1.5 sm:space-y-2"><label for="filtroMateria" class="block text-xs sm:text-sm font-medium"> </label> <select id="filtroMateria" class="w-full px-2 sm:px-3 py-1.5 sm:py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none text-xs sm:text-sm"><option> </option><!></select> <!></div></div> <div class="flex gap-3 sm:gap-4"><div class="flex-1 space-y-1.5 sm:space-y-2"><label for="filtroGrado" class="block text-xs sm:text-sm font-medium"> </label> <select id="filtroGrado" class="w-full px-2 sm:px-3 py-1.5 sm:py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none text-xs sm:text-sm"><option> </option><!></select> <!></div> <div class="flex-1 space-y-1.5 sm:space-y-2"><label for="filtroMotivo" class="block text-xs sm:text-sm font-medium">Motivo</label> <select id="filtroMotivo" class="w-full px-2 sm:px-3 py-1.5 sm:py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none text-xs sm:text-sm"><option> </option><!></select> <!></div></div> <div class="flex gap-3 sm:gap-4"><div class="flex-1 space-y-1.5 sm:space-y-2"><label for="filtroFechaInicio" class="block text-xs sm:text-sm font-medium">Fecha desde</label> <input id="filtroFechaInicio" type="date" class="w-full px-2 sm:px-3 py-1.5 sm:py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none text-xs sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"/></div> <div class="flex-1 space-y-1.5 sm:space-y-2"><label for="filtroFechaFin" class="block text-xs sm:text-sm font-medium">Fecha hasta</label> <input id="filtroFechaFin" type="date" class="w-full px-2 sm:px-3 py-1.5 sm:py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none text-xs sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"/></div></div></div></div> <div class="flex-1 flex flex-col p-2 sm:p-4 min-h-0"><div class="mb-4 px-0 sm:px-3"><p class="text-sm">Se encontraron <span class="font-bold text-indigo-500"> </span> registros</p></div> <!></div>',1),la=y('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4" role="button" tabindex="0" aria-label="Cerrar ventana"><div class="w-full max-w-7xl max-h-[95vh] bg-white dark:bg-zinc-900 rounded-2xl shadow-2xl overflow-hidden flex flex-col"><div class="flex items-center justify-between p-3 sm:p-4 border-b"><div class="flex items-center gap-3"><img alt="EIE Logo" class="h-8 w-auto hidden sm:block"/> <div><h2 class="text-lg sm:text-xl font-bold">Inasistencias</h2> <p class="text-xs hidden sm:block">Filtra y consulta los registros</p></div></div> <div class="flex items-center gap-3"><button class="inline-flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> Exportar CSV</button> <button class="p-2 rounded-lg transition-colors hover:bg-black/5 dark:hover:bg-white/5" aria-label="Cerrar"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div></div> <div class="flex-1 overflow-hidden flex flex-col min-h-0"><!></div></div></div>');function na(Ir,cr){No(cr,!1);const m=_(),Ye=_(),$e=_(),v=_(),t=_();let _e=Rr(cr,"onClose",8),a=Rr(cr,"selectedDocente",8,""),q=_([]),Re=[],Ve=[],dr=[],ke=_(!1),T=_(!1),G=_([]),i=_({docente:a()||"",materia:"",grado:"",fechaInicio:"",fechaFin:"",motivo:""});const or=()=>{const d=new Date,h=new Date(d.getFullYear(),d.getMonth()-1,d.getDate()),$=w=>{const A=w.getFullYear(),E=String(w.getMonth()+1).padStart(2,"0"),K=String(w.getDate()).padStart(2,"0");return`${A}-${E}-${K}`};Ee(i,e(i).fechaInicio=$(h)),qe(()=>{e(t),e(u),e(m),e($e),e(v)}),Ee(i,e(i).fechaFin=$(d)),qe(()=>{e(t),e(u),e(m),e($e),e(v)})},pe=d=>{const h=new Date;let $;switch(d){case"hoy":$=new Date(h);break;case"semana":$=new Date(h),$.setDate(h.getDate()-7);break;case"mes":$=new Date(h),$.setDate(h.getDate()-30);break;case"mes_actual":$=new Date(h.getFullYear(),h.getMonth(),1);break;case"trimestre":$=new Date(h),$.setDate(h.getDate()-90);break;default:or();return}const w=A=>{const E=A.getFullYear(),K=String(A.getMonth()+1).padStart(2,"0"),me=String(A.getDate()).padStart(2,"0");return`${E}-${K}-${me}`};Ee(i,e(i).fechaInicio=w($)),qe(()=>{e(t),e(u),e(m),e($e),e(v)}),Ee(i,e(i).fechaFin=w(h)),qe(()=>{e(t),e(u),e(m),e($e),e(v)}),g(T,!0),console.log("‚úÖ setFechaPreset ejecutado:",{preset:d,fechaInicio:e(i).fechaInicio,fechaFin:e(i).fechaFin,filtrarPorFecha:e(T)})},Me=[{value:"Sin excusa",icon:"üö´",color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"},{value:"Excusa",icon:"üìÑ",color:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"},{value:"LLegada Tarde",icon:"‚è∞",color:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200"},{value:"Transporte Escolar",icon:"üöå",color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"},{value:"Permiso",icon:"‚úÖ",color:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"},{value:"No portar/sin uniforme",icon:"üëö",color:"bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-200"},{value:"Pacto de Aula",icon:"ü§ù",color:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200"},{value:"Uso del celular",icon:"üì±",color:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200"},{value:"Desorden en Clase",icon:"üîä",color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"},{value:"Fuga",icon:"üèÉ‚Äç‚ôÇÔ∏è",color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"},{value:"No realizaci√≥n de Aseo",icon:"üßπ",color:"bg-teal-100 text-teal-800 dark:bg-teal-900 dark:text-teal-200"},{value:"Licencia por salud",icon:"üè•",color:"bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-200"},{value:"Incapacidad",icon:"ü©∫",color:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200"},{value:"Reuni√≥n interna",icon:"üë•",color:"bg-zinc-100 text-zinc-800 dark:bg-zinc-900 dark:text-zinc-200"},{value:"Psicoorientaci√≥n",icon:"üß†",color:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"}],he=d=>Me.find(h=>h.value===d)||{icon:"‚ùì",color:"bg-gray-100 text-gray-800"};let u=_([]),P=_([]),Ue=_([]),tr=_([]);const Ke=d=>{if(!d)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(d))return d;const h=d.split("/");if(h.length===3){const w=h[0].padStart(2,"0"),A=h[1].padStart(2,"0");return`${h[2].length===2?`20${h[2]}`:h[2]}-${A}-${w}`}const $=new Date(d);if(!isNaN($.getTime())){const w=$.getFullYear(),A=String($.getMonth()+1).padStart(2,"0"),E=String($.getDate()).padStart(2,"0");return`${w}-${A}-${E}`}return d},V=async()=>{g(ke,!0);try{const[d,h,$,w]=await Promise.all([gt({spreadsheetId:po,worksheetTitle:Vo}),Uo(),Wo(),qo()]);console.log("Respuesta cruda de inasistencias:",d),console.log("Tipo de dato:",typeof d),console.log("Es array:",Array.isArray(d)),d&&typeof d=="object"&&console.log("Keys:",Object.keys(d));const A=D=>{if(!D?.records||!Array.isArray(D.records))return[];const ze=D.records[0]?.values||[];return D.records.slice(1).map(Be=>{const N=Be.values||[];return{timestamp:N[0]||"",docente:N[1]||"",fecha:N[2]||"",horas:N[3]||"",materia:N[4]||"",motivo:N[5]||"",grado:N[6]||"",nombre:N[7]||"",observaciones:N[8]||""}}).filter(Be=>Be.docente&&Be.fecha)},E=D=>Array.isArray(D)?D:D?.data&&Array.isArray(D.data)?D.data:D?.rows&&Array.isArray(D.rows)?D.rows:D?.values&&Array.isArray(D.values)?D.values:D?.inasistencias&&Array.isArray(D.inasistencias)?D.inasistencias:[];g(q,A(d)),Re=E(h),Ve=E($),dr=E(w),g(u,e(q).length>0?[...new Set(e(q).map(D=>D.docente).filter(Boolean))].sort():[]),g(P,e(q).length>0?[...new Set(e(q).map(D=>D.materia).filter(Boolean))].sort():[]);const K=[...new Set(dr.map(D=>(typeof D=="string"?D:D.grado||"").toString()).filter(Boolean))],me=e(q).length>0?e(q).map(D=>D.grado).filter(Boolean):[];g(Ue,[...new Set([...K,...me])].sort((D,ze)=>{const He=parseInt(D),Be=parseInt(ze);return!isNaN(He)&&!isNaN(Be)?He-Be:D.localeCompare(ze)})),g(tr,e(q).length>0?[...new Set(e(q).map(D=>D.motivo).filter(Boolean))].sort():[]),or(),console.log("Datos cargados:",{inasistencias:e(q).length,docentes:Re.length,docentesUnicos:e(u).length,materiasUnicas:e(P).length,gradosUnicos:e(Ue).length,motivosUnicos:e(tr).length})}catch(d){console.error("Error cargando datos:",d),await Ge.fire({icon:"error",title:"Error",text:"No se pudieron cargar los datos de inasistencias",confirmButtonColor:"#ef4444"})}finally{g(ke,!1)}},ne=()=>{g(i,{docente:a()||"",materia:"",grado:"",fechaInicio:"",fechaFin:"",motivo:""}),or(),g(T,!1)},I=()=>{if(e(G).length===0){Ge.fire({icon:"warning",title:"Sin datos",text:"No hay datos para exportar",confirmButtonColor:"#f59e0b"});return}const h=[["Fecha","Docente","Materia","Grado","Estudiante","Motivo","Horas","Observaciones"].join(","),...e(G).map(E=>[E.fecha,`"${E.docente}"`,`"${E.materia}"`,E.grado,`"${E.nombre}"`,`"${E.motivo}"`,E.horas,`"${E.observaciones}"`].join(","))].join(`
`),$=new Blob([h],{type:"text/csv;charset=utf-8;"}),w=document.createElement("a"),A=URL.createObjectURL($);w.setAttribute("href",A),w.setAttribute("download",`inasistencias_${new Date().toISOString().split("T")[0]}.csv`),w.style.visibility="hidden",document.body.appendChild(w),w.click(),document.body.removeChild(w)},O=d=>{try{const[h,$,w]=d.split("-");return h&&$&&w?`${w}/${$}/${h}`:d}catch{return d}},ae=d=>{if(!e(i).docente||!e(i).materia||!e(i).grado)return;const $=e(q).filter(A=>{if(A.nombre!==d||A.docente!==e(i).docente||A.materia!==e(i).materia||A.grado!==e(i).grado)return!1;if(e(T)){const E=Ke(A.fecha);if(e(i).fechaInicio&&E<e(i).fechaInicio||e(i).fechaFin&&E>e(i).fechaFin)return!1}return!0}).reduce((A,E)=>{const K=parseInt(E.horas)||0;return A+K},0);let w="";e(T)&&e(i).fechaInicio&&e(i).fechaFin?w=`entre ${O(e(i).fechaInicio)} y ${O(e(i).fechaFin)}`:w="en total (hist√≥rico)",Ge.fire({icon:"info",title:d,html:`
        <div class="text-left space-y-2">
          <p><strong>Materia:</strong> ${e(i).materia}</p>
          <p><strong>Total inasistencias:</strong> ${$} horas</p>
          <p class="text-sm text-gray-500 text-center mt-4">(${w})</p>
        </div>
      `,confirmButtonColor:"#4f46e5"})};Po(()=>{V()}),Ae(()=>(e(i),e(q),e(P)),()=>{g(m,e(i).docente?[...new Set(e(q).filter(d=>d.docente===e(i).docente).map(d=>d.materia).filter(Boolean))].sort():e(P))}),Ae(()=>(e(i),e(q),e(Ue)),()=>{g(Ye,e(i).docente?[...new Set(e(q).filter(d=>d.docente===e(i).docente).map(d=>d.grado).filter(Boolean))].sort((d,h)=>{const $=parseInt(d),w=parseInt(h);return!isNaN($)&&!isNaN(w)?$-w:d.localeCompare(h)}):e(Ue))}),Ae(()=>(e(i),e(q),e(Ye)),()=>{g($e,e(i).materia?[...new Set(e(q).filter(d=>d.materia===e(i).materia).map(d=>d.grado).filter(Boolean))].sort((d,h)=>{const $=parseInt(d),w=parseInt(h);return!isNaN($)&&!isNaN(w)?$-w:d.localeCompare(h)}):e(Ye))}),Ae(()=>(e(i),e(q),e(tr)),()=>{g(v,e(i).docente||e(i).materia||e(i).grado?[...new Set(e(q).filter(d=>!(e(i).docente&&d.docente!==e(i).docente||e(i).materia&&d.materia!==e(i).materia||e(i).grado&&d.grado!==e(i).grado)).map(d=>d.motivo).filter(Boolean))].sort():e(tr))}),Ae(()=>{},()=>{g(t,{bg:"rgb(var(--bg-primary))",text:"rgb(var(--text-primary))",label:"rgb(var(--text-secondary))",border:"rgb(var(--border-primary))",placeholder:"rgb(var(--text-muted))",icon:"rgb(var(--text-muted))",cardBg:"rgb(var(--card-bg))",cardBorder:"rgb(var(--card-border))",inputBg:"rgb(var(--bg-secondary))"})}),Ae(()=>(e(q),e(T),e(i),e(G)),()=>{console.log("üîÑ Filtro reactivo ejecut√°ndose:",{totalInasistencias:e(q).length,filtrarPorFecha:e(T),fechaInicio:e(i).fechaInicio,fechaFin:e(i).fechaFin}),g(G,e(q).filter(d=>{if(e(i).docente&&d.docente!==e(i).docente||e(i).materia&&d.materia!==e(i).materia||e(i).grado&&d.grado!==e(i).grado||e(i).motivo&&d.motivo!==e(i).motivo)return!1;if(e(T)){const h=Ke(d.fecha);if(e(i).fechaInicio&&h<e(i).fechaInicio||e(i).fechaFin&&h>e(i).fechaFin)return!1}return!0})),console.log(`üìä Resultados filtrados: ${e(G).length} de ${e(q).length}`)}),Ae(()=>(e(T),e(i)),()=>{e(T)&&(!e(i).fechaInicio||!e(i).fechaFin)&&or()}),Lo(),Oo();var Ne=la(),ar=o(Ne),Te=o(ar),sr=o(Te),lr=o(sr),mr=s(lr,2),Xe=o(mr),f=s(Xe,2),k=s(sr,2),S=o(k),ie=s(S,2),ue=s(Te,2),we=o(ue);{var Ce=d=>{var h=Pt(),$=o(h),w=s(o($),2);F(()=>c(w,`color: ${e(t),r(()=>e(t).text)??""};`)),b(d,h)},Fe=d=>{var h=sa(),$=$r(h),w=o($),A=o(w),E=s(o(A));{var K=z=>{var Z=Lt();b(z,Z)};re(E,z=>{e(i),r(()=>e(i).docente||e(i).materia||e(i).grado||e(i).motivo||e(i).fechaInicio||e(i).fechaFin)&&z(K)})}var me=s(A,2),D=s(w,2),ze=o(D),He=s(ze,2),Be=o(He),N=s(Be,2),Y=s(He,2),M=o(Y),B=s(M,2),J=s(B,2),be=s(J,2),xe=s(be,2),H=s(D,2),j=o(H),X=o(j),Pe=o(X),Se=s(Pe,2),kr=o(Se);kr.value=kr.__value="";var Jo=s(kr);ve(Jo,1,()=>e(u),ge,(z,Z)=>{var ce=Ot(),De=o(ce),Ze={};F(()=>{x(De,e(Z)),Ze!==(Ze=e(Z))&&(ce.value=(ce.__value=e(Z))??"")}),b(z,ce)});var Yo=s(X,2),Fr=o(Yo),Ko=o(Fr),Nr=s(Fr,2),Br=o(Nr),qr=o(Br);Br.value=Br.__value="";var Jr=s(Br);ve(Jr,1,()=>e(m),ge,(z,Z)=>{var ce=Gt(),De=o(ce),Ze={};F(()=>{x(De,e(Z)),Ze!==(Ze=e(Z))&&(ce.value=(ce.__value=e(Z))??"")}),b(z,ce)});var Xo=s(Nr,2);{var Yr=z=>{var Z=Vt();b(z,Z)};re(Xo,z=>{e(i),e(m),r(()=>e(i).docente&&e(m).length===0)&&z(Yr)})}var Kr=s(j,2),bo=o(Kr),Xr=o(bo),Zo=o(Xr),Pr=s(Xr,2),Lr=o(Pr),xo=o(Lr);Lr.value=Lr.__value="";var fo=s(Lr);ve(fo,1,()=>e($e),ge,(z,Z)=>{var ce=Ut(),De=o(ce),Ze={};F(()=>{x(De,e(Z)),Ze!==(Ze=e(Z))&&(ce.value=(ce.__value=e(Z))??"")}),b(z,ce)});var ho=s(Pr,2);{var Qo=z=>{var Z=Wt();b(z,Z)};re(ho,z=>{e(i),e($e),r(()=>(e(i).docente||e(i).materia)&&e($e).length===0)&&z(Qo)})}var mo=s(bo,2),Zr=o(mo),Er=s(Zr,2),Mr=o(Er),_o=o(Mr);Mr.value=Mr.__value="";var ko=s(Mr);ve(ko,1,()=>e(v),ge,(z,Z)=>{const ce=pr(()=>(e(Z),r(()=>he(e(Z)))));var De=qt(),Ze=o(De),Sr={};F(()=>{x(Ze,`${ye(e(ce)),r(()=>e(ce).icon)??""}
                      ${e(Z)??""}`),Sr!==(Sr=e(Z))&&(De.value=(De.__value=e(Z))??"")}),b(z,De)});var zr=s(Er,2);{var Or=z=>{var Z=Jt();b(z,Z)};re(zr,z=>{e(i),e(v),r(()=>(e(i).docente||e(i).materia||e(i).grado)&&e(v).length===0)&&z(Or)})}var et=s(Kr,2),wo=o(et),Qr=o(wo),Gr=s(Qr,2),rt=s(wo,2),yo=o(rt),eo=s(yo,2),ot=s($,2),ro=o(ot),oo=o(ro),$o=s(o(oo)),Vr=o($o),to=s(ro,2);{var ao=z=>{var Z=Yt(),ce=o(Z),De=o(ce),Ze=s(De,2);F(()=>{c(De,`color: ${e(t),r(()=>e(t).icon)??""};`),c(Ze,`color: ${e(t),r(()=>e(t).text)??""};`)}),b(z,Z)},tt=z=>{var Z=aa(),ce=$r(Z),De=o(ce),Ze=o(De),Sr=o(Ze),Co=o(Sr),Fo=o(Co),so=s(Fo),lo=s(so),no=s(lo),io=s(no),Bo=s(io),co=s(Bo),So=s(co),Do=s(Sr);ve(Do,5,()=>e(G),ge,(n,l)=>{const p=pr(()=>(e(l),r(()=>he(e(l).motivo))));var C=Xt(),U=o(C),W=o(U),R=s(U),Q=o(R),oe=s(R),ee=o(oe),se=s(oe),We=o(se),Qe=s(se),_r=o(Qe);{var Le=je=>{var fe=Kt(),gr=o(fe);F(()=>x(gr,(e(l),r(()=>e(l).nombre)))),L("click",fe,()=>ae(e(l).nombre)),b(je,fe)},er=je=>{var fe=bt();F(()=>x(fe,(e(l),r(()=>e(l).nombre)))),b(je,fe)};re(_r,je=>{e(i),r(()=>e(i).docente&&e(i).materia&&e(i).grado)?je(Le):je(er,!1)})}var nr=s(Qe),ir=o(nr),br=o(ir),vr=o(br),xr=s(br),Oe=s(nr),wr=o(Oe),Ie=s(Oe),fr=o(Ie),rr=o(fr);F(je=>{c(C,`border-color: ${e(t),r(()=>e(t).border)??""};`),c(U,`color: ${e(t),r(()=>e(t).text)??""};`),x(W,je),c(R,`color: ${e(t),r(()=>e(t).text)??""};`),yr(R,"title",(e(l),r(()=>e(l).docente))),x(Q,(e(l),r(()=>e(l).docente))),c(oe,`color: ${e(t),r(()=>e(t).text)??""};`),yr(oe,"title",(e(l),r(()=>e(l).materia))),x(ee,(e(l),r(()=>e(l).materia))),c(se,`color: ${e(t),r(()=>e(t).text)??""};`),x(We,(e(l),r(()=>e(l).grado))),c(Qe,`color: ${e(t),r(()=>e(t).text)??""};`),yr(Qe,"title",(e(l),r(()=>e(l).nombre))),ur(ir,1,`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium ${ye(e(p)),r(()=>e(p).color)??""}`),x(vr,(ye(e(p)),r(()=>e(p).icon))),x(xr,` ${e(l),r(()=>e(l).motivo)??""}`),c(Oe,`color: ${e(t),r(()=>e(t).text)??""};`),x(wr,(e(l),r(()=>e(l).horas))),c(Ie,`color: ${e(t),r(()=>e(t).text)??""};`),x(rr,(e(l),r(()=>e(l).observaciones||"-")))},[()=>(e(l),r(()=>O(e(l).fecha)))]),b(n,C)});var vo=s(ce,2),Io=o(vo),at=o(Io),Ar=o(at),Eo=o(Ar),Mo=o(Eo),zo=s(Mo),Ao=s(zo),To=s(Ao),go=s(To),Ho=s(go),jo=s(Ho),st=s(Ar);ve(st,5,()=>e(G),ge,(n,l)=>{const p=pr(()=>(e(l),r(()=>he(e(l).motivo))));var C=Qt(),U=o(C),W=o(U),R=s(U),Q=o(R),oe=o(Q),ee=s(R),se=o(ee),We=s(ee),Qe=o(We),_r=o(Qe);{var Le=rr=>{var je=Zt(),fe=o(je);F(()=>x(fe,(e(l),r(()=>e(l).nombre)))),L("click",je,()=>ae(e(l).nombre)),b(rr,je)},er=rr=>{var je=bt();F(()=>x(je,(e(l),r(()=>e(l).nombre)))),b(rr,je)};re(_r,rr=>{e(i),r(()=>e(i).docente&&e(i).materia&&e(i).grado)?rr(Le):rr(er,!1)})}var nr=s(We),ir=o(nr),br=o(ir),vr=o(br),xr=s(br),Oe=s(nr),wr=o(Oe),Ie=s(Oe),fr=o(Ie);F(rr=>{c(C,`border-color: ${e(t),r(()=>e(t).border)??""};`),c(U,`color: ${e(t),r(()=>e(t).text)??""};`),x(W,rr),c(R,`color: ${e(t),r(()=>e(t).text)??""};`),yr(Q,"title",(e(l),r(()=>e(l).docente))),x(oe,(e(l),r(()=>e(l).docente))),c(ee,`color: ${e(t),r(()=>e(t).text)??""};`),yr(ee,"title",(e(l),r(()=>e(l).materia))),x(se,(e(l),r(()=>e(l).materia))),c(We,`color: ${e(t),r(()=>e(t).text)??""};`),yr(Qe,"title",(e(l),r(()=>e(l).nombre))),ur(ir,1,`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium ${ye(e(p)),r(()=>e(p).color)??""}`),x(vr,(ye(e(p)),r(()=>e(p).icon))),x(xr,` ${e(l),r(()=>e(l).motivo)??""}`),c(Oe,`color: ${e(t),r(()=>e(t).text)??""};`),x(wr,(e(l),r(()=>e(l).horas))),c(Ie,`color: ${e(t),r(()=>e(t).text)??""};`),x(fr,(e(l),r(()=>e(l).grado)))},[()=>(e(l),r(()=>O(e(l).fecha)))]),b(n,C)});var lt=s(vo,2),nt=o(lt);ve(nt,5,()=>e(G),ge,(n,l)=>{const p=pr(()=>(e(l),r(()=>he(e(l).motivo))));var C=ta(),U=o(C),W=o(U),R=o(W);{var Q=fe=>{var gr=ea(),Tr=o(gr);F(()=>x(Tr,(e(l),r(()=>e(l).nombre)))),L("click",gr,()=>ae(e(l).nombre)),b(fe,gr)},oe=fe=>{var gr=ra(),Tr=o(gr);F(()=>x(Tr,(e(l),r(()=>e(l).nombre)))),b(fe,gr)};re(R,fe=>{e(i),r(()=>e(i).docente&&e(i).materia&&e(i).grado)?fe(Q):fe(oe,!1)})}var ee=s(R,2),se=o(ee),We=s(W,2),Qe=o(We),_r=o(Qe),Le=o(_r),er=s(_r),nr=s(Qe,2),ir=o(nr),br=s(U,2),vr=o(br),xr=s(o(vr),2),Oe=o(xr),wr=s(vr,2),Ie=s(o(wr),2),fr=o(Ie),rr=s(br,2);{var je=fe=>{var gr=oa(),Tr=o(gr),Dr=s(o(Tr),2),uo=o(Dr);F(()=>{c(gr,`background-color: ${e(t),r(()=>e(t).inputBg)??""}; color: ${e(t),r(()=>e(t).label)??""};`),x(uo,(e(l),r(()=>e(l).observaciones)))}),b(fe,gr)};re(rr,fe=>{e(l),r(()=>e(l).observaciones)&&fe(je)})}F(fe=>{c(C,`border-color: ${e(t),r(()=>e(t).cardBorder)??""}; background-color: ${e(t),r(()=>e(t).cardBg)??""};`),c(ee,`color: ${e(t),r(()=>e(t).label)??""};`),x(se,`${e(l),r(()=>e(l).grado)??""} ‚Ä¢ ${fe??""}`),ur(Qe,1,`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[10px] font-medium ${ye(e(p)),r(()=>e(p).color)??""} mb-0.5`),x(Le,(ye(e(p)),r(()=>e(p).icon))),x(er,` ${e(l),r(()=>e(l).motivo)??""}`),c(nr,`color: ${e(t),r(()=>e(t).text)??""};`),x(ir,`${e(l),r(()=>e(l).horas)??""}h`),c(br,`color: ${e(t),r(()=>e(t).text)??""};`),x(Oe,(e(l),r(()=>e(l).docente))),yr(Ie,"title",(e(l),r(()=>e(l).materia))),x(fr,(e(l),r(()=>e(l).materia)))},[()=>(e(l),r(()=>O(e(l).fecha)))]),b(n,C)}),F(()=>{c(De,`border-color: ${e(t),r(()=>e(t).cardBorder)??""};`),c(Sr,`background-color: ${e(t),r(()=>e(t).cardBg)??""}; border-color: ${e(t),r(()=>e(t).border)??""};`),c(Fo,`color: ${e(t),r(()=>e(t).text)??""};`),c(so,`color: ${e(t),r(()=>e(t).text)??""};`),c(lo,`color: ${e(t),r(()=>e(t).text)??""};`),c(no,`color: ${e(t),r(()=>e(t).text)??""};`),c(io,`color: ${e(t),r(()=>e(t).text)??""};`),c(Bo,`color: ${e(t),r(()=>e(t).text)??""};`),c(co,`color: ${e(t),r(()=>e(t).text)??""};`),c(So,`color: ${e(t),r(()=>e(t).text)??""};`),c(Io,`border-color: ${e(t),r(()=>e(t).cardBorder)??""};`),c(Ar,`background-color: ${e(t),r(()=>e(t).cardBg)??""}; border-color: ${e(t),r(()=>e(t).border)??""};`),c(Mo,`color: ${e(t),r(()=>e(t).text)??""};`),c(zo,`color: ${e(t),r(()=>e(t).text)??""};`),c(Ao,`color: ${e(t),r(()=>e(t).text)??""};`),c(To,`color: ${e(t),r(()=>e(t).text)??""};`),c(go,`color: ${e(t),r(()=>e(t).text)??""};`),c(Ho,`color: ${e(t),r(()=>e(t).text)??""};`),c(jo,`color: ${e(t),r(()=>e(t).text)??""};`)}),b(z,Z)};re(to,z=>{e(G),r(()=>e(G).length===0)?z(ao):z(tt,!1)})}F(()=>{c($,`border-color: ${e(t),r(()=>e(t).cardBorder)??""};`),c(A,`color: ${e(t),r(()=>e(t).text)??""};`),c(me,`border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),c(ze,`color: ${e(t),r(()=>e(t).text)??""};`),c(N,`color: ${e(t),r(()=>e(t).text)??""};`),c(M,`border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),c(B,`border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),c(J,`border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),c(be,`border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),c(xe,`border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),c(Pe,`color: ${e(t),r(()=>e(t).label)??""};`),c(Se,`background-color: ${e(t),r(()=>e(t).inputBg)??""}; border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),c(Fr,`color: ${e(t),r(()=>e(t).label)??""};`),x(Ko,`Materia ${e(i),r(()=>e(i).docente?"(del docente)":"")??""}`),c(Nr,`background-color: ${e(t),r(()=>e(t).inputBg)??""}; border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),x(qr,(e(i),r(()=>e(i).docente?"Todas las materias del docente":"Todas las materias"))),c(Xr,`color: ${e(t),r(()=>e(t).label)??""};`),x(Zo,`Grado ${e(i),r(()=>e(i).docente||e(i).materia?"(filtrado)":"")??""}`),c(Pr,`background-color: ${e(t),r(()=>e(t).inputBg)??""}; border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),x(xo,(e(i),r(()=>e(i).docente||e(i).materia?"Todos los grados filtrados":"Todos los grados"))),c(Zr,`color: ${e(t),r(()=>e(t).label)??""};`),c(Er,`background-color: ${e(t),r(()=>e(t).inputBg)??""}; border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),x(_o,(e(i),r(()=>e(i).docente||e(i).materia||e(i).grado?"Todos los motivos filtrados":"Todos los motivos"))),c(Qr,`color: ${e(t),r(()=>e(t).label)??""};`),Gr.disabled=!e(T),c(Gr,`background-color: ${e(t),r(()=>e(t).inputBg)??""}; border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),c(yo,`color: ${e(t),r(()=>e(t).label)??""};`),eo.disabled=!e(T),c(eo,`background-color: ${e(t),r(()=>e(t).inputBg)??""}; border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),c(oo,`color: ${e(t),r(()=>e(t).label)??""};`),x(Vr,(e(G),r(()=>e(G).length)))}),L("click",me,ne),Et(Be,()=>e(T),z=>g(T,z)),L("click",M,()=>pe("hoy")),L("click",B,()=>pe("semana")),L("click",J,()=>pe("mes")),L("click",be,()=>pe("mes_actual")),L("click",xe,()=>pe("trimestre")),Je(Se,()=>e(i).docente,z=>(Ee(i,e(i).docente=z),qe(()=>{e(t),e(u),e(m),e($e),e(v)}))),Je(Nr,()=>e(i).materia,z=>(Ee(i,e(i).materia=z),qe(()=>{e(t),e(u),e(m),e($e),e(v)}))),Je(Pr,()=>e(i).grado,z=>(Ee(i,e(i).grado=z),qe(()=>{e(t),e(u),e(m),e($e),e(v)}))),Je(Er,()=>e(i).motivo,z=>(Ee(i,e(i).motivo=z),qe(()=>{e(t),e(u),e(m),e($e),e(v)}))),Ro(Gr,()=>e(i).fechaInicio,z=>(Ee(i,e(i).fechaInicio=z),qe(()=>{e(t),e(u),e(m),e($e),e(v)}))),Ro(eo,()=>e(i).fechaFin,z=>(Ee(i,e(i).fechaFin=z),qe(()=>{e(t),e(u),e(m),e($e),e(v)}))),b(d,h)};re(we,d=>{e(ke)?d(Ce):d(Fe,!1)})}F(()=>{c(ar,`background-color: ${e(t),r(()=>e(t).cardBg)??""};`),c(Te,`border-color: ${e(t),r(()=>e(t).cardBorder)??""};`),yr(lr,"src",kt),c(Xe,`color: ${e(t),r(()=>e(t).text)??""};`),c(f,`color: ${e(t),r(()=>e(t).label)??""};`),S.disabled=(e(G),r(()=>e(G).length===0)),c(ie,`color: ${e(t),r(()=>e(t).text)??""};`)}),L("click",S,I),L("click",ie,function(...d){_e()?.apply(this,d)}),L("click",Ne,vt(function(...d){_e()?.apply(this,d)})),L("keydown",Ne,d=>{(d.key==="Enter"||d.key===" ")&&_e()()}),b(Ir,Ne),Go()}var ia=y('<div class="flex justify-center py-12"><!></div>'),ca=y("<option> </option>"),da=y("<option> </option>"),va=y("<option> </option>"),ga=y("<option> </option>"),ua=Cr('<svg class="animate-spin h-5 w-5" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Generando...',1),pa=Cr('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg> Ver Reporte',1),ba=y('<div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="space-y-2"><label for="view-docente" class="block text-sm font-medium">Docente</label> <select id="view-docente" class="w-full px-4 py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none"><option>Seleccione docente</option><!></select></div> <div class="space-y-2"><label for="view-materia" class="block text-sm font-medium">Materia</label> <select id="view-materia" class="w-full px-4 py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none"><option>Seleccione materia</option><!></select></div> <div class="space-y-2"><label for="view-grado" class="block text-sm font-medium">Grado</label> <select id="view-grado" class="w-full px-4 py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none"><option>Seleccione grado</option><!></select></div> <div class="space-y-2"><label for="view-periodo" class="block text-sm font-medium">Periodo</label> <select id="view-periodo" class="w-full px-4 py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none"></select></div></div> <div class="pt-4 flex gap-3"><button class="flex-1 px-6 py-3 border rounded-xl hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors font-medium">Cancelar</button> <button class="flex-[2] px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl transition-all font-bold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"><!></button></div>',1),xa=y('<th class="p-2 border text-white font-bold text-center sticky top-0 z-20" style="background-color: #4472C4; min-width: 60px;"> </th>'),fa=y('<td class="p-2 border text-center font-medium bg-white cell-hover svelte-14neep5"> </td>'),ha=y('<tr class="hover-row svelte-14neep5"><td class="p-2 border font-medium sticky left-0 z-10 bg-[#F2F2F2] svelte-14neep5" style="background-color: #F2F2F2;"> </td><!><td class="p-2 border text-center font-bold bg-white cell-hover svelte-14neep5"> </td></tr>'),ma=y('<div class="space-y-4 min-w-0"><div class="text-center p-4 rounded-lg flex-shrink-0" style="background-color: #2E75B6; color: white;"><h3 class="text-lg font-bold whitespace-nowrap"> </h3></div> <div class="p-3 rounded-lg text-sm flex-shrink-0" style="background-color: #5B9BD5; color: white;"><p class="font-medium whitespace-nowrap"> </p></div> <div class="overflow-auto border rounded-lg flex-1 min-h-[200px] max-h-[50vh]"><table class="w-full border-collapse text-xs md:text-sm"><thead class="sticky top-0 z-30 shadow-sm"><tr><th class="p-2 border text-white font-bold sticky left-0 z-40" style="background-color: #4472C4; width: 200px;">Estudiantes</th><!><th class="p-2 border text-white font-bold text-center sticky top-0 z-20" style="background-color: #FF6B6B; width: 80px;">Total Horas</th></tr></thead><tbody class="bg-white"></tbody></table></div> <div class="pt-4 flex gap-3 flex-shrink-0"><button class="flex-1 px-6 py-3 border rounded-xl hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors font-medium">Nueva Consulta</button> <button class="flex-1 px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white rounded-xl transition-colors font-medium">Cerrar</button></div></div>'),_a=y('<div class="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-2 md:p-4" role="dialog" aria-modal="true" aria-labelledby="modal-title" tabindex="-1"><div class="bg-white dark:bg-gray-900 rounded-2xl w-full max-w-[95vw] max-h-[90vh] overflow-hidden shadow-2xl border flex flex-col"><div class="flex items-center justify-between p-4 md:p-6 border-b flex-shrink-0"><div class="flex items-center gap-3"><div class="p-2 rounded-lg bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-200"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div> <div><h2 id="modal-title" class="text-lg md:text-xl font-bold">Vista de Reporte</h2> <p class="text-sm opacity-75">Inasistencias por materia y grado</p></div></div> <button class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors" aria-label="Cerrar"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="p-4 md:p-6 space-y-4 overflow-y-auto flex-1"><!></div></div></div>');function wt(Ir,cr){No(cr,!1);const m=_();let Ye=Rr(cr,"onClose",8),$e=Rr(cr,"initialDocente",8,""),v=_([]),t=_([]),_e=_([]),a=_($e()||""),q=_(""),Re=_(""),Ve=_(Wr[0].nombre),dr=_(!1),ke=_(!1),T=_(null);const G=I=>I?I.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-zA-Z0-9\s]/g,"").replace(/\s+/g," ").trim().toLowerCase():"",i=I=>{if(!I)return"";const O=I.split("/");if(O.length===3){const ae=O[0].padStart(2,"0"),Ne=O[1].padStart(2,"0");return`${O[2]}-${Ne}-${ae}`}return I},or=I=>{const O=[],ae=new Date(I.fecha_inicio),Ne=new Date(I.fecha_fin);for(;ae<=Ne;){const ar=ae.getUTCDay();ar>=1&&ar<=6&&O.push(new Date(ae)),ae.setUTCDate(ae.getUTCDate()+1)}return O},pe=I=>{const O=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"];return`${I.getUTCDate()}/${O[I.getUTCMonth()]}/${I.getUTCFullYear().toString().substr(2)}`};Po(async()=>{g(dr,!0);try{const[I,O,ae]=await Promise.all([Uo(),Wo(),qo()]);g(v,I),g(t,O),g(_e,ae)}catch(I){console.error("Error cargando datos iniciales:",I)}finally{g(dr,!1)}});const Me=async()=>{if(!e(a)||!e(q)||!e(Re)){Ge.fire({icon:"warning",title:"Campos incompletos",text:"Por favor seleccione Docente, Materia y Grado."});return}const I=Wr.find(O=>O.nombre===e(Ve));if(!I){Ge.fire({icon:"error",title:"Error",text:"Periodo no encontrado"});return}g(ke,!0);try{const O=await gt({spreadsheetId:po,worksheetTitle:Vo});if(!O?.records||!Array.isArray(O.records))throw new Error("No se pudieron obtener los registros de inasistencias");const ae=O.records.slice(1),Ne=G(e(a)),ar=G(e(q)),Te=e(Re).toString().trim(),sr=ae.map(k=>{const S=k.values||[];return{fecha:S[2]||"",docente:S[1]||"",materia:S[4]||"",grado:(S[6]||"").toString().trim(),nombre:S[7]||"",motivo:S[5]||"",horas:S[3]||"0"}}).filter(k=>{const S=G(k.docente),ie=G(k.materia),ue=k.grado,we=S.includes(Ne)||Ne.includes(S),Ce=ie.includes(ar)||ar.includes(ie),Fe=ue===Te||ue.startsWith(Te)||Te.startsWith(ue),d=i(k.fecha),h=new Date(d),$=new Date(I.fecha_inicio),w=new Date(I.fecha_fin);$.setHours(0,0,0,0),w.setHours(23,59,59,999);const A=h>=$&&h<=w;return we&&Ce&&Fe&&A}),lr=e(_e).filter(k=>k.grado.toString()===e(Re)).map(k=>k.nombre).sort();if(lr.length===0)throw new Error("No hay estudiantes registrados para el grado seleccionado");const Xe=or(I).filter(k=>{const S=k.toISOString().split("T")[0];return sr.some(ie=>i(ie.fecha)===S)});if(Xe.length===0){Ge.fire({icon:"info",title:"Sin datos",text:"No se encontraron inasistencias para los filtros seleccionados en este periodo."});return}const f=lr.map(k=>{const S=[];let ie=0;return Xe.forEach(ue=>{const we=ue.toISOString().split("T")[0],Ce=sr.filter(Fe=>G(Fe.nombre)===G(k)&&i(Fe.fecha)===we);if(Ce.length>0){const Fe=Ce[0],d=parseFloat(Fe.horas)||0,h=Fe.motivo||"";d>0?(S.push({valor:d.toString(),horas:d}),ie+=d):h?S.push({valor:h,horas:0}):S.push({valor:"X",horas:0})}else S.push({valor:"‚úì",horas:0})}),{nombre:k,registros:S,totalHoras:ie}});g(T,{docente:e(a),materia:e(q),grado:e(Re),periodo:I.nombre,fechaInicio:pe(I.fecha_inicio),fechaFin:pe(I.fecha_fin),fechas:Xe.map(k=>pe(k)),estudiantes:f})}catch(O){console.error("Error generando reporte:",O);const ae=O instanceof Error?O.message:"Error desconocido";Ge.fire({icon:"error",title:"Error",text:ae})}finally{g(ke,!1)}};Ae(()=>{},()=>{g(m,{bg:"rgb(var(--bg-primary))",text:"rgb(var(--text-primary))",label:"rgb(var(--text-secondary))",border:"rgb(var(--border-primary))",cardBg:"rgb(var(--card-bg))",cardBorder:"rgb(var(--card-border))",inputBg:"rgb(var(--bg-secondary))"})}),Lo(),Oo();var he=_a(),u=o(he),P=o(u),Ue=s(o(P),2),tr=s(P,2),Ke=o(tr);{var V=I=>{var O=ia(),ae=o(O);_t(ae,{message:"Cargando datos..."}),b(I,O)},ne=I=>{var O=mt(),ae=$r(O);{var Ne=Te=>{var sr=ba(),lr=$r(sr),mr=o(lr),Xe=o(mr),f=s(Xe,2),k=o(f);k.value=k.__value="";var S=s(k);ve(S,1,()=>e(v),ge,(M,B)=>{var J=ca(),be=o(J),xe={};F(()=>{x(be,e(B)),xe!==(xe=e(B))&&(J.value=(J.__value=e(B))??"")}),b(M,J)});var ie=s(mr,2),ue=o(ie),we=s(ue,2),Ce=o(we);Ce.value=Ce.__value="";var Fe=s(Ce);ve(Fe,1,()=>e(t),ge,(M,B)=>{var J=da(),be=o(J),xe={};F(()=>{x(be,(e(B),r(()=>e(B).materia))),xe!==(xe=(e(B),r(()=>e(B).materia)))&&(J.value=(J.__value=(e(B),r(()=>e(B).materia)))??"")}),b(M,J)});var d=s(ie,2),h=o(d),$=s(h,2),w=o($);w.value=w.__value="";var A=s(w);ve(A,1,()=>(e(_e),r(()=>[...new Set(e(_e).map(M=>M.grado.toString()))])),ge,(M,B)=>{var J=va(),be=o(J),xe={};F(H=>{x(be,H),xe!==(xe=e(B))&&(J.value=(J.__value=e(B))??"")},[()=>(e(B),r(()=>e(B).replace(/0(\d)$/,"¬∞$1").replace(/(\d{1,2})0(\d)/,"$1¬∞$2")))]),b(M,J)});var E=s(d,2),K=o(E),me=s(K,2);ve(me,5,()=>Wr,ge,(M,B)=>{var J=ga(),be=o(J),xe={};F(()=>{x(be,`Periodo ${e(B),r(()=>e(B).nombre)??""}`),xe!==(xe=(e(B),r(()=>e(B).nombre)))&&(J.value=(J.__value=(e(B),r(()=>e(B).nombre)))??"")}),b(M,J)});var D=s(lr,2),ze=o(D),He=s(ze,2),Be=o(He);{var N=M=>{var B=ua();b(M,B)},Y=M=>{var B=pa();b(M,B)};re(Be,M=>{e(ke)?M(N):M(Y,!1)})}F(()=>{c(Xe,`color: ${e(m),r(()=>e(m).label)??""};`),c(f,`background-color: ${e(m),r(()=>e(m).inputBg)??""}; border-color: ${e(m),r(()=>e(m).border)??""}; color: ${e(m),r(()=>e(m).text)??""};`),c(ue,`color: ${e(m),r(()=>e(m).label)??""};`),c(we,`background-color: ${e(m),r(()=>e(m).inputBg)??""}; border-color: ${e(m),r(()=>e(m).border)??""}; color: ${e(m),r(()=>e(m).text)??""};`),c(h,`color: ${e(m),r(()=>e(m).label)??""};`),c($,`background-color: ${e(m),r(()=>e(m).inputBg)??""}; border-color: ${e(m),r(()=>e(m).border)??""}; color: ${e(m),r(()=>e(m).text)??""};`),c(K,`color: ${e(m),r(()=>e(m).label)??""};`),c(me,`background-color: ${e(m),r(()=>e(m).inputBg)??""}; border-color: ${e(m),r(()=>e(m).border)??""}; color: ${e(m),r(()=>e(m).text)??""};`),c(ze,`border-color: ${e(m),r(()=>e(m).border)??""};`),He.disabled=e(ke)||!e(a)||!e(q)||!e(Re)}),Je(f,()=>e(a),M=>g(a,M)),Je(we,()=>e(q),M=>g(q,M)),Je($,()=>e(Re),M=>g(Re,M)),Je(me,()=>e(Ve),M=>g(Ve,M)),L("click",ze,function(...M){Ye()?.apply(this,M)}),L("click",He,Me),b(Te,sr)},ar=Te=>{var sr=ma(),lr=o(sr),mr=o(lr),Xe=o(mr),f=s(lr,2),k=o(f),S=o(k),ie=s(f,2),ue=o(ie),we=o(ue),Ce=o(we),Fe=s(o(Ce));ve(Fe,1,()=>(e(T),r(()=>e(T).fechas)),ge,(A,E)=>{var K=xa(),me=o(K);F(()=>x(me,e(E))),b(A,K)});var d=s(we);ve(d,5,()=>(e(T),r(()=>e(T).estudiantes)),ge,(A,E)=>{var K=ha(),me=o(K),D=o(me),ze=s(me);ve(ze,1,()=>(e(E),r(()=>e(E).registros)),ge,(N,Y)=>{const M=pr(()=>(e(Y),r(()=>e(Y).valor==="‚úì")));var B=fa(),J=o(B);F(()=>{c(B,e(M)?"color: #00AA00;":"color: #FF0000; background-color: #FFE6E6;"),x(J,(e(Y),r(()=>e(Y).valor)))}),b(N,B)});var He=s(ze),Be=o(He);F(()=>{x(D,(e(E),r(()=>e(E).nombre))),c(He,(e(E),r(()=>e(E).totalHoras>0?"color: #FF0000; background-color: #FFE6E6;":"color: #00AA00; background-color: #E6FFE6;"))),x(Be,(e(E),r(()=>e(E).totalHoras)))}),b(A,K)});var h=s(ie,2),$=o(h),w=s($,2);F(()=>{x(Xe,`REPORTE DE INASISTENCIAS - ${e(T),r(()=>e(T).materia)??""} - GRADO ${e(T),r(()=>e(T).grado)??""}`),x(S,`Docente: ${e(T),r(()=>e(T).docente)??""} | Periodo: ${e(T),r(()=>e(T).periodo)??""} (${e(T),r(()=>e(T).fechaInicio)??""} - ${e(T),r(()=>e(T).fechaFin)??""})`),c($,`border-color: ${e(m),r(()=>e(m).border)??""};`)}),L("click",$,()=>g(T,null)),L("click",w,function(...A){Ye()?.apply(this,A)}),b(Te,sr)};re(ae,Te=>{e(T)?Te(ar,!1):Te(Ne)})}b(I,O)};re(Ke,I=>{e(dr)?I(V):I(ne,!1)})}F(()=>{c(u,`background-color: ${e(m),r(()=>e(m).cardBg)??""}; border-color: ${e(m),r(()=>e(m).cardBorder)??""}; color: ${e(m),r(()=>e(m).text)??""};`),c(P,`border-color: ${e(m),r(()=>e(m).cardBorder)??""};`)}),L("click",Ue,function(...I){Ye()?.apply(this,I)}),L("click",he,vt(function(...I){Ye()?.apply(this,I)})),L("keydown",he,I=>I.key==="Escape"&&Ye()()),b(Ir,he),Go()}var ka=y('<div class="flex justify-center py-12"><!></div>'),wa=y("<option> </option>"),ya=y("<option> </option>"),$a=y("<option> </option>"),Ca=y("<option> </option>"),Fa=Cr('<svg class="animate-spin h-5 w-5 text-white" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Generando...',1),Ba=Cr('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg> Descargar Excel',1),Sa=y('<div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="space-y-2"><label for="rep-docente" class="block text-sm font-medium">Docente</label> <select id="rep-docente" class="w-full px-4 py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none"><option>Seleccione docente</option><!></select></div> <div class="space-y-2"><label for="rep-materia" class="block text-sm font-medium">Materia</label> <select id="rep-materia" class="w-full px-4 py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none"><option>Seleccione materia</option><!></select></div> <div class="space-y-2"><label for="rep-grado" class="block text-sm font-medium">Grado</label> <select id="rep-grado" class="w-full px-4 py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none"><option>Seleccione grado</option><!></select></div> <div class="space-y-2"><label for="rep-periodo" class="block text-sm font-medium">Periodo</label> <select id="rep-periodo" class="w-full px-4 py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none"></select></div></div> <div class="pt-4 flex gap-3"><button class="flex-1 px-6 py-3 border rounded-xl hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors font-medium">Cancelar</button> <button class="flex-1 px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-xl transition-all font-bold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg hover:shadow-green-500/20"><!></button></div>',1),Da=y('<div class="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4" role="dialog" aria-modal="true" aria-labelledby="modal-title" tabindex="-1"><div class="bg-white dark:bg-gray-900 rounded-2xl w-full max-w-2xl overflow-hidden shadow-2xl border"><div class="flex items-center justify-between p-6 border-b"><div class="flex items-center gap-3"><div class="p-2 rounded-lg bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-200"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div> <div><h2 id="modal-title" class="text-xl font-bold">Generador de Reporte Excel</h2> <p class="text-sm opacity-75">Inasistencias por materia y grado</p></div></div> <button class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors" aria-label="Cerrar modal"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="p-6 space-y-6"><!></div></div></div> <!>',1);function Ia(Ir,cr){No(cr,!1);const m=_(),Ye=_(),$e=_(),v=_();let t=null,_e=null,a=Rr(cr,"onClose",8),q=Rr(cr,"initialDocente",8,""),Re=_([]),Ve=_([]),dr=_([]),ke=_(q()||""),T=_(""),G=_(""),i=_(Wr[0].nombre);const or=f=>{const k=f.match(/-(\d+)$/);return k?k[1]:null};let pe=_(!1),Me=_(!1),he=_(!1);const u=async()=>{if(!t||!_e){const[f,k]=await Promise.all([ht(()=>import("./excel-G1qE2FwJ.js").then(S=>S.e),[]),ht(()=>import("./utils-Dc41pFlL.js").then(S=>S.F),__vite__mapDeps([0,1]))]);t=f.default,_e=k.default}},P=f=>f?f.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-zA-Z0-9\s]/g,"").replace(/\s+/g," ").trim().toLowerCase():"",Ue=f=>{if(!f)return"";const k=f.split("/");if(k.length===3){const S=k[0].padStart(2,"0"),ie=k[1].padStart(2,"0");return`${k[2]}-${ie}-${S}`}return f},tr=f=>{const k=[],S=new Date(f.fecha_inicio),ie=new Date(f.fecha_fin);for(;S<=ie;){const ue=S.getUTCDay();ue>=1&&ue<=6&&k.push(new Date(S)),S.setUTCDate(S.getUTCDate()+1)}return k},Ke=f=>{const k=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"];return`${f.getUTCDate()}/${k[f.getUTCMonth()]}/${f.getUTCFullYear().toString().substr(2)}`};Po(async()=>{g(pe,!0);try{const[f,k,S]=await Promise.all([Uo(),Wo(),qo()]);g(Re,f),g(Ve,k),g(dr,S)}catch(f){console.error("Error cargando datos iniciales:",f)}finally{g(pe,!1)}});const V=async()=>{if(await u(),!e(ke)||!e(T)||!e(G)){Ge.fire({icon:"warning",title:"Campos incompletos",text:"Por favor seleccione Docente, Materia y Grado."});return}const f=Wr.find(k=>k.nombre===e(i));if(!f){Ge.fire({icon:"error",title:"Error",text:"Periodo no encontrado"});return}g(Me,!0);try{const k=await gt({spreadsheetId:po,worksheetTitle:Vo});if(!k?.records||!Array.isArray(k.records))throw new Error("No se pudieron obtener los registros de inasistencias");const S=k.records.slice(1),ie=P(e(ke)),ue=P(e(T)),we=e(G).toString().trim(),Ce=S.map(N=>{const Y=N.values||[];return{fecha:Y[2]||"",docente:Y[1]||"",materia:Y[4]||"",grado:(Y[6]||"").toString().trim(),nombre:Y[7]||"",motivo:Y[5]||"",horas:Y[3]||"0"}}).filter(N=>{const Y=P(N.docente),M=P(N.materia),B=N.grado,J=Y.includes(ie)||ie.includes(Y),be=M.includes(ue)||ue.includes(M),xe=B===we||B.startsWith(we)||we.startsWith(B),H=Ue(N.fecha),j=new Date(H),X=new Date(f.fecha_inicio),Pe=new Date(f.fecha_fin);X.setHours(0,0,0,0),Pe.setHours(23,59,59,999);const Se=j>=X&&j<=Pe;return J&&be&&xe&&Se}),Fe=e(dr).filter(N=>N.grado.toString()===e(G)).map(N=>N.nombre).sort();if(Fe.length===0)throw new Error("No hay estudiantes registrados para el grado seleccionado");const h=tr(f).filter(N=>{const Y=N.toISOString().split("T")[0];return Ce.some(M=>Ue(M.fecha)===Y)});if(h.length===0){Ge.fire({icon:"info",title:"Sin datos",text:"No se encontraron inasistencias para los filtros seleccionados en este periodo."}),g(Me,!1);return}const $=new t.Workbook,w=$.addWorksheet("Reporte de Inasistencias"),A=h.length+2,E=w.addRow([`REPORTE DE INASISTENCIAS - ${e(T)} - GRADO ${e(G)}`]);E.height=30,E.font={bold:!0,size:16,color:{argb:"FFFFFF"}},E.fill={type:"pattern",pattern:"solid",fgColor:{argb:"2E75B6"}},E.alignment={vertical:"middle",horizontal:"center"},w.mergeCells(1,1,1,A);const K=w.addRow([`Docente: ${e(ke)} | Periodo: ${f.nombre} (${Ke(f.fecha_inicio)} - ${Ke(f.fecha_fin)})`]);K.height=20,K.font={bold:!0,size:10,color:{argb:"FFFFFF"}},K.fill={type:"pattern",pattern:"solid",fgColor:{argb:"5B9BD5"}},K.alignment={vertical:"middle",horizontal:"left"},w.mergeCells(2,1,2,A);const me=["Estudiantes",...h.map(N=>Ke(N)),"Total Horas"],D=w.addRow(me);D.height=25,D.font={bold:!0,size:11,color:{argb:"FFFFFF"}},D.alignment={vertical:"middle",horizontal:"center"},w.getColumn(1).width=35,h.forEach((N,Y)=>{w.getColumn(Y+2).width=22}),w.getColumn(A).width=15,D.eachCell((N,Y)=>{N.fill={type:"pattern",pattern:"solid",fgColor:{argb:Y===A?"FF6B6B":"4472C4"}},N.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),Fe.forEach(N=>{const Y=[N];let M=0;h.forEach(be=>{const xe=be.toISOString().split("T")[0],H=Ce.filter(j=>P(j.nombre)===P(N)&&Ue(j.fecha)===xe);if(H.length>0){const j=H[0],X=parseFloat(j.horas)||0,Pe=j.motivo||"";X>0?(Y.push(X.toString()),M+=X):Pe?Y.push(Pe):Y.push("X")}else Y.push("‚úì")}),Y.push(M.toString());const B=w.addRow(Y);B.height=30,B.getCell(1).font={bold:!0},B.getCell(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"F2F2F2"}},h.forEach((be,xe)=>{const H=B.getCell(xe+2);H.alignment={horizontal:"center",vertical:"middle",wrapText:!0};const j=H.value?.toString()||"",X=parseFloat(j)||0;j==="‚úì"?H.font={color:{argb:"00AA00"}}:X>0||isNaN(X)?(H.font={color:{argb:"FF0000"},bold:!0},H.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE6E6"}}):(H.font={color:{argb:"FF0000"},bold:!0},H.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE6E6"}})});const J=B.getCell(A);J.font={bold:!0,color:{argb:M>0?"FF0000":"00AA00"}},J.alignment={horizontal:"center"},J.fill={type:"pattern",pattern:"solid",fgColor:{argb:M>0?"FFE6E6":"E6FFE6"}},B.eachCell(be=>{be.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})});const ze=await $.xlsx.writeBuffer(),He=new Blob([ze],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Be=`Reporte_Inasistencias_${e(G)}_${e(T).replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.xlsx`;_e(He,Be),Ge.fire({icon:"success",title:"Reporte generado",text:`Se ha generado el reporte con ${Fe.length} estudiantes.`,timer:2e3,showConfirmButton:!1})}catch(k){console.error("Error generando Excel:",k);const S=k instanceof Error?k.message:"Error desconocido";Ge.fire({icon:"error",title:"Error",text:S})}finally{g(Me,!1)}};Ae(()=>e(ke),()=>{g(m,e(ke).includes("-"))}),Ae(()=>e(ke),()=>{g(Ye,or(e(ke)))}),Ae(()=>(e(Ye),e(dr)),()=>{g($e,e(Ye)?[...new Set(e(dr).map(f=>f.grado.toString()))].filter(f=>f.startsWith(`${e(Ye)}-`)):[...new Set(e(dr).map(f=>f.grado.toString()))].filter(f=>!f.includes("-")))}),Ae(()=>{},()=>{g(v,{bg:"rgb(var(--bg-primary))",text:"rgb(var(--text-primary))",label:"rgb(var(--text-secondary))",border:"rgb(var(--border-primary))",cardBg:"rgb(var(--card-bg))",cardBorder:"rgb(var(--card-border))",inputBg:"rgb(var(--bg-secondary))"})}),Lo(),Oo();var ne=Da(),I=$r(ne),O=o(I),ae=o(O),Ne=s(o(ae),2),ar=s(ae,2),Te=o(ar);{var sr=f=>{var k=ka(),S=o(k);_t(S,{message:"Cargando datos..."}),b(f,k)},lr=f=>{var k=Sa(),S=$r(k),ie=o(S),ue=o(ie),we=s(ue,2),Ce=o(we);Ce.value=Ce.__value="";var Fe=s(Ce);ve(Fe,1,()=>e(Re),ge,(H,j)=>{var X=wa(),Pe=o(X),Se={};F(()=>{x(Pe,e(j)),Se!==(Se=e(j))&&(X.value=(X.__value=e(j))??"")}),b(H,X)});var d=s(ie,2),h=o(d),$=s(h,2),w=o($);w.value=w.__value="";var A=s(w);ve(A,1,()=>e(Ve),ge,(H,j)=>{var X=ya(),Pe=o(X),Se={};F(()=>{x(Pe,(e(j),r(()=>e(j).materia))),Se!==(Se=(e(j),r(()=>e(j).materia)))&&(X.value=(X.__value=(e(j),r(()=>e(j).materia)))??"")}),b(H,X)});var E=s(d,2),K=o(E),me=s(K,2),D=o(me);D.value=D.__value="";var ze=s(D);ve(ze,1,()=>e($e),ge,(H,j)=>{var X=$a(),Pe=o(X),Se={};F(kr=>{x(Pe,kr),Se!==(Se=e(j))&&(X.value=(X.__value=e(j))??"")},[()=>(e(j),r(()=>e(j).replace(/0(\d)$/,"¬∞$1").replace(/(\d{1,2})0(\d)/,"$1¬∞$2")))]),b(H,X)});var He=s(E,2),Be=o(He),N=s(Be,2);ve(N,5,()=>Wr,ge,(H,j)=>{var X=Ca(),Pe=o(X),Se={};F(()=>{x(Pe,`Periodo ${e(j),r(()=>e(j).nombre)??""}`),Se!==(Se=(e(j),r(()=>e(j).nombre)))&&(X.value=(X.__value=(e(j),r(()=>e(j).nombre)))??"")}),b(H,X)});var Y=s(S,2),M=o(Y),B=s(M,2),J=o(B);{var be=H=>{var j=Fa();b(H,j)},xe=H=>{var j=Ba();b(H,j)};re(J,H=>{e(Me)?H(be):H(xe,!1)})}F(()=>{c(ue,`color: ${e(v),r(()=>e(v).label)??""};`),c(we,`background-color: ${e(v),r(()=>e(v).inputBg)??""}; border-color: ${e(v),r(()=>e(v).border)??""}; color: ${e(v),r(()=>e(v).text)??""};`),c(h,`color: ${e(v),r(()=>e(v).label)??""};`),c($,`background-color: ${e(v),r(()=>e(v).inputBg)??""}; border-color: ${e(v),r(()=>e(v).border)??""}; color: ${e(v),r(()=>e(v).text)??""};`),c(K,`color: ${e(v),r(()=>e(v).label)??""};`),c(me,`background-color: ${e(v),r(()=>e(v).inputBg)??""}; border-color: ${e(v),r(()=>e(v).border)??""}; color: ${e(v),r(()=>e(v).text)??""};`),c(Be,`color: ${e(v),r(()=>e(v).label)??""};`),c(N,`background-color: ${e(v),r(()=>e(v).inputBg)??""}; border-color: ${e(v),r(()=>e(v).border)??""}; color: ${e(v),r(()=>e(v).text)??""};`),c(M,`border-color: ${e(v),r(()=>e(v).border)??""};`),B.disabled=e(Me)||!e(ke)||!e(T)||!e(G)}),Je(we,()=>e(ke),H=>g(ke,H)),Je($,()=>e(T),H=>g(T,H)),Je(me,()=>e(G),H=>g(G,H)),Je(N,()=>e(i),H=>g(i,H)),L("click",M,function(...H){a()?.apply(this,H)}),L("click",B,V),b(f,k)};re(Te,f=>{e(pe)?f(sr):f(lr,!1)})}var mr=s(I,2);{var Xe=f=>{wt(f,{onClose:()=>g(he,!1),get initialDocente(){return e(ke)}})};re(mr,f=>{e(he)&&f(Xe)})}F(()=>{c(O,`background-color: ${e(v),r(()=>e(v).cardBg)??""}; border-color: ${e(v),r(()=>e(v).cardBorder)??""}; color: ${e(v),r(()=>e(v).text)??""};`),c(ae,`border-color: ${e(v),r(()=>e(v).cardBorder)??""};`)}),L("click",Ne,function(...f){a()?.apply(this,f)}),L("click",I,vt(function(...f){a()?.apply(this,f)})),L("keydown",I,f=>f.key==="Escape"&&a()()),b(Ir,ne),Go()}var Ea=y('<div class="absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full animate-ping svelte-gsxx31"></div> <div class="absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full svelte-gsxx31"></div>',1),Ma=y('<div class="absolute -top-1 -right-1 w-3 h-3 bg-green-500 rounded-full animate-ping svelte-gsxx31"></div> <div class="absolute -top-1 -right-1 w-3 h-3 bg-green-500 rounded-full svelte-gsxx31"></div>',1),za=Cr('<svg class="w-5 h-5 text-indigo-500 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" class="svelte-gsxx31"></path></svg>'),Aa=Cr('<svg class="w-5 h-5 text-amber-500 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" class="svelte-gsxx31"></path></svg>'),Ta=Cr('<svg class="w-5 h-5 text-indigo-400 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" class="svelte-gsxx31"></path></svg>'),Ha=y('<div class="mb-6 p-4 rounded-xl border flex items-start gap-4 animate-fade-in relative transition-all duration-300 bg-green-50 dark:bg-indigo-900/40 border-green-200 dark:border-indigo-700 shadow-sm svelte-gsxx31"><div class="p-2 rounded-lg bg-green-100 dark:bg-indigo-800 text-green-700 dark:text-indigo-200 flex-shrink-0 svelte-gsxx31"><svg class="w-5 h-5 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-gsxx31"></path></svg></div> <div class="flex-1 pr-6 pt-0.5 svelte-gsxx31"><h4 class="text-sm font-bold mb-1 text-green-900 dark:text-indigo-100 svelte-gsxx31">Informaci√≥n</h4> <p class="text-sm leading-relaxed text-green-800 dark:text-indigo-200 svelte-gsxx31"> </p></div> <button class="absolute top-3 right-3 p-1.5 rounded-lg hover:bg-green-100 dark:hover:bg-indigo-700 text-green-600 hover:text-green-800 dark:text-indigo-400 dark:hover:text-indigo-100 transition-colors svelte-gsxx31" aria-label="Cerrar alerta"><svg class="w-4 h-4 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-gsxx31"></path></svg></button></div>'),ja=y('<option class="svelte-gsxx31"> </option>'),Ra=y('<option class="svelte-gsxx31"> </option>'),Na=y('<select><option class="svelte-gsxx31">Horas...</option><option class="svelte-gsxx31">0</option><!></select>'),Pa=y('<div><div class="flex items-center gap-1.5 svelte-gsxx31"><input type="checkbox" class="w-4 h-4 lg:w-5 lg:h-5 rounded text-indigo-500 focus:ring-indigo-500 svelte-gsxx31" style="accent-color: #6366f1;"/> <span class="text-sm lg:text-sm flex-shrink-0 svelte-gsxx31"> </span></div> <!></div>'),La=y("<div></div>"),Oa=y('<option class="svelte-gsxx31"> </option>'),Ga=y('<select id="materia" name="materia" required=""><option class="svelte-gsxx31"> </option><!></select>'),Va=y('<option class="svelte-gsxx31"> </option>'),Ua=y('<option class="svelte-gsxx31"> </option>'),Wa=y('<span><span class="mr-1.5 svelte-gsxx31"> </span> <button type="button" class="ml-1.5 hover:opacity-70 transition-opacity svelte-gsxx31" aria-label="Eliminar motivo"><svg class="w-3 h-3 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M6 18L18 6M6 6l12 12" class="svelte-gsxx31"></path></svg></button></span>'),qa=y('<option class="svelte-gsxx31"> </option>'),Ja=y('<option class="svelte-gsxx31"> </option>'),Ya=y('<div class="flex items-center gap-2 svelte-gsxx31"><button type="button" class="p-2 rounded-lg transition-colors hover:bg-black/5 dark:hover:bg-white/5 svelte-gsxx31" title="Agregar observaci√≥n"><svg class="w-5 h-5 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-gsxx31"></path></svg></button></div>'),Ka=y('<div class="px-4 pb-4 animate-fade-in svelte-gsxx31"><textarea placeholder="Escribe una observaci√≥n espec√≠fica para este estudiante..." rows="2" class="w-full px-4 py-2 rounded-xl border focus:ring-2 focus:ring-indigo-500 transition-all outline-none resize-none text-sm svelte-gsxx31"></textarea></div>'),Xa=y('<div><div class="flex-1 min-w-0 svelte-gsxx31"><span class="text-base font-medium block svelte-gsxx31"> </span> <div class="flex flex-wrap gap-2 mt-2 svelte-gsxx31"></div></div> <div class="flex flex-col sm:flex-row items-center gap-2 w-full sm:w-auto svelte-gsxx31"><div><select class="w-full appearance-none border rounded-lg px-4 py-2 pr-10 text-sm focus:ring-2 focus:ring-indigo-500 cursor-pointer transition-all outline-none svelte-gsxx31"><option class="svelte-gsxx31">Hora...</option><option class="svelte-gsxx31">0 (Sin hora)</option><!></select> <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 svelte-gsxx31"><svg class="w-4 h-4 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-gsxx31"></path></svg></div></div> <div class="relative w-full sm:w-56 svelte-gsxx31"><select class="w-full appearance-none border rounded-lg px-4 py-2 pr-10 text-sm focus:ring-2 focus:ring-indigo-500 cursor-pointer transition-all outline-none svelte-gsxx31"><option class="svelte-gsxx31">A√±adir motivo...</option><option class="svelte-gsxx31">üö´ Limpiar todo</option><!></select> <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 svelte-gsxx31"><svg class="w-4 h-4 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" class="svelte-gsxx31"></path></svg></div></div></div> <!></div> <!>',1),Za=y('<div class="text-center py-12 opacity-60 svelte-gsxx31">No hay estudiantes en este grado.</div>'),Qa=y('<div class="space-y-3 animate-fade-in svelte-gsxx31"><label class="block text-sm font-semibold uppercase tracking-wider svelte-gsxx31"> </label> <div class="space-y-2 max-h-[700px] overflow-y-auto border rounded-2xl p-4 bg-zinc-50/50 dark:bg-zinc-900/50 backdrop-blur-sm scrollbar-thin scrollbar-thumb-zinc-300 dark:scrollbar-thumb-zinc-600 svelte-gsxx31"><!> <!></div></div>'),es=Cr('<svg class="animate-spin h-6 w-6 lg:h-7 lg:w-7 svelte-gsxx31" fill="none" viewBox="0 0 24 24"><circle class="opacity-25 svelte-gsxx31" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75 svelte-gsxx31" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>'),rs=Cr('<svg class="h-6 w-6 lg:h-7 lg:w-7 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" class="svelte-gsxx31"></path></svg>'),os=y('<span class="absolute -top-1 -right-1 lg:-top-2 lg:-right-2 bg-red-500 text-white text-[10px] lg:text-xs font-bold rounded-full h-5 w-5 lg:h-6 lg:w-6 flex items-center justify-center ring-2 ring-white dark:ring-zinc-950 animate-bounce svelte-gsxx31"> </span>'),ts=y('<div class="min-h-screen flex flex-col lg:flex-row transition-colors duration-200 svelte-gsxx31"><aside class="w-full lg:w-80 lg:h-screen lg:sticky lg:top-0 border-b lg:border-b-0 lg:border-r transition-colors duration-200 p-6 lg:p-8 flex flex-col flex-shrink-0 z-40 svelte-gsxx31"><div class="flex flex-col lg:flex-col items-center justify-between lg:justify-start gap-4 lg:gap-8 svelte-gsxx31"><div class="flex items-center gap-4 lg:flex-col svelte-gsxx31"><img alt="EIE Logo" class="h-12 lg:h-20 w-auto svelte-gsxx31"/> <h1 class="text-xl lg:text-2xl tracking-tight font-bold lg:text-center svelte-gsxx31">Registrar Inasistencias</h1></div> <div class="flex flex-wrap justify-center lg:flex-col gap-3 w-full svelte-gsxx31"><button class="inline-flex items-center justify-center gap-2 px-3 lg:px-4 py-2 lg:py-3 border rounded-lg transition-all duration-200 hover:bg-black/5 dark:hover:bg-white/5 svelte-gsxx31" title="Abrir hoja de c√°lculo"><svg class="w-5 h-5 svelte-gsxx31" viewBox="0 0 24 24" fill="currentColor"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96z" class="svelte-gsxx31"></path></svg> <span class="text-sm font-medium hidden lg:inline svelte-gsxx31">Hoja de C√°lculo</span></button> <button id="filter-button-target" class="inline-flex items-center justify-center gap-2 px-3 lg:px-4 py-2 lg:py-3 border rounded-lg transition-all duration-200 hover:bg-black/5 dark:hover:bg-white/5 relative svelte-gsxx31" title="Abrir Looker Studio"><svg class="w-5 h-5 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" class="svelte-gsxx31"></path></svg> <span class="text-sm font-medium hidden lg:inline svelte-gsxx31">Filtros</span> <!></button> <button id="report-button-target" class="inline-flex items-center justify-center gap-2 px-3 lg:px-4 py-2 lg:py-3 border rounded-lg transition-all duration-200 hover:bg-black/5 dark:hover:bg-white/5 relative svelte-gsxx31" title="Generar reportes Excel"><svg class="w-5 h-5 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" class="svelte-gsxx31"></path></svg> <span class="text-sm font-medium hidden lg:inline svelte-gsxx31">Reporte Excel</span> <!></button> <button class="inline-flex items-center justify-center gap-2 px-3 lg:px-4 py-2 lg:py-3 border rounded-lg transition-all duration-200 hover:bg-black/5 dark:hover:bg-white/5 svelte-gsxx31" title="Ver reporte online"><svg class="w-5 h-5 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" class="svelte-gsxx31"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" class="svelte-gsxx31"></path></svg> <span class="text-sm font-medium hidden lg:inline svelte-gsxx31">Ver Online</span></button> <button class="inline-flex items-center justify-center gap-2 px-3 lg:px-4 py-2 lg:py-3 border rounded-lg transition-all duration-200 hover:bg-black/5 dark:hover:bg-white/5 svelte-gsxx31" title="Abrir Looker Studio"><svg class="w-5 h-5 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" class="svelte-gsxx31"></path></svg> <span class="text-sm font-medium hidden lg:inline svelte-gsxx31">Looker Studio</span></button> <button class="inline-flex items-center justify-center gap-2 px-3 lg:px-4 py-2 lg:py-3 border rounded-lg transition-all duration-200 hover:bg-black/5 dark:hover:bg-white/5 svelte-gsxx31" title="Volver al Dashboard"><svg class="w-5 h-5 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" class="svelte-gsxx31"></path></svg> <span class="text-sm font-medium hidden lg:inline svelte-gsxx31">Dashboard</span></button> <div class="relative svelte-gsxx31"><button class="inline-flex items-center justify-center gap-2 px-3 lg:px-4 py-2 lg:py-3 border rounded-lg transition-all duration-200 hover:bg-black/5 dark:hover:bg-white/5 w-full svelte-gsxx31" aria-label="Cambiar tema"><!> <span class="text-sm font-medium hidden lg:inline capitalize svelte-gsxx31"> </span></button></div></div></div></aside> <main class="flex-1 p-4 sm:p-6 lg:p-8 overflow-y-auto svelte-gsxx31"><div class="max-w-4xl mx-auto rounded-2xl p-6 lg:p-8 transition-colors duration-200 border svelte-gsxx31"><!> <!> <!> <form class="space-y-6 svelte-gsxx31"><div class="grid grid-cols-1 md:grid-cols-2 gap-6 svelte-gsxx31"><div class="space-y-2 svelte-gsxx31"><label for="docente" class="block text-sm font-medium svelte-gsxx31">Docente</label> <select id="docente" name="docente" required=""><option class="svelte-gsxx31"> </option><!></select></div> <div><div class="flex items-center justify-between svelte-gsxx31"><label for="materia" class="block text-sm font-medium svelte-gsxx31">Materia</label></div> <!></div></div> <div class="grid grid-cols-1 md:grid-cols-2 gap-6 svelte-gsxx31"><div class="space-y-2 svelte-gsxx31"><label for="horas" class="block text-sm font-medium svelte-gsxx31">Cantidad de Horas</label> <select id="horas" name="horas" required=""><option class="svelte-gsxx31">Seleccione horas</option><option class="svelte-gsxx31">Sin hora espec√≠fica</option><!></select></div> <div class="space-y-2 svelte-gsxx31"><label for="grado" class="block text-sm font-medium svelte-gsxx31">Grado</label> <select id="grado" name="grado" required=""><option class="svelte-gsxx31"> </option><!></select></div></div> <!> <div class="grid grid-cols-1 md:grid-cols-2 gap-6 svelte-gsxx31"><div class="space-y-2 svelte-gsxx31"><label for="fecha" class="block text-sm font-medium svelte-gsxx31">Fecha</label> <input type="date" id="fecha" name="fecha" required="" class="w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-indigo-500 transition-all outline-none svelte-gsxx31"/></div> <div class="space-y-2 svelte-gsxx31"><label for="observaciones" class="block text-sm font-medium svelte-gsxx31">Observaciones</label> <textarea id="observaciones" name="observaciones" rows="3" placeholder="Opcional..." class="w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-indigo-500 transition-all outline-none resize-none svelte-gsxx31"></textarea></div></div> <div class="flex items-center justify-between pt-6 border-t svelte-gsxx31"><div class="text-sm font-medium svelte-gsxx31">Inasistencias marcadas: <span class="text-indigo-500 font-bold ml-1 svelte-gsxx31"> </span></div></div></form></div></main> <button class="fixed bottom-6 right-6 lg:bottom-10 lg:right-10 bg-green-600 hover:bg-green-700 text-white p-4 lg:p-5 rounded-full shadow-2xl hover:shadow-green-500/20 transform transition-all duration-300 hover:scale-110 active:scale-95 disabled:opacity-50 disabled:grayscale disabled:cursor-not-allowed z-50 group svelte-gsxx31" title="Guardar inasistencias"><!> <!></button></div> <!> <!> <!>',1);function cs(Ir,cr){No(cr,!1);const m=()=>Mt(ft,"$theme",Ye),[Ye,$e]=zt(),v=_(),t=_(),_e=_(),a=_(),q=_(),Re=_(),Ve=_(),dr="¬°Nueva funci√≥n de filtrado avanzado disponible!",ke="¬°Nueva funci√≥n de reporte en Excel disponible!";let T=Rr(cr,"onBack",8),G=_([]),i=_([]),or=_([]),pe=_(!1),Me=_(!1),he=_(!1),u=_({docente:localStorage.getItem("lastDocente")||"",materia:"",horas:"",grado:"",fecha:new Date().toLocaleDateString("en-CA"),observaciones:""}),P=_([]),Ue=_({}),tr=_({}),Ke=_(!1),V=_(!1),ne=_([]),I=_(!1),O=_(!1),ae=_(!1);const Ne=()=>{g(I,!0)},ar=()=>{g(I,!1)},Te=()=>{g(O,!0)},sr=()=>{g(O,!1)},lr=()=>{g(ae,!0)},mr=()=>{g(ae,!1)};let Xe=_(localStorage.getItem("dismissedInfoInasistenciaContent")!==dt),f=_(!0),k=_(!0);function S(n){return!0}const ie=()=>{localStorage.setItem("dismissedInfoInasistenciaContent",dt),g(Xe,!1)},ue=()=>{localStorage.setItem("dismissedFeatureAlertFilters",new Date().toISOString()),g(f,!1)},we=()=>{localStorage.setItem("dismissedFeatureAlertFilters",new Date().toISOString()),Ne()},Ce=()=>{localStorage.setItem("dismissedFeatureAlertReport",new Date().toISOString()),g(k,!1)},Fe=()=>{localStorage.setItem("dismissedFeatureAlertReport",new Date().toISOString()),Te(),g(k,!1)};let d=_(JSON.parse(localStorage.getItem("docenteMaterias")||"{}"));const h=(n,l)=>{!n||!l||(e(d)[n]||Ee(d,e(d)[n]=[]),e(d)[n].includes(l)||(Ee(d,e(d)[n]=[...e(d)[n],l]),localStorage.setItem("docenteMaterias",JSON.stringify(e(d)))))},$=()=>`https://docs.google.com/spreadsheets/d/${po}`,w=()=>{window.open($(),"_blank")},A=()=>{window.open(Rt,"_blank")},E=n=>{const l=n.match(/-(\d+)$/);return l?l[1]:null},K=[{value:"Sin excusa",label:"Sin excusa",icon:"üö´",bgColor:"bg-red-50",borderColor:"border-red-300",textColor:"text-red-700",darkBgColor:"dark:bg-red-950",darkBorderColor:"dark:border-red-800",darkTextColor:"dark:text-red-300",obligaHoras:!0},{value:"Excusa",label:"Excusa",icon:"üìÑ",bgColor:"bg-blue-50",borderColor:"border-blue-300",textColor:"text-blue-700",darkBgColor:"dark:bg-blue-950",darkBorderColor:"dark:border-blue-800",darkTextColor:"dark:text-blue-300",obligaHoras:!0},{value:"LLegada Tarde",label:"Llegada Tarde",icon:"‚è∞",bgColor:"bg-indigo-50",borderColor:"border-indigo-300",textColor:"text-indigo-700",darkBgColor:"dark:bg-indigo-950",darkBorderColor:"dark:border-indigo-800",darkTextColor:"dark:text-indigo-300",obligaHoras:!1},{value:"Transporte Escolar",label:"Transporte Escolar",icon:"üöå",bgColor:"bg-red-50",borderColor:"border-red-300",textColor:"text-red-700",darkBgColor:"dark:bg-red-950",darkBorderColor:"dark:border-red-800",darkTextColor:"dark:text-red-300",obligaHoras:!0},{value:"Permiso",label:"Permiso",icon:"‚úÖ",bgColor:"bg-green-50",borderColor:"border-green-300",textColor:"text-green-700",darkBgColor:"dark:bg-green-950",darkBorderColor:"dark:border-green-800",darkTextColor:"dark:text-green-300",obligaHoras:!0},{value:"No portar/sin uniforme",label:"No portar/sin uniforme",icon:"üëö",bgColor:"bg-cyan-50",borderColor:"border-cyan-300",textColor:"text-cyan-700",darkBgColor:"dark:bg-cyan-950",darkBorderColor:"dark:border-cyan-800",darkTextColor:"dark:text-cyan-300",obligaHoras:!1},{value:"Pacto de Aula",label:"Pacto de Aula",icon:"ü§ù",bgColor:"bg-purple-50",borderColor:"border-purple-300",textColor:"text-purple-700",darkBgColor:"dark:bg-purple-950",darkBorderColor:"dark:border-purple-800",darkTextColor:"dark:text-purple-300",obligaHoras:!1},{value:"Uso del celular",label:"Uso del celular",icon:"üì±",bgColor:"bg-orange-50",borderColor:"border-orange-300",textColor:"text-orange-700",darkBgColor:"dark:bg-orange-950",darkBorderColor:"dark:border-orange-800",darkTextColor:"dark:text-orange-300",obligaHoras:!1},{value:"Desorden en Clase",label:"Desorden en Clase",icon:"üîä",bgColor:"bg-yellow-50",borderColor:"border-yellow-300",textColor:"text-yellow-700",darkBgColor:"dark:bg-yellow-950",darkBorderColor:"dark:border-yellow-800",darkTextColor:"dark:text-yellow-300",obligaHoras:!1},{value:"Fuga",label:"Fuga",icon:"üèÉ‚Äç‚ôÇÔ∏è",bgColor:"bg-red-100",borderColor:"border-red-400",textColor:"text-red-800",darkBgColor:"dark:bg-red-950",darkBorderColor:"dark:border-red-800",darkTextColor:"dark:text-red-300",obligaHoras:!0},{value:"No realizaci√≥n de Aseo",label:"No realizaci√≥n de Aseo",icon:"üßπ",bgColor:"bg-teal-50",borderColor:"border-teal-300",textColor:"text-teal-700",darkBgColor:"dark:bg-teal-950",darkBorderColor:"dark:border-teal-800",darkTextColor:"dark:text-teal-300",obligaHoras:!1},{value:"Licencia por salud",label:"Licencia por salud",icon:"üè•",bgColor:"bg-cyan-50",borderColor:"border-cyan-300",textColor:"text-cyan-700",darkBgColor:"dark:bg-cyan-950",darkBorderColor:"dark:border-cyan-800",darkTextColor:"dark:text-cyan-300",obligaHoras:!0},{value:"Incapacidad",label:"Incapacidad",icon:"ü©∫",bgColor:"bg-pink-50",borderColor:"border-pink-300",textColor:"text-pink-700",darkBgColor:"dark:bg-pink-950",darkBorderColor:"dark:border-pink-800",darkTextColor:"dark:text-pink-300",obligaHoras:!0},{value:"Reuni√≥n interna",label:"Reuni√≥n interna",icon:"üë•",bgColor:"bg-zinc-50",borderColor:"border-zinc-300",textColor:"text-zinc-700",darkBgColor:"dark:bg-zinc-950",darkBorderColor:"dark:border-zinc-800",darkTextColor:"dark:text-zinc-300",obligaHoras:!1},{value:"Ignorar",label:"Ignorar",icon:"üö´",bgColor:"bg-zinc-50",borderColor:"border-zinc-300",textColor:"text-zinc-700",darkBgColor:"dark:bg-zinc-950",darkBorderColor:"dark:border-zinc-800",darkTextColor:"dark:text-zinc-300",obligaHoras:!1},{value:"Psicoorientaci√≥n",label:"Psicoorientaci√≥n",icon:"üß†",bgColor:"bg-green-50",borderColor:"border-green-300",textColor:"text-green-700",darkBgColor:"dark:bg-green-950",darkBorderColor:"dark:border-green-800",darkTextColor:"dark:text-green-300",obligaHoras:!1},{value:"Retirado por el acudiente",label:"Retirado por el acudiente",icon:"üë®",bgColor:"bg-green-50",borderColor:"border-green-300",textColor:"text-green-700",darkBgColor:"dark:bg-green-950",darkBorderColor:"dark:border-green-800",darkTextColor:"dark:text-green-300",obligaHoras:!1}],me=()=>{ft.update(n=>n==="light"?"dim":n==="dim"?"dark":"light")},D=async()=>{g(pe,!0),g(Me,!0),g(he,!0);try{const[n,l,p]=await Promise.all([Uo(),Wo(),qo()]);g(G,n),g(i,l),g(or,p)}catch(n){console.error("Error cargando datos iniciales:",n)}finally{g(pe,!1),g(Me,!1),g(he,!1)}},ze=(n,l)=>{g(P,e(P).filter(p=>!(p.nombre===n&&p.motivo===l)))},He=(n,l,p)=>{if(l===""||l==="Ignorar"){g(P,e(P).filter(R=>R.nombre!==n));return}const C=K.find(R=>R.value===l);if(!C)return;let U=e(Ue)[n]||e(u).horas;if(C.obligaHoras||(U="0"),C.obligaHoras&&g(P,e(P).filter(R=>{if(R.nombre!==n)return!0;const Q=K.find(oe=>oe.value===R.motivo);return Q&&!Q.obligaHoras})),!e(P).some(R=>R.nombre===n&&R.motivo===l)){const R=e(P).find(Q=>Q.nombre===n)?.observaciones||"";g(P,[...e(P),{nombre:n,motivo:l,horas:U,observaciones:R}])}},Be=(n,l)=>{g(P,e(P).map(p=>p.nombre===n?{...p,observaciones:l}:p))},N=n=>{Ee(tr,e(tr)[n]=!e(tr)[n])},Y=(n,l)=>{Ee(Ue,e(Ue)[n]=l),g(P,e(P).map(p=>{if(p.nombre===n){const C=K.find(U=>U.value===p.motivo);if(C&&C.obligaHoras)return{...p,horas:l}}return p}))},M=async n=>{if(n.preventDefault(),e(Ke))return;g(V,!0);const l=[];if(e(u).docente||l.push({id:"docente",label:"Docente"}),e(u).fecha||l.push({id:"fecha",label:"Fecha"}),e(u).grado||l.push({id:"grado",label:"Grado"}),e(t))if(e(ne).length===0)l.push({id:"materia",label:"Materia(s)"});else{const p=e(ne).filter(C=>!C.horas);p.length>0&&l.push({id:"horas",label:`Horas para: ${p.map(C=>C.materia).join(", ")}`})}else e(u).materia||l.push({id:"materia",label:"Materia"}),e(u).horas||l.push({id:"horas",label:"Horas"});if(l.length>0){await Ge.fire({icon:"warning",title:"Campos requeridos",html:`Complete los siguientes campos:<br/><br/><strong>${l.map(C=>C.label).join("<br/>")}</strong>`,confirmButtonColor:"#6366f1"});const p=document.getElementById(l[0].id);p&&(p.scrollIntoView({behavior:"smooth",block:"center"}),p.focus());return}if(e(P).length===0){await Ge.fire({icon:"warning",title:"Sin inasistencias",text:"Debe seleccionar al menos un estudiante con un motivo de inasistencia",confirmButtonColor:"#6366f1"});return}g(Ke,!0);try{const p=new Date().toISOString(),C=e(t)?e(ne):[{materia:e(u).materia,horas:e(u).horas}];if(e(t)&&e(ne).length===0){await Ge.fire({icon:"warning",title:"Atenci√≥n",text:"Seleccione al menos una materia",confirmButtonColor:"#6366f1"});return}const U=C.filter(Q=>!Q.horas);if(U.length>0){await Ge.fire({icon:"warning",title:"Atenci√≥n",text:`Seleccione horas para: ${U.map(Q=>Q.materia).join(", ")}`,confirmButtonColor:"#6366f1"});return}const W=[],R=e(P).filter(Q=>Q.motivo&&Q.motivo!=="Ignorar");for(const Q of C)for(const oe of R)W.push([p,e(u).docente,e(u).fecha,Q.horas,Q.materia,oe.motivo,e(u).grado,oe.nombre,oe.observaciones||e(u).observaciones]);await Nt({spreadsheetId:po,worksheetTitle:Vo,inasistencias:W});for(const Q of C)h(e(u).docente,Q.materia);await Ge.fire({icon:"success",title:"¬°√âxito!",text:`${W.length} inasistencia(s) registrada(s) exitosamente`,timer:3e3,timerProgressBar:!0,showConfirmButton:!1,position:"top-end",toast:!0}),g(u,{...e(u),grado:"",fecha:new Date().toLocaleDateString("en-CA"),observaciones:"",horas:""}),g(P,[]),g(Ue,{}),g(tr,{}),g(ne,[]),g(V,!1)}catch(p){console.error("Error enviando:",p),await Ge.fire({icon:"error",title:"Error",text:"Error al registrar la inasistencia",confirmButtonColor:"#ef4444"})}finally{g(Ke,!1)}};Po(()=>{D(),g(f,S()),g(k,S())}),Ae(()=>e(u),()=>{g(t,e(u).docente.includes("-"))}),Ae(()=>(e(u),e(t),e(ne)),()=>{g(v,(()=>{const n=[];return e(u).docente||n.push("docente"),e(u).fecha||n.push("fecha"),e(u).grado||n.push("grado"),e(t)?e(ne).length===0?n.push("materias"):e(ne).filter(p=>!p.horas).length>0&&n.push("horas"):(e(u).materia||n.push("materia"),e(u).horas||n.push("horas")),n})())}),Ae(()=>e(u),()=>{e(u).docente&&localStorage.setItem("lastDocente",e(u).docente)}),Ae(()=>(e(u),e(i),e(d)),()=>{g(_e,e(u).docente?[...e(i)].sort((n,l)=>{const p=e(d)[e(u).docente]?.includes(n.materia),C=e(d)[e(u).docente]?.includes(l.materia);return p&&!C?-1:!p&&C?1:n.materia.localeCompare(l.materia)}):e(i))}),Ae(()=>{},()=>{g(a,{bg:"rgb(var(--bg-primary))",text:"rgb(var(--text-primary))",label:"rgb(var(--text-secondary))",border:"rgb(var(--border-primary))",placeholder:"rgb(var(--text-muted))",icon:"rgb(var(--text-muted))",cardBg:"rgb(var(--card-bg))",cardBorder:"rgb(var(--card-border))",inputBg:"rgb(var(--bg-secondary))"})}),Ae(()=>(e(u),e(or)),()=>{g(q,e(u).grado?e(or).filter(n=>n.grado.toString()===e(u).grado):[])}),Ae(()=>e(u),()=>{g(Re,E(e(u).docente))}),Ae(()=>(e(Re),e(or)),()=>{g(Ve,e(Re)?[...new Set(e(or).map(n=>n.grado.toString()))].filter(n=>n.startsWith(`${e(Re)}-`)):[...new Set(e(or).map(n=>n.grado.toString()))].filter(n=>!n.includes("-")))}),Lo(),Oo();var B=ts(),J=$r(B),be=o(J),xe=o(be),H=o(xe),j=o(H),X=s(j,2),Pe=s(H,2),Se=o(Pe),kr=s(Se,2),Jo=s(o(kr),4);{var Yo=n=>{var l=Ea();b(n,l)};re(Jo,n=>{e(f)&&n(Yo)})}var Fr=s(kr,2),Ko=s(o(Fr),4);{var Nr=n=>{var l=Ma();b(n,l)};re(Ko,n=>{e(k)&&n(Nr)})}var Br=s(Fr,2),qr=s(Br,2),Jr=s(qr,2),Xo=s(Jr,2),Yr=o(Xo),Kr=o(Yr);{var bo=n=>{var l=za();b(n,l)},Xr=n=>{var l=Aa();b(n,l)},Zo=n=>{var l=Ta();b(n,l)};re(Kr,n=>{m()==="dark"?n(bo):m()==="light"?n(Xr,1):n(Zo,!1)})}var Pr=s(Kr,2),Lr=o(Pr),xo=s(be,2),fo=o(xo),ho=o(fo);{var Qo=n=>{var l=Ha(),p=s(o(l),2),C=s(o(p),2),U=o(C),W=s(p,2);F(()=>x(U,dt)),L("click",W,ie),b(n,l)};re(ho,n=>{e(Xe)&&n(Qo)})}var mo=s(ho,2);xt(mo,{featureMessage:dr,description:"Ahora puedes filtrar tus datos de forma avanzada. ¬°Pru√©balo!",onTryNow:we,onDismiss:ue,targetSelector:"#filter-button-target",showPopup:!1,colorTheme:"blue"});var Zr=s(mo,2);xt(Zr,{featureMessage:ke,description:"Ahora puedes generar reportes de inasistencias en formato Excel. ¬°Descarga y analiza tus datos!",onTryNow:Fe,onDismiss:Ce,targetSelector:"#report-button-target",showPopup:!1,colorTheme:"green"});var Er=s(Zr,2),Mr=o(Er),_o=o(Mr),ko=o(_o),zr=s(ko,2),Or=o(zr),et=o(Or);Or.value=Or.__value="";var wo=s(Or);ve(wo,1,()=>e(G),ge,(n,l)=>{var p=ja(),C=o(p),U={};F(()=>{x(C,e(l)),U!==(U=e(l))&&(p.value=(p.__value=e(l))??"")}),b(n,p)});var Qr=s(_o,2),Gr=o(Qr),rt=o(Gr),yo=s(Gr,2);{var eo=n=>{var l=La();ve(l,5,()=>e(_e),ge,(p,C)=>{const U=pr(()=>(e(d),e(u),e(C),r(()=>e(d)[e(u).docente]?.includes(e(C).materia)))),W=pr(()=>(e(ne),e(C),r(()=>e(ne).findIndex(Le=>Le.materia===e(C).materia)))),R=pr(()=>e(W)>=0);var Q=Pa(),oe=o(Q),ee=o(oe),se=s(ee,2),We=o(se),Qe=s(oe,2);{var _r=Le=>{var er=Na(),nr=o(er);nr.value=nr.__value="";var ir=s(nr);ir.value=ir.__value="0";var br=s(ir);ve(br,0,()=>[1,2,3,4],ge,(vr,xr)=>{var Oe=Ra(),wr=o(Oe),Ie={};F(fr=>{x(wr,`${xr??""}h`),Ie!==(Ie=fr)&&(Oe.value=(Oe.__value=fr)??"")},[()=>r(()=>xr.toString())]),b(vr,Oe)}),F((vr,xr)=>{ur(er,1,`w-full lg:w-16 px-2 py-1.5 lg:py-1 text-sm rounded border appearance-none cursor-pointer ${vr??""}`,"svelte-gsxx31"),c(er,`background-color: ${e(a),r(()=>e(a).inputBg)??""}; border-color: ${xr??""}; color: ${e(a),r(()=>e(a).text)??""};`)},[()=>(e(V),e(v),e(ne),ye(e(W)),r(()=>e(V)&&e(v).includes("horas")&&!e(ne)[e(W)].horas?"ring-2 ring-red-500 border-red-500":"")),()=>(e(V),e(v),e(ne),ye(e(W)),e(a),r(()=>e(V)&&e(v).includes("horas")&&!e(ne)[e(W)].horas?"#ef4444":e(a).border))]),Je(er,()=>e(ne)[e(W)].horas,vr=>(Ee(ne,e(ne)[e(W)].horas=vr),qe(()=>{e(W),e(V),e(v),e(a)}))),b(Le,er)};re(Qe,Le=>{e(R)&&Le(_r)})}F(()=>{ur(Q,1,`flex flex-col lg:flex-row lg:items-center gap-1 lg:gap-2 px-2 py-2 lg:py-1.5 rounded-lg border transition-all ${e(R)?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/30 dark:border-indigo-500":"border-transparent"}`,"svelte-gsxx31"),c(Q,`border-color: ${ye(e(R)),e(a),r(()=>e(R)?"#6366f1":e(a).border)??""};`),At(ee,e(R)),c(se,`color: ${e(a),r(()=>e(a).text)??""};`),x(We,`${e(U)?"‚≠ê ":""}${e(C),r(()=>e(C).materia)??""}`)}),L("change",ee,Le=>{Le.currentTarget.checked?g(ne,[...e(ne),{materia:e(C).materia,horas:""}]):g(ne,e(ne).filter(er=>er.materia!==e(C).materia))}),b(p,Q)}),F((p,C)=>{ur(l,1,`border rounded-xl p-2 lg:p-3 flex flex-col lg:flex-row lg:flex-wrap gap-2 lg:gap-2 ${p??""}`,"svelte-gsxx31"),c(l,`border-color: ${C??""}; background-color: ${e(a),r(()=>e(a).inputBg)??""};`)},[()=>(e(V),e(v),r(()=>e(V)&&e(v).includes("materias")?"ring-2 ring-red-500 border-red-500":"")),()=>(e(V),e(v),e(a),r(()=>e(V)&&e(v).includes("materias")?"#ef4444":e(a).border))]),b(n,l)},ot=n=>{var l=Ga(),p=o(l),C=o(p);p.value=p.__value="";var U=s(p);ve(U,1,()=>e(_e),ge,(W,R)=>{const Q=pr(()=>(e(d),e(u),e(R),r(()=>e(d)[e(u).docente]?.includes(e(R).materia))));var oe=Oa(),ee=o(oe),se={};F(()=>{c(oe,e(Q)?"color: #6366f1; font-weight: 600;":""),x(ee,`${e(Q)?"‚≠ê ":""}${e(R),r(()=>e(R).materia)??""}`),se!==(se=(e(R),r(()=>e(R).materia)))&&(oe.value=(oe.__value=(e(R),r(()=>e(R).materia)))??"")}),b(W,oe)}),F((W,R)=>{l.disabled=e(Me),ur(l,1,`w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-indigo-500 transition-all outline-none appearance-none cursor-pointer disabled:opacity-50 ${W??""}`,"svelte-gsxx31"),c(l,`background-color: ${e(a),r(()=>e(a).inputBg)??""}; border-color: ${R??""}; color: ${e(a),r(()=>e(a).text)??""};`),x(C,e(Me)?"Cargando...":"Seleccione materia")},[()=>(e(V),e(v),r(()=>e(V)&&e(v).includes("materia")?"ring-2 ring-red-500 border-red-500":"")),()=>(e(V),e(v),e(a),r(()=>e(V)&&e(v).includes("materia")?"#ef4444":e(a).border))]),Je(l,()=>e(u).materia,W=>(Ee(u,e(u).materia=W),qe(()=>{e(pe),e(V),e(v),e(a),e(G),e(Me),e(_e),e(d),e(he),e(Ve)}))),b(n,l)};re(yo,n=>{e(t)?n(eo):n(ot,!1)})}var ro=s(Mr,2),oo=o(ro),$o=o(oo),Vr=s($o,2),to=o(Vr);to.value=to.__value="";var ao=s(to);ao.value=ao.__value="0";var tt=s(ao);ve(tt,0,()=>[1,2,3,4],ge,(n,l)=>{var p=Va(),C=o(p),U={};F(W=>{x(C,`${l??""} ${l===1?"Hora":"Horas"}`),U!==(U=W)&&(p.value=(p.__value=W)??"")},[()=>r(()=>l.toString())]),b(n,p)});var z=s(oo,2),Z=o(z),ce=s(Z,2),De=o(ce),Ze=o(De);De.value=De.__value="";var Sr=s(De);ve(Sr,1,()=>e(Ve),ge,(n,l)=>{var p=Ua(),C=o(p),U={};F(W=>{x(C,W),U!==(U=e(l))&&(p.value=(p.__value=e(l))??"")},[()=>(e(l),r(()=>e(l).replace(/0(\d)$/,"¬∞$1").replace(/(\d{1,2})0(\d)/,"$1¬∞$2")))]),b(n,p)});var Co=s(ro,2);{var Fo=n=>{var l=Qa(),p=o(l),C=o(p),U=s(p,2),W=o(U);ve(W,1,()=>e(q),oe=>oe.nombre,(oe,ee)=>{const se=pr(()=>(e(P),e(ee),r(()=>e(P).filter(de=>de.nombre===e(ee).nombre)))),We=pr(()=>(ye(e(se)),r(()=>e(se).length>0))),Qe=pr(()=>(ye(e(se)),r(()=>e(se).some(de=>{const le=K.find(te=>te.value===de.motivo);return le&&le.obligaHoras}))));var _r=Xa(),Le=$r(_r);let er;var nr=o(Le),ir=o(nr),br=o(ir),vr=s(ir,2);ve(vr,5,()=>e(se),ge,(de,le)=>{const te=pr(()=>(e(le),r(()=>K.find(jr=>jr.value===e(le).motivo))));var hr=mt(),Ur=$r(hr);{var Hr=jr=>{var ct=Wa(),ut=o(ct),Dt=o(ut),pt=s(ut),It=s(pt);F(()=>{ur(ct,1,(ye(e(te)),r(()=>`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-semibold border ${e(te).bgColor} ${e(te).textColor} ${e(te).borderColor} ${e(te).darkBgColor} ${e(te).darkTextColor} ${e(te).darkBorderColor}`)),"svelte-gsxx31"),x(Dt,(ye(e(te)),r(()=>e(te).icon))),x(pt,` ${ye(e(te)),r(()=>e(te).label)??""} `)}),L("click",It,()=>ze(e(ee).nombre,e(le).motivo)),b(jr,ct)};re(Ur,jr=>{e(te)&&jr(Hr)})}b(de,hr)});var xr=s(nr,2),Oe=o(xr);let wr;var Ie=o(Oe),fr=o(Ie);fr.value=fr.__value="";var rr=s(fr);rr.value=rr.__value="0";var je=s(rr);ve(je,0,()=>[1,2,3,4],ge,(de,le)=>{var te=qa(),hr=o(te),Ur={};F(Hr=>{x(hr,le),Ur!==(Ur=Hr)&&(te.value=(te.__value=Hr)??"")},[()=>r(()=>le.toString())]),b(de,te)});var fe;Tt(Ie);var gr=s(Ie,2),Tr=s(Oe,2),Dr=o(Tr),uo=o(Dr);uo.value=uo.__value="";var it=s(uo);it.value=it.__value="Ignorar";var yt=s(it);ve(yt,1,()=>K,ge,(de,le)=>{const te=pr(()=>(ye(e(se)),e(le),r(()=>e(se).some(jr=>jr.motivo===e(le).value))));var hr=Ja(),Ur=o(hr),Hr={};F(()=>{hr.disabled=e(te),x(Ur,`${e(le),r(()=>e(le).icon)??""} ${e(le),r(()=>e(le).label)??""} ${e(te)?"‚úì":""}`),Hr!==(Hr=(e(le),r(()=>e(le).value)))&&(hr.value=(hr.__value=(e(le),r(()=>e(le).value)))??"")}),b(de,hr)}),Dr.value=Dr.__value="";var $t=s(Dr,2),Ct=s(xr,2);{var Ft=de=>{var le=Ya(),te=o(le);F(()=>c(te,`color: ${ye(e(se)),e(a),r(()=>e(se)[0]?.observaciones?"rgb(var(--text-primary))":e(a).icon)??""};`)),L("click",te,()=>N(e(ee).nombre)),b(de,le)};re(Ct,de=>{e(We)&&de(Ft)})}var Bt=s(Le,2);{var St=de=>{var le=Ka(),te=o(le);F(()=>{jt(te,(ye(e(se)),r(()=>e(se)[0]?.observaciones||""))),c(te,`background-color: ${e(a),r(()=>e(a).inputBg)??""}; border-color: ${e(a),r(()=>e(a).border)??""}; color: ${e(a),r(()=>e(a).text)??""};`)}),L("input",te,hr=>Be(e(ee).nombre,hr.currentTarget.value)),b(de,le)};re(Bt,de=>{ye(e(We)),e(tr),e(ee),ye(e(se)),r(()=>e(We)&&(e(tr)[e(ee).nombre]||e(se)[0]?.observaciones))&&de(St)})}F(de=>{er=ur(Le,1,"flex flex-col sm:flex-row sm:items-center justify-between p-4 border rounded-xl transition-all duration-200 gap-4 svelte-gsxx31",null,er,{"ring-2":e(We),"ring-indigo-500":e(We)}),c(Le,`background-color: ${e(a),r(()=>e(a).bg)??""}; border-color: ${ye(e(We)),e(a),r(()=>e(We)?"transparent":e(a).border)??""};`),c(ir,`color: ${e(a),r(()=>e(a).text)??""};`),x(br,(e(ee),r(()=>e(ee).nombre))),wr=ur(Oe,1,"relative w-full sm:w-32 transition-opacity duration-200 svelte-gsxx31",null,wr,{"opacity-40":!e(Qe)}),Ie.disabled=!e(Qe),c(Ie,`background-color: ${e(a),r(()=>e(a).inputBg)??""}; border-color: ${e(a),r(()=>e(a).border)??""}; color: ${e(a),r(()=>e(a).text)??""};`),fe!==(fe=de)&&(Ie.value=(Ie.__value=de)??"",Ht(Ie,de)),c(gr,`color: ${e(a),r(()=>e(a).icon)??""};`),c(Dr,`background-color: ${e(a),r(()=>e(a).inputBg)??""}; border-color: ${e(a),r(()=>e(a).border)??""}; color: ${e(a),r(()=>e(a).text)??""};`),c($t,`color: ${e(a),r(()=>e(a).icon)??""};`)},[()=>(ye(e(se)),e(Ue),e(ee),e(u),r(()=>e(se).find(de=>{const le=K.find(te=>te.value===de.motivo);return le&&le.obligaHoras})?.horas||e(Ue)[e(ee).nombre]||e(u).horas))]),L("change",Ie,de=>Y(e(ee).nombre,de.currentTarget.value)),L("change",Dr,de=>{He(e(ee).nombre,de.currentTarget.value),de.currentTarget.value=""}),b(oe,_r)});var R=s(W,2);{var Q=oe=>{var ee=Za();F(()=>c(ee,`color: ${e(a),r(()=>e(a).text)??""};`)),b(oe,ee)};re(R,oe=>{e(q),r(()=>e(q).length===0)&&oe(Q)})}F(()=>{c(p,`color: ${e(a),r(()=>e(a).label)??""};`),x(C,`Estudiantes del Grado ${e(u),r(()=>e(u).grado)??""}`),c(U,`border-color: ${e(a),r(()=>e(a).border)??""};`)}),b(n,l)};re(Co,n=>{e(u),r(()=>e(u).grado&&e(u).horas!=="")&&n(Fo)})}var so=s(Co,2),lo=o(so),no=o(lo),io=s(no,2),Bo=s(lo,2),co=o(Bo),So=s(co,2),Do=s(so,2),vo=o(Do),Io=s(o(vo)),at=o(Io),Ar=s(xo,2),Eo=o(Ar);{var Mo=n=>{var l=es();b(n,l)},zo=n=>{var l=rs();b(n,l)};re(Eo,n=>{e(Ke)?n(Mo):n(zo,!1)})}var Ao=s(Eo,2);{var To=n=>{var l=os(),p=o(l);F(()=>x(p,(e(P),r(()=>e(P).length)))),b(n,l)};re(Ao,n=>{e(Ke),e(P),r(()=>!e(Ke)&&e(P).length>0)&&n(To)})}var go=s(J,2);{var Ho=n=>{na(n,{onClose:ar,get selectedDocente(){return e(u),r(()=>e(u).docente)}})};re(go,n=>{e(I)&&n(Ho)})}var jo=s(go,2);{var st=n=>{Ia(n,{onClose:sr,get initialDocente(){return e(u),r(()=>e(u).docente)}})};re(jo,n=>{e(O)&&n(st)})}var lt=s(jo,2);{var nt=n=>{wt(n,{onClose:mr,get initialDocente(){return e(u),r(()=>e(u).docente)}})};re(lt,n=>{e(ae)&&n(nt)})}F((n,l,p,C,U,W)=>{c(J,`background-color: ${e(a),r(()=>e(a).bg)??""};`),c(be,`background-color: ${e(a),r(()=>e(a).cardBg)??""}; border-color: ${e(a),r(()=>e(a).cardBorder)??""};`),yr(j,"src",kt),c(X,`color: ${e(a),r(()=>e(a).text)??""};`),c(Se,`background-color: ${e(a),r(()=>e(a).inputBg)??""}; border-color: ${e(a),r(()=>e(a).border)??""}; color: ${e(a),r(()=>e(a).text)??""};`),c(kr,`background-color: ${e(a),r(()=>e(a).inputBg)??""}; border-color: ${e(a),r(()=>e(a).border)??""}; color: ${e(a),r(()=>e(a).text)??""};`),c(Fr,`background-color: ${e(a),r(()=>e(a).inputBg)??""}; border-color: ${e(a),r(()=>e(a).border)??""}; color: ${e(a),r(()=>e(a).text)??""};`),c(Br,`background-color: ${e(a),r(()=>e(a).inputBg)??""}; border-color: ${e(a),r(()=>e(a).border)??""}; color: ${e(a),r(()=>e(a).text)??""};`),c(qr,`background-color: ${e(a),r(()=>e(a).inputBg)??""}; border-color: ${e(a),r(()=>e(a).border)??""}; color: ${e(a),r(()=>e(a).text)??""};`),c(Jr,`background-color: ${e(a),r(()=>e(a).inputBg)??""}; border-color: ${e(a),r(()=>e(a).border)??""}; color: ${e(a),r(()=>e(a).text)??""};`),c(Yr,`background-color: ${e(a),r(()=>e(a).inputBg)??""}; border-color: ${e(a),r(()=>e(a).border)??""}; color: ${e(a),r(()=>e(a).text)??""};`),x(Lr,m()),c(fo,`background-color: ${e(a),r(()=>e(a).cardBg)??""}; border-color: ${e(a),r(()=>e(a).cardBorder)??""};`),c(ko,`color: ${e(a),r(()=>e(a).label)??""};`),zr.disabled=e(pe),ur(zr,1,`w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-indigo-500 transition-all outline-none appearance-none cursor-pointer disabled:opacity-50 ${n??""}`,"svelte-gsxx31"),c(zr,`background-color: ${e(a),r(()=>e(a).inputBg)??""}; border-color: ${l??""}; color: ${e(a),r(()=>e(a).text)??""};`),x(et,e(pe)?"Cargando...":"Seleccione docente"),ur(Qr,1,`space-y-2 ${e(t)?"lg:col-span-2":""}`,"svelte-gsxx31"),c(rt,`color: ${e(a),r(()=>e(a).label)??""};`),c($o,`color: ${e(a),r(()=>e(a).label)??""};`),ur(Vr,1,`w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-indigo-500 transition-all outline-none appearance-none cursor-pointer ${p??""}`,"svelte-gsxx31"),c(Vr,`background-color: ${e(a),r(()=>e(a).inputBg)??""}; border-color: ${C??""}; color: ${e(a),r(()=>e(a).text)??""};`),c(Z,`color: ${e(a),r(()=>e(a).label)??""};`),ce.disabled=e(he),ur(ce,1,`w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-indigo-500 transition-all outline-none appearance-none cursor-pointer disabled:opacity-50 ${U??""}`,"svelte-gsxx31"),c(ce,`background-color: ${e(a),r(()=>e(a).inputBg)??""}; border-color: ${W??""}; color: ${e(a),r(()=>e(a).text)??""};`),x(Ze,e(he)?"Cargando...":"Seleccione grado"),c(no,`color: ${e(a),r(()=>e(a).label)??""};`),c(io,`background-color: ${e(a),r(()=>e(a).inputBg)??""}; border-color: ${e(a),r(()=>e(a).border)??""}; color: ${e(a),r(()=>e(a).text)??""};`),c(co,`color: ${e(a),r(()=>e(a).label)??""};`),c(So,`background-color: ${e(a),r(()=>e(a).inputBg)??""}; border-color: ${e(a),r(()=>e(a).border)??""}; color: ${e(a),r(()=>e(a).text)??""};`),c(Do,`border-color: ${e(a),r(()=>e(a).border)??""};`),c(vo,`color: ${e(a),r(()=>e(a).label)??""};`),x(at,(e(P),r(()=>e(P).length))),Ar.disabled=e(Ke)},[()=>(e(V),e(v),r(()=>e(V)&&e(v).includes("docente")?"ring-2 ring-red-500 border-red-500":"")),()=>(e(V),e(v),e(a),r(()=>e(V)&&e(v).includes("docente")?"#ef4444":e(a).border)),()=>(e(V),e(v),r(()=>e(V)&&e(v).includes("horas")?"ring-2 ring-red-500 border-red-500":"")),()=>(e(V),e(v),e(a),r(()=>e(V)&&e(v).includes("horas")?"#ef4444":e(a).border)),()=>(e(V),e(v),r(()=>e(V)&&e(v).includes("grado")?"ring-2 ring-red-500 border-red-500":"")),()=>(e(V),e(v),e(a),r(()=>e(V)&&e(v).includes("grado")?"#ef4444":e(a).border))]),L("click",Se,w),L("click",kr,Ne),L("click",Fr,Te),L("click",Br,lr),L("click",qr,A),L("click",Jr,function(...n){T()?.apply(this,n)}),L("click",Yr,me),Je(zr,()=>e(u).docente,n=>(Ee(u,e(u).docente=n),qe(()=>{e(pe),e(V),e(v),e(a),e(G),e(Me),e(_e),e(d),e(he),e(Ve)}))),Je(Vr,()=>e(u).horas,n=>(Ee(u,e(u).horas=n),qe(()=>{e(pe),e(V),e(v),e(a),e(G),e(Me),e(_e),e(d),e(he),e(Ve)}))),Je(ce,()=>e(u).grado,n=>(Ee(u,e(u).grado=n),qe(()=>{e(pe),e(V),e(v),e(a),e(G),e(Me),e(_e),e(d),e(he),e(Ve)}))),Ro(io,()=>e(u).fecha,n=>(Ee(u,e(u).fecha=n),qe(()=>{e(pe),e(V),e(v),e(a),e(G),e(Me),e(_e),e(d),e(he),e(Ve)}))),Ro(So,()=>e(u).observaciones,n=>(Ee(u,e(u).observaciones=n),qe(()=>{e(pe),e(V),e(v),e(a),e(G),e(Me),e(_e),e(d),e(he),e(Ve)}))),L("submit",Er,M),L("click",Ar,M),b(Ir,B),Go(),$e()}export{cs as default};
