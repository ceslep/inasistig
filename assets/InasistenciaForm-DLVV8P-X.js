const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/utils-BOnwv8s1.js","assets/excel-pvs9swoc.js"])))=>i.map(i=>d[i]);
import{p as No,a as Hr,n as k,o as Po,l as qe,j as p,u as e,b as Lo,i as Oo,s as a,d as ee,t as B,h as N,e as x,g as Go,N as Me,O as We,m as o,f as mr,v as r,A as ve,F as be,P as Et,Q as Ye,R as Ro,k as w,x as i,y as f,q as Be,S as vr,D as hr,r as dr,T as bt,U as vt,c as mt,H as _r,C as Mt,z as zt,V as At,W as Tt,X as Ht,Y as jt}from"./svelte-DdsiqXYP.js";import{S as Ge}from"./ui-CHfsb5jC.js";import{g as gt,W as Vo,S as go,a as Uo,b as Wo,c as qo,p as Vr,L as _t,I as dt,U as Rt,s as Nt}from"./Loader-DE2CalLS.js";import{e as kt,F as xt,t as ft}from"./index-CofI4gHW.js";import{_ as ht}from"./pdf-Da-GEdgZ.js";var Pt=w('<div class="flex-1 flex items-center justify-center"><div class="text-center"><div class="animate-spin w-8 h-8 border-4 border-indigo-500 border-t-transparent rounded-full mx-auto mb-4"></div> <p>Cargando datos...</p></div></div>'),Lt=w('<span class="ml-2 px-2 py-1 text-xs bg-indigo-100 dark:bg-indigo-900 text-indigo-800 dark:text-indigo-200 rounded-full">Activos</span>'),Ot=w("<option> </option>"),Gt=w("<option> </option>"),Vt=w('<p class="text-[10px] sm:text-xs text-amber-600 dark:text-amber-400 mt-1">Este docente no tiene registros de materias</p>'),Ut=w("<option> </option>"),Wt=w('<p class="text-[10px] sm:text-xs text-amber-600 dark:text-amber-400 mt-1">No hay grados para los filtros seleccionados</p>'),qt=w("<option> </option>"),Yt=w('<p class="text-[10px] sm:text-xs text-amber-600 dark:text-amber-400 mt-1">No hay motivos para los filtros seleccionados</p>'),Jt=w('<div class="flex-1 flex items-center justify-center"><div class="text-center py-12 px-4"><svg class="w-16 h-16 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <p class="text-sm sm:text-base">No se encontraron registros con los filtros seleccionados</p></div></div>'),Kt=w('<button class="text-indigo-600 dark:text-indigo-400 hover:underline font-medium text-left truncate w-full"> </button>'),Xt=w('<tr class="border-b transition-colors hover:bg-black/5 dark:hover:bg-white/5 text-xs"><td class="p-2"> </td><td class="p-2 truncate max-w-[150px]"> </td><td class="p-2 truncate max-w-[150px]"> </td><td class="p-2 text-center"> </td><td class="p-2 truncate max-w-[150px]"><!></td><td class="p-2 text-center"><span><span> </span> </span></td><td class="p-2 text-center"> </td><td class="p-2"><span class="truncate block max-w-xs text-xs"> </span></td></tr>'),Zt=w('<button class="text-indigo-600 dark:text-indigo-400 hover:underline font-medium text-left truncate w-full"> </button>'),Qt=w('<tr class="border-b transition-colors hover:bg-black/5 dark:hover:bg-white/5 text-xs"><td class="p-2 whitespace-nowrap"> </td><td class="p-2"><span class="truncate block max-w-[120px]"> </span></td><td class="p-2 truncate max-w-[120px]"> </td><td class="p-2"><span class="truncate block max-w-[100px]"><!></span></td><td class="p-2 text-center"><span><span> </span> </span></td><td class="p-2 whitespace-nowrap text-center"> </td><td class="p-2 whitespace-nowrap text-center"> </td></tr>'),ea=w('<button class="font-semibold text-xs text-indigo-600 dark:text-indigo-400 truncate hover:underline text-left w-full"> </button>'),ra=w('<p class="font-semibold text-xs text-indigo-600 dark:text-indigo-400 truncate"> </p>'),oa=w('<div class="text-[10px] p-1.5 rounded"><div class="flex items-start"><svg class="w-3 h-3 mr-1 mt-0.5 flex-shrink-0 opacity-60" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <span class="line-clamp-1"> </span></div></div>'),ta=w('<div class="border rounded-lg p-2 transition-colors hover:bg-black/5 dark:hover:bg-white/5"><div class="flex justify-between items-center mb-1.5"><div class="flex-1 min-w-0"><!> <p class="text-[10px] opacity-75"> </p></div> <div class="flex flex-col items-end ml-2 flex-shrink-0"><span><span> </span> </span> <span class="text-[10px] font-semibold"> </span></div></div> <div class="flex gap-3 text-[10px] mb-1.5"><div class="flex items-center flex-1 min-w-0"><svg class="w-3 h-3 mr-1 opacity-60 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg> <span class="truncate"> </span></div> <div class="flex items-center flex-1 min-w-0"><svg class="w-3 h-3 mr-1 opacity-60 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg> <span class="truncate"> </span></div></div> <!></div>'),aa=w('<div class="hidden lg:flex flex-1 flex-col overflow-hidden min-h-0"><div class="flex-1 overflow-auto min-w-full border rounded-lg"><table class="w-full border-collapse text-sm min-w-[800px]"><thead class="sticky top-0 z-10 border-b"><tr><th class="text-left p-2 font-semibold whitespace-nowrap">Fecha</th><th class="text-left p-2 font-semibold whitespace-nowrap">Docente</th><th class="text-left p-2 font-semibold whitespace-nowrap">Materia</th><th class="text-center p-2 font-semibold whitespace-nowrap">Grado</th><th class="text-left p-2 font-semibold whitespace-nowrap">Estudiante</th><th class="text-center p-2 font-semibold whitespace-nowrap">Motivo</th><th class="text-center p-2 font-semibold whitespace-nowrap">Horas</th><th class="text-left p-2 font-semibold whitespace-nowrap">Observaciones</th></tr></thead><tbody></tbody></table></div></div> <div class="hidden md:flex lg:hidden flex-1 overflow-auto"><div class="min-w-full border rounded-lg"><table class="w-full border-collapse text-xs"><thead class="sticky top-0 z-10 border-b"><tr><th class="text-left p-2 font-semibold whitespace-nowrap">Fecha</th><th class="text-left p-2 font-semibold whitespace-nowrap">Docente</th><th class="text-left p-2 font-semibold whitespace-nowrap">Materia</th><th class="text-left p-2 font-semibold whitespace-nowrap">Estudiante</th><th class="text-center p-2 font-semibold whitespace-nowrap">Motivo</th><th class="text-center p-2 font-semibold whitespace-nowrap">Horas</th><th class="text-center p-2 font-semibold whitespace-nowrap">Grado</th></tr></thead><tbody></tbody></table></div></div> <div class="flex-1 overflow-y-auto md:hidden px-1"><div class="space-y-2"></div></div>',1),sa=w('<div class="p-3 sm:p-4 border-b"><div class="flex items-center justify-between mb-2 sm:mb-3"><h3 class="text-lg font-semibold">Filtros <!></h3> <button class="text-sm px-3 py-1 rounded-lg border transition-colors hover:bg-black/5 dark:hover:bg-white/5">Limpiar filtros</button></div> <div class="mb-3 p-1.5 sm:p-2 bg-indigo-50 dark:bg-indigo-900/20 rounded-lg"><p class="text-[10px] sm:text-xs font-medium mb-1.5">R√°pido: Fechas</p> <div class="flex items-center mb-2"><input id="checkFiltrarFecha" type="checkbox" class="w-4 h-4 rounded text-indigo-600 focus:ring-indigo-500 border-gray-300 dark:border-gray-600 dark:bg-zinc-700"/> <label for="checkFiltrarFecha" class="ml-2 text-xs font-medium">Activar filtro por fechas</label></div> <div class="flex flex-wrap gap-1 sm:gap-2"><button class="text-[10px] sm:text-xs px-1.5 sm:px-2 py-1 bg-white dark:bg-zinc-800 border rounded hover:bg-indigo-100 dark:hover:bg-indigo-800/50 transition-colors">Hoy</button> <button class="text-[10px] sm:text-xs px-1.5 sm:px-2 py-1 bg-white dark:bg-zinc-800 border rounded hover:bg-indigo-100 dark:hover:bg-indigo-800/50 transition-colors">√öltimos 7 d√≠as</button> <button class="text-[10px] sm:text-xs px-1.5 sm:px-2 py-1 bg-white dark:bg-zinc-800 border rounded hover:bg-indigo-100 dark:hover:bg-indigo-800/50 transition-colors">√öltimos 30 d√≠as</button> <button class="text-[10px] sm:text-xs px-1.5 sm:px-2 py-1 bg-white dark:bg-zinc-800 border rounded hover:bg-indigo-100 dark:hover:bg-indigo-800/50 transition-colors">Mes actual</button> <button class="text-[10px] sm:text-xs px-1.5 sm:px-2 py-1 bg-white dark:bg-zinc-800 border rounded hover:bg-indigo-100 dark:hover:bg-indigo-800/50 transition-colors">√öltimo trimestre</button></div></div> <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4"><div class="flex gap-3 sm:gap-4"><div class="flex-1 space-y-1.5 sm:space-y-2"><label for="filtroDocente" class="block text-xs sm:text-sm font-medium">Docente</label> <select id="filtroDocente" class="w-full px-2 sm:px-3 py-1.5 sm:py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none text-xs sm:text-sm"><option>Todos los docentes</option><!></select></div> <div class="flex-1 space-y-1.5 sm:space-y-2"><label for="filtroMateria" class="block text-xs sm:text-sm font-medium"> </label> <select id="filtroMateria" class="w-full px-2 sm:px-3 py-1.5 sm:py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none text-xs sm:text-sm"><option> </option><!></select> <!></div></div> <div class="flex gap-3 sm:gap-4"><div class="flex-1 space-y-1.5 sm:space-y-2"><label for="filtroGrado" class="block text-xs sm:text-sm font-medium"> </label> <select id="filtroGrado" class="w-full px-2 sm:px-3 py-1.5 sm:py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none text-xs sm:text-sm"><option> </option><!></select> <!></div> <div class="flex-1 space-y-1.5 sm:space-y-2"><label for="filtroMotivo" class="block text-xs sm:text-sm font-medium">Motivo</label> <select id="filtroMotivo" class="w-full px-2 sm:px-3 py-1.5 sm:py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none text-xs sm:text-sm"><option> </option><!></select> <!></div></div> <div class="flex gap-3 sm:gap-4"><div class="flex-1 space-y-1.5 sm:space-y-2"><label for="filtroFechaInicio" class="block text-xs sm:text-sm font-medium">Fecha desde</label> <input id="filtroFechaInicio" type="date" class="w-full px-2 sm:px-3 py-1.5 sm:py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none text-xs sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"/></div> <div class="flex-1 space-y-1.5 sm:space-y-2"><label for="filtroFechaFin" class="block text-xs sm:text-sm font-medium">Fecha hasta</label> <input id="filtroFechaFin" type="date" class="w-full px-2 sm:px-3 py-1.5 sm:py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none text-xs sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"/></div></div></div></div> <div class="flex-1 flex flex-col p-2 sm:p-4 min-h-0"><div class="mb-4 px-0 sm:px-3"><p class="text-sm">Se encontraron <span class="font-bold text-indigo-500"> </span> registros</p></div> <!></div>',1),la=w('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4" role="button" tabindex="0" aria-label="Cerrar ventana"><div class="w-full max-w-7xl max-h-[95vh] bg-white dark:bg-zinc-900 rounded-2xl shadow-2xl overflow-hidden flex flex-col"><div class="flex items-center justify-between p-3 sm:p-4 border-b"><div class="flex items-center gap-3"><img alt="EIE Logo" class="h-8 w-auto hidden sm:block"/> <div><h2 class="text-lg sm:text-xl font-bold">Inasistencias</h2> <p class="text-xs hidden sm:block">Filtra y consulta los registros</p></div></div> <div class="flex items-center gap-3"><button class="inline-flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> Exportar CSV</button> <button class="p-2 rounded-lg transition-colors hover:bg-black/5 dark:hover:bg-white/5" aria-label="Cerrar"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div></div> <div class="flex-1 overflow-hidden flex flex-col min-h-0"><!></div></div></div>');function na(Fr,lr){No(lr,!1);const v=k(),er=k(),ye=k(),F=k(),t=k();let Se=Hr(lr,"onClose",8),s=Hr(lr,"selectedDocente",8,""),P=k([]),we=[],$e=[],Ve=[],nr=k(!1),L=k(!1),W=k([]),c=k({docente:s()||"",materia:"",grado:"",fechaInicio:"",fechaFin:"",motivo:""});const rr=()=>{const d=new Date,_=new Date(d.getFullYear(),d.getMonth()-1,d.getDate()),y=S=>{const I=S.getFullYear(),M=String(S.getMonth()+1).padStart(2,"0"),te=String(S.getDate()).padStart(2,"0");return`${I}-${M}-${te}`};Me(c,e(c).fechaInicio=y(_)),We(()=>{e(t),e(g),e(v),e(ye),e(F)}),Me(c,e(c).fechaFin=y(d)),We(()=>{e(t),e(g),e(v),e(ye),e(F)})},ge=d=>{const _=new Date;let y;switch(d){case"hoy":y=new Date(_);break;case"semana":y=new Date(_),y.setDate(_.getDate()-7);break;case"mes":y=new Date(_),y.setDate(_.getDate()-30);break;case"mes_actual":y=new Date(_.getFullYear(),_.getMonth(),1);break;case"trimestre":y=new Date(_),y.setDate(_.getDate()-90);break;default:rr();return}const S=I=>{const M=I.getFullYear(),te=String(I.getMonth()+1).padStart(2,"0"),Fe=String(I.getDate()).padStart(2,"0");return`${M}-${te}-${Fe}`};Me(c,e(c).fechaInicio=S(y)),We(()=>{e(t),e(g),e(v),e(ye),e(F)}),Me(c,e(c).fechaFin=S(_)),We(()=>{e(t),e(g),e(v),e(ye),e(F)}),p(L,!0),console.log("‚úÖ setFechaPreset ejecutado:",{preset:d,fechaInicio:e(c).fechaInicio,fechaFin:e(c).fechaFin,filtrarPorFecha:e(L)})},Re=[{value:"Sin excusa",icon:"üö´",color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"},{value:"Excusa",icon:"üìÑ",color:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"},{value:"LLegada Tarde",icon:"‚è∞",color:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200"},{value:"Transporte Escolar",icon:"üöå",color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"},{value:"Permiso",icon:"‚úÖ",color:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"},{value:"No portar/sin uniforme",icon:"üëö",color:"bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-200"},{value:"Pacto de Aula",icon:"ü§ù",color:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200"},{value:"Uso del celular",icon:"üì±",color:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200"},{value:"Desorden en Clase",icon:"üîä",color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"},{value:"Fuga",icon:"üèÉ‚Äç‚ôÇÔ∏è",color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"},{value:"No realizaci√≥n de Aseo",icon:"üßπ",color:"bg-teal-100 text-teal-800 dark:bg-teal-900 dark:text-teal-200"},{value:"Licencia por salud",icon:"üè•",color:"bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-200"},{value:"Incapacidad",icon:"ü©∫",color:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200"},{value:"Reuni√≥n interna",icon:"üë•",color:"bg-zinc-100 text-zinc-800 dark:bg-zinc-900 dark:text-zinc-200"},{value:"Psicoorientaci√≥n",icon:"üß†",color:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"}],Ce=d=>Re.find(_=>_.value===d)||{icon:"‚ùì",color:"bg-gray-100 text-gray-800"};let g=k([]),q=k([]),Je=k([]),Ne=k([]);const or=d=>{if(!d)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(d))return d;const _=d.split("/");if(_.length===3){const S=_[0].padStart(2,"0"),I=_[1].padStart(2,"0");return`${_[2].length===2?`20${_[2]}`:_[2]}-${I}-${S}`}const y=new Date(d);if(!isNaN(y.getTime())){const S=y.getFullYear(),I=String(y.getMonth()+1).padStart(2,"0"),M=String(y.getDate()).padStart(2,"0");return`${S}-${I}-${M}`}return d},R=async()=>{p(nr,!0);try{const[d,_,y,S]=await Promise.all([gt({spreadsheetId:go,worksheetTitle:Vo}),Uo(),Wo(),qo()]);console.log("Respuesta cruda de inasistencias:",d),console.log("Tipo de dato:",typeof d),console.log("Es array:",Array.isArray(d)),d&&typeof d=="object"&&console.log("Keys:",Object.keys(d));const I=h=>{if(!h?.records||!Array.isArray(h.records))return[];const j=h.records[0]?.values||[];return h.records.slice(1).map(Z=>{const xe=Z.values||[];return{timestamp:xe[0]||"",docente:xe[1]||"",fecha:xe[2]||"",horas:xe[3]||"",materia:xe[4]||"",motivo:xe[5]||"",grado:xe[6]||"",nombre:xe[7]||"",observaciones:xe[8]||""}}).filter(Z=>Z.docente&&Z.fecha)},M=h=>Array.isArray(h)?h:h?.data&&Array.isArray(h.data)?h.data:h?.rows&&Array.isArray(h.rows)?h.rows:h?.values&&Array.isArray(h.values)?h.values:h?.inasistencias&&Array.isArray(h.inasistencias)?h.inasistencias:[];p(P,I(d)),we=M(_),$e=M(y),Ve=M(S),p(g,e(P).length>0?[...new Set(e(P).map(h=>h.docente).filter(Boolean))].sort():[]),p(q,e(P).length>0?[...new Set(e(P).map(h=>h.materia).filter(Boolean))].sort():[]);const te=[...new Set(Ve.map(h=>(typeof h=="string"?h:h.grado||"").toString()).filter(Boolean))],Fe=e(P).length>0?e(P).map(h=>h.grado).filter(Boolean):[];p(Je,[...new Set([...te,...Fe])].sort((h,j)=>{const le=parseInt(h),Z=parseInt(j);return!isNaN(le)&&!isNaN(Z)?le-Z:h.localeCompare(j)})),p(Ne,e(P).length>0?[...new Set(e(P).map(h=>h.motivo).filter(Boolean))].sort():[]),rr(),console.log("Datos cargados:",{inasistencias:e(P).length,docentes:we.length,docentesUnicos:e(g).length,materiasUnicas:e(q).length,gradosUnicos:e(Je).length,motivosUnicos:e(Ne).length})}catch(d){console.error("Error cargando datos:",d),await Ge.fire({icon:"error",title:"Error",text:"No se pudieron cargar los datos de inasistencias",confirmButtonColor:"#ef4444"})}finally{p(nr,!1)}},pe=()=>{p(c,{docente:s()||"",materia:"",grado:"",fechaInicio:"",fechaFin:"",motivo:""}),rr(),p(L,!1)},D=()=>{if(e(W).length===0){Ge.fire({icon:"warning",title:"Sin datos",text:"No hay datos para exportar",confirmButtonColor:"#f59e0b"});return}const _=[["Fecha","Docente","Materia","Grado","Estudiante","Motivo","Horas","Observaciones"].join(","),...e(W).map(M=>[M.fecha,`"${M.docente}"`,`"${M.materia}"`,M.grado,`"${M.nombre}"`,`"${M.motivo}"`,M.horas,`"${M.observaciones}"`].join(","))].join(`
`),y=new Blob([_],{type:"text/csv;charset=utf-8;"}),S=document.createElement("a"),I=URL.createObjectURL(y);S.setAttribute("href",I),S.setAttribute("download",`inasistencias_${new Date().toISOString().split("T")[0]}.csv`),S.style.visibility="hidden",document.body.appendChild(S),S.click(),document.body.removeChild(S)},O=d=>{try{const[_,y,S]=d.split("-");return _&&y&&S?`${S}/${y}/${_}`:d}catch{return d}},ue=d=>{if(!e(c).docente||!e(c).materia||!e(c).grado)return;const y=e(P).filter(I=>{if(I.nombre!==d||I.docente!==e(c).docente||I.materia!==e(c).materia||I.grado!==e(c).grado)return!1;if(e(L)){const M=or(I.fecha);if(e(c).fechaInicio&&M<e(c).fechaInicio||e(c).fechaFin&&M>e(c).fechaFin)return!1}return!0}).reduce((I,M)=>{const te=parseInt(M.horas)||0;return I+te},0);let S="";e(L)&&e(c).fechaInicio&&e(c).fechaFin?S=`entre ${O(e(c).fechaInicio)} y ${O(e(c).fechaFin)}`:S="en total (hist√≥rico)",Ge.fire({icon:"info",title:d,html:`
        <div class="text-left space-y-2">
          <p><strong>Materia:</strong> ${e(c).materia}</p>
          <p><strong>Total inasistencias:</strong> ${y} horas</p>
          <p class="text-sm text-gray-500 text-center mt-4">(${S})</p>
        </div>
      `,confirmButtonColor:"#4f46e5"})};Po(()=>{R()}),qe(()=>(e(c),e(P),e(q)),()=>{p(v,e(c).docente?[...new Set(e(P).filter(d=>d.docente===e(c).docente).map(d=>d.materia).filter(Boolean))].sort():e(q))}),qe(()=>(e(c),e(P),e(Je)),()=>{p(er,e(c).docente?[...new Set(e(P).filter(d=>d.docente===e(c).docente).map(d=>d.grado).filter(Boolean))].sort((d,_)=>{const y=parseInt(d),S=parseInt(_);return!isNaN(y)&&!isNaN(S)?y-S:d.localeCompare(_)}):e(Je))}),qe(()=>(e(c),e(P),e(er)),()=>{p(ye,e(c).materia?[...new Set(e(P).filter(d=>d.materia===e(c).materia).map(d=>d.grado).filter(Boolean))].sort((d,_)=>{const y=parseInt(d),S=parseInt(_);return!isNaN(y)&&!isNaN(S)?y-S:d.localeCompare(_)}):e(er))}),qe(()=>(e(c),e(P),e(Ne)),()=>{p(F,e(c).docente||e(c).materia||e(c).grado?[...new Set(e(P).filter(d=>!(e(c).docente&&d.docente!==e(c).docente||e(c).materia&&d.materia!==e(c).materia||e(c).grado&&d.grado!==e(c).grado)).map(d=>d.motivo).filter(Boolean))].sort():e(Ne))}),qe(()=>{},()=>{p(t,{bg:"rgb(var(--bg-primary))",text:"rgb(var(--text-primary))",label:"rgb(var(--text-secondary))",border:"rgb(var(--border-primary))",placeholder:"rgb(var(--text-muted))",icon:"rgb(var(--text-muted))",cardBg:"rgb(var(--card-bg))",cardBorder:"rgb(var(--card-border))",inputBg:"rgb(var(--bg-secondary))"})}),qe(()=>(e(P),e(L),e(c),e(W)),()=>{console.log("üîÑ Filtro reactivo ejecut√°ndose:",{totalInasistencias:e(P).length,filtrarPorFecha:e(L),fechaInicio:e(c).fechaInicio,fechaFin:e(c).fechaFin}),p(W,e(P).filter(d=>{if(e(c).docente&&d.docente!==e(c).docente||e(c).materia&&d.materia!==e(c).materia||e(c).grado&&d.grado!==e(c).grado||e(c).motivo&&d.motivo!==e(c).motivo)return!1;if(e(L)){const _=or(d.fecha);if(e(c).fechaInicio&&_<e(c).fechaInicio||e(c).fechaFin&&_>e(c).fechaFin)return!1}return!0})),console.log(`üìä Resultados filtrados: ${e(W).length} de ${e(P).length}`)}),qe(()=>(e(L),e(c)),()=>{e(L)&&(!e(c).fechaInicio||!e(c).fechaFin)&&rr()}),Lo(),Oo();var Pe=la(),tr=o(Pe),Ae=o(tr),$=o(Ae),T=o($),X=a(T,2),fe=o(X),he=a(fe,2),G=a($,2),Y=o(G),me=a(Y,2),Te=a(Ae,2),_e=o(Te);{var De=d=>{var _=Pt(),y=o(_),S=a(o(y),2);B(()=>i(S,`color: ${e(t),r(()=>e(t).text)??""};`)),x(d,_)},se=d=>{var _=sa(),y=mr(_),S=o(y),I=o(S),M=a(o(I));{var te=E=>{var J=Lt();x(E,J)};ee(M,E=>{e(c),r(()=>e(c).docente||e(c).materia||e(c).grado||e(c).motivo||e(c).fechaInicio||e(c).fechaFin)&&E(te)})}var Fe=a(I,2),h=a(S,2),j=o(h),le=a(j,2),Z=o(le),xe=a(Z,2),He=a(le,2),H=o(He),b=a(H,2),m=a(b,2),z=a(m,2),ae=a(z,2),ze=a(h,2),Br=o(ze),po=o(Br),uo=o(po),Sr=a(uo,2),kr=o(Sr);kr.value=kr.__value="";var Yo=a(kr);ve(Yo,1,()=>e(g),be,(E,J)=>{var ce=Ot(),Ie=o(ce),Ke={};B(()=>{f(Ie,e(J)),Ke!==(Ke=e(J))&&(ce.value=(ce.__value=e(J))??"")}),x(E,ce)});var Jo=a(po,2),wr=o(Jo),Ko=o(wr),jr=a(wr,2),yr=o(jr),Ur=o(yr);yr.value=yr.__value="";var Wr=a(yr);ve(Wr,1,()=>e(v),be,(E,J)=>{var ce=Gt(),Ie=o(ce),Ke={};B(()=>{f(Ie,e(J)),Ke!==(Ke=e(J))&&(ce.value=(ce.__value=e(J))??"")}),x(E,ce)});var Xo=a(jr,2);{var qr=E=>{var J=Vt();x(E,J)};ee(Xo,E=>{e(c),e(v),r(()=>e(c).docente&&e(v).length===0)&&E(qr)})}var Yr=a(Br,2),bo=o(Yr),Jr=o(bo),Zo=o(Jr),Rr=a(Jr,2),Nr=o(Rr),xo=o(Nr);Nr.value=Nr.__value="";var fo=a(Nr);ve(fo,1,()=>e(ye),be,(E,J)=>{var ce=Ut(),Ie=o(ce),Ke={};B(()=>{f(Ie,e(J)),Ke!==(Ke=e(J))&&(ce.value=(ce.__value=e(J))??"")}),x(E,ce)});var ho=a(Rr,2);{var Qo=E=>{var J=Wt();x(E,J)};ee(ho,E=>{e(c),e(ye),r(()=>(e(c).docente||e(c).materia)&&e(ye).length===0)&&E(Qo)})}var mo=a(bo,2),Kr=o(mo),Dr=a(Kr,2),Ir=o(Dr),_o=o(Ir);Ir.value=Ir.__value="";var ko=a(Ir);ve(ko,1,()=>e(F),be,(E,J)=>{const ce=vr(()=>(e(J),r(()=>Ce(e(J)))));var Ie=qt(),Ke=o(Ie),$r={};B(()=>{f(Ke,`${Be(e(ce)),r(()=>e(ce).icon)??""}
                      ${e(J)??""}`),$r!==($r=e(J))&&(Ie.value=(Ie.__value=e(J))??"")}),x(E,Ie)});var Er=a(Dr,2);{var Pr=E=>{var J=Yt();x(E,J)};ee(Er,E=>{e(c),e(F),r(()=>(e(c).docente||e(c).materia||e(c).grado)&&e(F).length===0)&&E(Pr)})}var et=a(Yr,2),wo=o(et),Xr=o(wo),Lr=a(Xr,2),rt=a(wo,2),yo=o(rt),Zr=a(yo,2),ot=a(y,2),Qr=o(ot),eo=o(Qr),$o=a(o(eo)),Or=o($o),ro=a(Qr,2);{var oo=E=>{var J=Jt(),ce=o(J),Ie=o(ce),Ke=a(Ie,2);B(()=>{i(Ie,`color: ${e(t),r(()=>e(t).icon)??""};`),i(Ke,`color: ${e(t),r(()=>e(t).text)??""};`)}),x(E,J)},tt=E=>{var J=aa(),ce=mr(J),Ie=o(ce),Ke=o(Ie),$r=o(Ke),Co=o($r),Fo=o(Co),to=a(Fo),ao=a(to),so=a(ao),lo=a(so),Bo=a(lo),no=a(Bo),So=a(no),Do=a($r);ve(Do,5,()=>e(W),be,(n,l)=>{const u=vr(()=>(e(l),r(()=>Ce(e(l).motivo))));var C=Xt(),V=o(C),U=o(V),A=a(V),K=o(A),re=a(A),Q=o(re),ne=a(re),Ue=o(ne),Xe=a(ne),xr=o(Xe);{var Le=je=>{var ke=Kt(),cr=o(ke);B(()=>f(cr,(e(l),r(()=>e(l).nombre)))),N("click",ke,()=>ue(e(l).nombre)),x(je,ke)},Ze=je=>{var ke=bt();B(()=>f(ke,(e(l),r(()=>e(l).nombre)))),x(je,ke)};ee(xr,je=>{e(c),r(()=>e(c).docente&&e(c).materia&&e(c).grado)?je(Le):je(Ze,!1)})}var ar=a(Xe),sr=o(ar),gr=o(sr),ir=o(gr),pr=a(gr),Oe=a(ar),fr=o(Oe),Ee=a(Oe),ur=o(Ee),Qe=o(ur);B(je=>{i(C,`border-color: ${e(t),r(()=>e(t).border)??""};`),i(V,`color: ${e(t),r(()=>e(t).text)??""};`),f(U,je),i(A,`color: ${e(t),r(()=>e(t).text)??""};`),hr(A,"title",(e(l),r(()=>e(l).docente))),f(K,(e(l),r(()=>e(l).docente))),i(re,`color: ${e(t),r(()=>e(t).text)??""};`),hr(re,"title",(e(l),r(()=>e(l).materia))),f(Q,(e(l),r(()=>e(l).materia))),i(ne,`color: ${e(t),r(()=>e(t).text)??""};`),f(Ue,(e(l),r(()=>e(l).grado))),i(Xe,`color: ${e(t),r(()=>e(t).text)??""};`),hr(Xe,"title",(e(l),r(()=>e(l).nombre))),dr(sr,1,`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium ${Be(e(u)),r(()=>e(u).color)??""}`),f(ir,(Be(e(u)),r(()=>e(u).icon))),f(pr,` ${e(l),r(()=>e(l).motivo)??""}`),i(Oe,`color: ${e(t),r(()=>e(t).text)??""};`),f(fr,(e(l),r(()=>e(l).horas))),i(Ee,`color: ${e(t),r(()=>e(t).text)??""};`),f(Qe,(e(l),r(()=>e(l).observaciones||"-")))},[()=>(e(l),r(()=>O(e(l).fecha)))]),x(n,C)});var io=a(ce,2),Io=o(io),at=o(Io),Mr=o(at),Eo=o(Mr),Mo=o(Eo),zo=a(Mo),Ao=a(zo),To=a(Ao),co=a(To),Ho=a(co),jo=a(Ho),st=a(Mr);ve(st,5,()=>e(W),be,(n,l)=>{const u=vr(()=>(e(l),r(()=>Ce(e(l).motivo))));var C=Qt(),V=o(C),U=o(V),A=a(V),K=o(A),re=o(K),Q=a(A),ne=o(Q),Ue=a(Q),Xe=o(Ue),xr=o(Xe);{var Le=Qe=>{var je=Zt(),ke=o(je);B(()=>f(ke,(e(l),r(()=>e(l).nombre)))),N("click",je,()=>ue(e(l).nombre)),x(Qe,je)},Ze=Qe=>{var je=bt();B(()=>f(je,(e(l),r(()=>e(l).nombre)))),x(Qe,je)};ee(xr,Qe=>{e(c),r(()=>e(c).docente&&e(c).materia&&e(c).grado)?Qe(Le):Qe(Ze,!1)})}var ar=a(Ue),sr=o(ar),gr=o(sr),ir=o(gr),pr=a(gr),Oe=a(ar),fr=o(Oe),Ee=a(Oe),ur=o(Ee);B(Qe=>{i(C,`border-color: ${e(t),r(()=>e(t).border)??""};`),i(V,`color: ${e(t),r(()=>e(t).text)??""};`),f(U,Qe),i(A,`color: ${e(t),r(()=>e(t).text)??""};`),hr(K,"title",(e(l),r(()=>e(l).docente))),f(re,(e(l),r(()=>e(l).docente))),i(Q,`color: ${e(t),r(()=>e(t).text)??""};`),hr(Q,"title",(e(l),r(()=>e(l).materia))),f(ne,(e(l),r(()=>e(l).materia))),i(Ue,`color: ${e(t),r(()=>e(t).text)??""};`),hr(Xe,"title",(e(l),r(()=>e(l).nombre))),dr(sr,1,`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium ${Be(e(u)),r(()=>e(u).color)??""}`),f(ir,(Be(e(u)),r(()=>e(u).icon))),f(pr,` ${e(l),r(()=>e(l).motivo)??""}`),i(Oe,`color: ${e(t),r(()=>e(t).text)??""};`),f(fr,(e(l),r(()=>e(l).horas))),i(Ee,`color: ${e(t),r(()=>e(t).text)??""};`),f(ur,(e(l),r(()=>e(l).grado)))},[()=>(e(l),r(()=>O(e(l).fecha)))]),x(n,C)});var lt=a(io,2),nt=o(lt);ve(nt,5,()=>e(W),be,(n,l)=>{const u=vr(()=>(e(l),r(()=>Ce(e(l).motivo))));var C=ta(),V=o(C),U=o(V),A=o(U);{var K=ke=>{var cr=ea(),zr=o(cr);B(()=>f(zr,(e(l),r(()=>e(l).nombre)))),N("click",cr,()=>ue(e(l).nombre)),x(ke,cr)},re=ke=>{var cr=ra(),zr=o(cr);B(()=>f(zr,(e(l),r(()=>e(l).nombre)))),x(ke,cr)};ee(A,ke=>{e(c),r(()=>e(c).docente&&e(c).materia&&e(c).grado)?ke(K):ke(re,!1)})}var Q=a(A,2),ne=o(Q),Ue=a(U,2),Xe=o(Ue),xr=o(Xe),Le=o(xr),Ze=a(xr),ar=a(Xe,2),sr=o(ar),gr=a(V,2),ir=o(gr),pr=a(o(ir),2),Oe=o(pr),fr=a(ir,2),Ee=a(o(fr),2),ur=o(Ee),Qe=a(gr,2);{var je=ke=>{var cr=oa(),zr=o(cr),Cr=a(o(zr),2),vo=o(Cr);B(()=>{i(cr,`background-color: ${e(t),r(()=>e(t).inputBg)??""}; color: ${e(t),r(()=>e(t).label)??""};`),f(vo,(e(l),r(()=>e(l).observaciones)))}),x(ke,cr)};ee(Qe,ke=>{e(l),r(()=>e(l).observaciones)&&ke(je)})}B(ke=>{i(C,`border-color: ${e(t),r(()=>e(t).cardBorder)??""}; background-color: ${e(t),r(()=>e(t).cardBg)??""};`),i(Q,`color: ${e(t),r(()=>e(t).label)??""};`),f(ne,`${e(l),r(()=>e(l).grado)??""} ‚Ä¢ ${ke??""}`),dr(Xe,1,`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[10px] font-medium ${Be(e(u)),r(()=>e(u).color)??""} mb-0.5`),f(Le,(Be(e(u)),r(()=>e(u).icon))),f(Ze,` ${e(l),r(()=>e(l).motivo)??""}`),i(ar,`color: ${e(t),r(()=>e(t).text)??""};`),f(sr,`${e(l),r(()=>e(l).horas)??""}h`),i(gr,`color: ${e(t),r(()=>e(t).text)??""};`),f(Oe,(e(l),r(()=>e(l).docente))),hr(Ee,"title",(e(l),r(()=>e(l).materia))),f(ur,(e(l),r(()=>e(l).materia)))},[()=>(e(l),r(()=>O(e(l).fecha)))]),x(n,C)}),B(()=>{i(Ie,`border-color: ${e(t),r(()=>e(t).cardBorder)??""};`),i($r,`background-color: ${e(t),r(()=>e(t).cardBg)??""}; border-color: ${e(t),r(()=>e(t).border)??""};`),i(Fo,`color: ${e(t),r(()=>e(t).text)??""};`),i(to,`color: ${e(t),r(()=>e(t).text)??""};`),i(ao,`color: ${e(t),r(()=>e(t).text)??""};`),i(so,`color: ${e(t),r(()=>e(t).text)??""};`),i(lo,`color: ${e(t),r(()=>e(t).text)??""};`),i(Bo,`color: ${e(t),r(()=>e(t).text)??""};`),i(no,`color: ${e(t),r(()=>e(t).text)??""};`),i(So,`color: ${e(t),r(()=>e(t).text)??""};`),i(Io,`border-color: ${e(t),r(()=>e(t).cardBorder)??""};`),i(Mr,`background-color: ${e(t),r(()=>e(t).cardBg)??""}; border-color: ${e(t),r(()=>e(t).border)??""};`),i(Mo,`color: ${e(t),r(()=>e(t).text)??""};`),i(zo,`color: ${e(t),r(()=>e(t).text)??""};`),i(Ao,`color: ${e(t),r(()=>e(t).text)??""};`),i(To,`color: ${e(t),r(()=>e(t).text)??""};`),i(co,`color: ${e(t),r(()=>e(t).text)??""};`),i(Ho,`color: ${e(t),r(()=>e(t).text)??""};`),i(jo,`color: ${e(t),r(()=>e(t).text)??""};`)}),x(E,J)};ee(ro,E=>{e(W),r(()=>e(W).length===0)?E(oo):E(tt,!1)})}B(()=>{i(y,`border-color: ${e(t),r(()=>e(t).cardBorder)??""};`),i(I,`color: ${e(t),r(()=>e(t).text)??""};`),i(Fe,`border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),i(j,`color: ${e(t),r(()=>e(t).text)??""};`),i(xe,`color: ${e(t),r(()=>e(t).text)??""};`),i(H,`border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),i(b,`border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),i(m,`border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),i(z,`border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),i(ae,`border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),i(uo,`color: ${e(t),r(()=>e(t).label)??""};`),i(Sr,`background-color: ${e(t),r(()=>e(t).inputBg)??""}; border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),i(wr,`color: ${e(t),r(()=>e(t).label)??""};`),f(Ko,`Materia ${e(c),r(()=>e(c).docente?"(del docente)":"")??""}`),i(jr,`background-color: ${e(t),r(()=>e(t).inputBg)??""}; border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),f(Ur,(e(c),r(()=>e(c).docente?"Todas las materias del docente":"Todas las materias"))),i(Jr,`color: ${e(t),r(()=>e(t).label)??""};`),f(Zo,`Grado ${e(c),r(()=>e(c).docente||e(c).materia?"(filtrado)":"")??""}`),i(Rr,`background-color: ${e(t),r(()=>e(t).inputBg)??""}; border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),f(xo,(e(c),r(()=>e(c).docente||e(c).materia?"Todos los grados filtrados":"Todos los grados"))),i(Kr,`color: ${e(t),r(()=>e(t).label)??""};`),i(Dr,`background-color: ${e(t),r(()=>e(t).inputBg)??""}; border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),f(_o,(e(c),r(()=>e(c).docente||e(c).materia||e(c).grado?"Todos los motivos filtrados":"Todos los motivos"))),i(Xr,`color: ${e(t),r(()=>e(t).label)??""};`),Lr.disabled=!e(L),i(Lr,`background-color: ${e(t),r(()=>e(t).inputBg)??""}; border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),i(yo,`color: ${e(t),r(()=>e(t).label)??""};`),Zr.disabled=!e(L),i(Zr,`background-color: ${e(t),r(()=>e(t).inputBg)??""}; border-color: ${e(t),r(()=>e(t).border)??""}; color: ${e(t),r(()=>e(t).text)??""};`),i(eo,`color: ${e(t),r(()=>e(t).label)??""};`),f(Or,(e(W),r(()=>e(W).length)))}),N("click",Fe,pe),Et(Z,()=>e(L),E=>p(L,E)),N("click",H,()=>ge("hoy")),N("click",b,()=>ge("semana")),N("click",m,()=>ge("mes")),N("click",z,()=>ge("mes_actual")),N("click",ae,()=>ge("trimestre")),Ye(Sr,()=>e(c).docente,E=>(Me(c,e(c).docente=E),We(()=>{e(t),e(g),e(v),e(ye),e(F)}))),Ye(jr,()=>e(c).materia,E=>(Me(c,e(c).materia=E),We(()=>{e(t),e(g),e(v),e(ye),e(F)}))),Ye(Rr,()=>e(c).grado,E=>(Me(c,e(c).grado=E),We(()=>{e(t),e(g),e(v),e(ye),e(F)}))),Ye(Dr,()=>e(c).motivo,E=>(Me(c,e(c).motivo=E),We(()=>{e(t),e(g),e(v),e(ye),e(F)}))),Ro(Lr,()=>e(c).fechaInicio,E=>(Me(c,e(c).fechaInicio=E),We(()=>{e(t),e(g),e(v),e(ye),e(F)}))),Ro(Zr,()=>e(c).fechaFin,E=>(Me(c,e(c).fechaFin=E),We(()=>{e(t),e(g),e(v),e(ye),e(F)}))),x(d,_)};ee(_e,d=>{e(nr)?d(De):d(se,!1)})}B(()=>{i(tr,`background-color: ${e(t),r(()=>e(t).cardBg)??""};`),i(Ae,`border-color: ${e(t),r(()=>e(t).cardBorder)??""};`),hr(T,"src",kt),i(fe,`color: ${e(t),r(()=>e(t).text)??""};`),i(he,`color: ${e(t),r(()=>e(t).label)??""};`),Y.disabled=(e(W),r(()=>e(W).length===0)),i(me,`color: ${e(t),r(()=>e(t).text)??""};`)}),N("click",Y,D),N("click",me,function(...d){Se()?.apply(this,d)}),N("click",Pe,vt(function(...d){Se()?.apply(this,d)})),N("keydown",Pe,d=>{(d.key==="Enter"||d.key===" ")&&Se()()}),x(Fr,Pe),Go()}var ia=w('<div class="flex justify-center py-12"><!></div>'),ca=w("<option> </option>"),da=w("<option> </option>"),va=w("<option> </option>"),ga=w("<option> </option>"),pa=_r('<svg class="animate-spin h-5 w-5" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Generando...',1),ua=_r('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg> Ver Reporte',1),ba=w('<div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="space-y-2"><label for="view-docente" class="block text-sm font-medium">Docente</label> <select id="view-docente" class="w-full px-4 py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none"><option>Seleccione docente</option><!></select></div> <div class="space-y-2"><label for="view-materia" class="block text-sm font-medium">Materia</label> <select id="view-materia" class="w-full px-4 py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none"><option>Seleccione materia</option><!></select></div> <div class="space-y-2"><label for="view-grado" class="block text-sm font-medium">Grado</label> <select id="view-grado" class="w-full px-4 py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none"><option>Seleccione grado</option><!></select></div> <div class="space-y-2"><label for="view-periodo" class="block text-sm font-medium">Periodo</label> <select id="view-periodo" class="w-full px-4 py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none"></select></div></div> <div class="pt-4 flex gap-3"><button class="flex-1 px-6 py-3 border rounded-xl hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors font-medium">Cancelar</button> <button class="flex-[2] px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl transition-all font-bold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"><!></button></div>',1),xa=w('<th class="p-2 border text-white font-bold text-center sticky top-0 z-20" style="background-color: #4472C4; min-width: 60px;"> </th>'),fa=w('<td class="p-2 border text-center font-medium bg-white cell-hover svelte-14neep5"> </td>'),ha=w('<tr class="hover-row svelte-14neep5"><td class="p-2 border font-medium sticky left-0 z-10 bg-[#F2F2F2] svelte-14neep5" style="background-color: #F2F2F2;"> </td><!><td class="p-2 border text-center font-bold bg-white cell-hover svelte-14neep5"> </td></tr>'),ma=w('<div class="space-y-4 min-w-0"><div class="text-center p-4 rounded-lg flex-shrink-0" style="background-color: #2E75B6; color: white;"><h3 class="text-lg font-bold whitespace-nowrap"> </h3></div> <div class="p-3 rounded-lg text-sm flex-shrink-0" style="background-color: #5B9BD5; color: white;"><p class="font-medium whitespace-nowrap"> </p></div> <div class="overflow-auto border rounded-lg flex-1 min-h-[200px] max-h-[50vh]"><table class="w-full border-collapse text-xs md:text-sm"><thead class="sticky top-0 z-30 shadow-sm"><tr><th class="p-2 border text-white font-bold sticky left-0 z-40" style="background-color: #4472C4; width: 200px;">Estudiantes</th><!><th class="p-2 border text-white font-bold text-center sticky top-0 z-20" style="background-color: #FF6B6B; width: 80px;">Total Horas</th></tr></thead><tbody class="bg-white"></tbody></table></div> <div class="pt-4 flex gap-3 flex-shrink-0"><button class="flex-1 px-6 py-3 border rounded-xl hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors font-medium">Nueva Consulta</button> <button class="flex-1 px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white rounded-xl transition-colors font-medium">Cerrar</button></div></div>'),_a=w('<div class="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-2 md:p-4" role="dialog" aria-modal="true" aria-labelledby="modal-title" tabindex="-1"><div class="bg-white dark:bg-gray-900 rounded-2xl w-full max-w-[95vw] max-h-[90vh] overflow-hidden shadow-2xl border flex flex-col"><div class="flex items-center justify-between p-4 md:p-6 border-b flex-shrink-0"><div class="flex items-center gap-3"><div class="p-2 rounded-lg bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-200"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div> <div><h2 id="modal-title" class="text-lg md:text-xl font-bold">Vista de Reporte</h2> <p class="text-sm opacity-75">Inasistencias por materia y grado</p></div></div> <button class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors" aria-label="Cerrar"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="p-4 md:p-6 space-y-4 overflow-y-auto flex-1"><!></div></div></div>');function wt(Fr,lr){No(lr,!1);const v=k();let er=Hr(lr,"onClose",8),ye=Hr(lr,"initialDocente",8,""),F=k([]),t=k([]),Se=k([]),s=k(ye()||""),P=k(""),we=k(""),$e=k(Vr[0].nombre),Ve=k(!1),nr=k(!1),L=k(null);const W=D=>D?D.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-zA-Z0-9\s]/g,"").replace(/\s+/g," ").trim().toLowerCase():"",c=D=>{if(!D)return"";const O=D.split("/");if(O.length===3){const ue=O[0].padStart(2,"0"),Pe=O[1].padStart(2,"0");return`${O[2]}-${Pe}-${ue}`}return D},rr=D=>{const O=[],ue=new Date(D.fecha_inicio),Pe=new Date(D.fecha_fin);for(;ue<=Pe;){const tr=ue.getUTCDay();tr>=1&&tr<=6&&O.push(new Date(ue)),ue.setUTCDate(ue.getUTCDate()+1)}return O},ge=D=>{const O=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"];return`${D.getUTCDate()}/${O[D.getUTCMonth()]}/${D.getUTCFullYear().toString().substr(2)}`};Po(async()=>{p(Ve,!0);try{const[D,O,ue]=await Promise.all([Uo(),Wo(),qo()]);p(F,D),p(t,O),p(Se,ue)}catch(D){console.error("Error cargando datos iniciales:",D)}finally{p(Ve,!1)}});const Re=async()=>{if(!e(s)||!e(P)||!e(we)){Ge.fire({icon:"warning",title:"Campos incompletos",text:"Por favor seleccione Docente, Materia y Grado."});return}const D=Vr.find(O=>O.nombre===e($e));if(!D){Ge.fire({icon:"error",title:"Error",text:"Periodo no encontrado"});return}p(nr,!0);try{const O=await gt({spreadsheetId:go,worksheetTitle:Vo});if(!O?.records||!Array.isArray(O.records))throw new Error("No se pudieron obtener los registros de inasistencias");const ue=O.records.slice(1),Pe=W(e(s)),tr=W(e(P)),Ae=e(we).toString().trim(),$=ue.map(G=>{const Y=G.values||[];return{fecha:Y[2]||"",docente:Y[1]||"",materia:Y[4]||"",grado:(Y[6]||"").toString().trim(),nombre:Y[7]||"",motivo:Y[5]||"",horas:Y[3]||"0"}}).filter(G=>{const Y=W(G.docente),me=W(G.materia),Te=G.grado,_e=Y.includes(Pe)||Pe.includes(Y),De=me.includes(tr)||tr.includes(me),se=Te===Ae||Te.startsWith(Ae)||Ae.startsWith(Te),d=c(G.fecha),_=new Date(d),y=new Date(D.fecha_inicio),S=new Date(D.fecha_fin);y.setHours(0,0,0,0),S.setHours(23,59,59,999);const I=_>=y&&_<=S;return _e&&De&&se&&I}),T=e(Se).filter(G=>G.grado.toString()===e(we)).map(G=>G.nombre).sort();if(T.length===0)throw new Error("No hay estudiantes registrados para el grado seleccionado");const fe=rr(D).filter(G=>{const Y=G.toISOString().split("T")[0];return $.some(me=>c(me.fecha)===Y)});if(fe.length===0){Ge.fire({icon:"info",title:"Sin datos",text:"No se encontraron inasistencias para los filtros seleccionados en este periodo."});return}const he=T.map(G=>{const Y=[];let me=0;return fe.forEach(Te=>{const _e=Te.toISOString().split("T")[0],De=$.filter(se=>W(se.nombre)===W(G)&&c(se.fecha)===_e);if(De.length>0){const se=De[0],d=parseFloat(se.horas)||0,_=se.motivo||"";d>0?(Y.push({valor:d.toString(),horas:d}),me+=d):_?Y.push({valor:_,horas:0}):Y.push({valor:"X",horas:0})}else Y.push({valor:"‚úì",horas:0})}),{nombre:G,registros:Y,totalHoras:me}});p(L,{docente:e(s),materia:e(P),grado:e(we),periodo:D.nombre,fechaInicio:ge(D.fecha_inicio),fechaFin:ge(D.fecha_fin),fechas:fe.map(G=>ge(G)),estudiantes:he})}catch(O){console.error("Error generando reporte:",O);const ue=O instanceof Error?O.message:"Error desconocido";Ge.fire({icon:"error",title:"Error",text:ue})}finally{p(nr,!1)}};qe(()=>{},()=>{p(v,{bg:"rgb(var(--bg-primary))",text:"rgb(var(--text-primary))",label:"rgb(var(--text-secondary))",border:"rgb(var(--border-primary))",cardBg:"rgb(var(--card-bg))",cardBorder:"rgb(var(--card-border))",inputBg:"rgb(var(--bg-secondary))"})}),Lo(),Oo();var Ce=_a(),g=o(Ce),q=o(g),Je=a(o(q),2),Ne=a(q,2),or=o(Ne);{var R=D=>{var O=ia(),ue=o(O);_t(ue,{message:"Cargando datos..."}),x(D,O)},pe=D=>{var O=mt(),ue=mr(O);{var Pe=Ae=>{var $=ba(),T=mr($),X=o(T),fe=o(X),he=a(fe,2),G=o(he);G.value=G.__value="";var Y=a(G);ve(Y,1,()=>e(F),be,(H,b)=>{var m=ca(),z=o(m),ae={};B(()=>{f(z,e(b)),ae!==(ae=e(b))&&(m.value=(m.__value=e(b))??"")}),x(H,m)});var me=a(X,2),Te=o(me),_e=a(Te,2),De=o(_e);De.value=De.__value="";var se=a(De);ve(se,1,()=>e(t),be,(H,b)=>{var m=da(),z=o(m),ae={};B(()=>{f(z,(e(b),r(()=>e(b).materia))),ae!==(ae=(e(b),r(()=>e(b).materia)))&&(m.value=(m.__value=(e(b),r(()=>e(b).materia)))??"")}),x(H,m)});var d=a(me,2),_=o(d),y=a(_,2),S=o(y);S.value=S.__value="";var I=a(S);ve(I,1,()=>(e(Se),r(()=>[...new Set(e(Se).map(H=>H.grado.toString()))])),be,(H,b)=>{var m=va(),z=o(m),ae={};B(ze=>{f(z,ze),ae!==(ae=e(b))&&(m.value=(m.__value=e(b))??"")},[()=>(e(b),r(()=>e(b).replace(/0(\d)$/,"¬∞$1").replace(/(\d{1,2})0(\d)/,"$1¬∞$2")))]),x(H,m)});var M=a(d,2),te=o(M),Fe=a(te,2);ve(Fe,5,()=>Vr,be,(H,b)=>{var m=ga(),z=o(m),ae={};B(()=>{f(z,`Periodo ${e(b),r(()=>e(b).nombre)??""}`),ae!==(ae=(e(b),r(()=>e(b).nombre)))&&(m.value=(m.__value=(e(b),r(()=>e(b).nombre)))??"")}),x(H,m)});var h=a(T,2),j=o(h),le=a(j,2),Z=o(le);{var xe=H=>{var b=pa();x(H,b)},He=H=>{var b=ua();x(H,b)};ee(Z,H=>{e(nr)?H(xe):H(He,!1)})}B(()=>{i(fe,`color: ${e(v),r(()=>e(v).label)??""};`),i(he,`background-color: ${e(v),r(()=>e(v).inputBg)??""}; border-color: ${e(v),r(()=>e(v).border)??""}; color: ${e(v),r(()=>e(v).text)??""};`),i(Te,`color: ${e(v),r(()=>e(v).label)??""};`),i(_e,`background-color: ${e(v),r(()=>e(v).inputBg)??""}; border-color: ${e(v),r(()=>e(v).border)??""}; color: ${e(v),r(()=>e(v).text)??""};`),i(_,`color: ${e(v),r(()=>e(v).label)??""};`),i(y,`background-color: ${e(v),r(()=>e(v).inputBg)??""}; border-color: ${e(v),r(()=>e(v).border)??""}; color: ${e(v),r(()=>e(v).text)??""};`),i(te,`color: ${e(v),r(()=>e(v).label)??""};`),i(Fe,`background-color: ${e(v),r(()=>e(v).inputBg)??""}; border-color: ${e(v),r(()=>e(v).border)??""}; color: ${e(v),r(()=>e(v).text)??""};`),i(j,`border-color: ${e(v),r(()=>e(v).border)??""};`),le.disabled=e(nr)||!e(s)||!e(P)||!e(we)}),Ye(he,()=>e(s),H=>p(s,H)),Ye(_e,()=>e(P),H=>p(P,H)),Ye(y,()=>e(we),H=>p(we,H)),Ye(Fe,()=>e($e),H=>p($e,H)),N("click",j,function(...H){er()?.apply(this,H)}),N("click",le,Re),x(Ae,$)},tr=Ae=>{var $=ma(),T=o($),X=o(T),fe=o(X),he=a(T,2),G=o(he),Y=o(G),me=a(he,2),Te=o(me),_e=o(Te),De=o(_e),se=a(o(De));ve(se,1,()=>(e(L),r(()=>e(L).fechas)),be,(I,M)=>{var te=xa(),Fe=o(te);B(()=>f(Fe,e(M))),x(I,te)});var d=a(_e);ve(d,5,()=>(e(L),r(()=>e(L).estudiantes)),be,(I,M)=>{var te=ha(),Fe=o(te),h=o(Fe),j=a(Fe);ve(j,1,()=>(e(M),r(()=>e(M).registros)),be,(xe,He)=>{const H=vr(()=>(e(He),r(()=>e(He).valor==="‚úì")));var b=fa(),m=o(b);B(()=>{i(b,e(H)?"color: #00AA00;":"color: #FF0000; background-color: #FFE6E6;"),f(m,(e(He),r(()=>e(He).valor)))}),x(xe,b)});var le=a(j),Z=o(le);B(()=>{f(h,(e(M),r(()=>e(M).nombre))),i(le,(e(M),r(()=>e(M).totalHoras>0?"color: #FF0000; background-color: #FFE6E6;":"color: #00AA00; background-color: #E6FFE6;"))),f(Z,(e(M),r(()=>e(M).totalHoras)))}),x(I,te)});var _=a(me,2),y=o(_),S=a(y,2);B(()=>{f(fe,`REPORTE DE INASISTENCIAS - ${e(L),r(()=>e(L).materia)??""} - GRADO ${e(L),r(()=>e(L).grado)??""}`),f(Y,`Docente: ${e(L),r(()=>e(L).docente)??""} | Periodo: ${e(L),r(()=>e(L).periodo)??""} (${e(L),r(()=>e(L).fechaInicio)??""} - ${e(L),r(()=>e(L).fechaFin)??""})`),i(y,`border-color: ${e(v),r(()=>e(v).border)??""};`)}),N("click",y,()=>p(L,null)),N("click",S,function(...I){er()?.apply(this,I)}),x(Ae,$)};ee(ue,Ae=>{e(L)?Ae(tr,!1):Ae(Pe)})}x(D,O)};ee(or,D=>{e(Ve)?D(R):D(pe,!1)})}B(()=>{i(g,`background-color: ${e(v),r(()=>e(v).cardBg)??""}; border-color: ${e(v),r(()=>e(v).cardBorder)??""}; color: ${e(v),r(()=>e(v).text)??""};`),i(q,`border-color: ${e(v),r(()=>e(v).cardBorder)??""};`)}),N("click",Je,function(...D){er()?.apply(this,D)}),N("click",Ce,vt(function(...D){er()?.apply(this,D)})),N("keydown",Ce,D=>D.key==="Escape"&&er()()),x(Fr,Ce),Go()}var ka=w('<div class="flex justify-center py-12"><!></div>'),wa=w("<option> </option>"),ya=w("<option> </option>"),$a=w("<option> </option>"),Ca=w("<option> </option>"),Fa=_r('<svg class="animate-spin h-5 w-5 text-white" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Generando...',1),Ba=_r('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg> Descargar Excel',1),Sa=w('<div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="space-y-2"><label for="rep-docente" class="block text-sm font-medium">Docente</label> <select id="rep-docente" class="w-full px-4 py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none"><option>Seleccione docente</option><!></select></div> <div class="space-y-2"><label for="rep-materia" class="block text-sm font-medium">Materia</label> <select id="rep-materia" class="w-full px-4 py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none"><option>Seleccione materia</option><!></select></div> <div class="space-y-2"><label for="rep-grado" class="block text-sm font-medium">Grado</label> <select id="rep-grado" class="w-full px-4 py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none"><option>Seleccione grado</option><!></select></div> <div class="space-y-2"><label for="rep-periodo" class="block text-sm font-medium">Periodo</label> <select id="rep-periodo" class="w-full px-4 py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 outline-none"></select></div></div> <div class="pt-4 flex gap-3"><button class="flex-1 px-6 py-3 border rounded-xl hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors font-medium">Cancelar</button> <button class="flex-1 px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-xl transition-all font-bold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg hover:shadow-green-500/20"><!></button></div>',1),Da=w('<div class="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4" role="dialog" aria-modal="true" aria-labelledby="modal-title" tabindex="-1"><div class="bg-white dark:bg-gray-900 rounded-2xl w-full max-w-2xl overflow-hidden shadow-2xl border"><div class="flex items-center justify-between p-6 border-b"><div class="flex items-center gap-3"><div class="p-2 rounded-lg bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-200"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div> <div><h2 id="modal-title" class="text-xl font-bold">Generador de Reporte Excel</h2> <p class="text-sm opacity-75">Inasistencias por materia y grado</p></div></div> <button class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors" aria-label="Cerrar modal"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="p-6 space-y-6"><!></div></div></div> <!>',1);function Ia(Fr,lr){No(lr,!1);const v=k();let er=null,ye=null,F=Hr(lr,"onClose",8),t=Hr(lr,"initialDocente",8,""),Se=k([]),s=k([]),P=k([]),we=k(t()||""),$e=k(""),Ve=k(""),nr=k(Vr[0].nombre),L=k(!1),W=k(!1),c=k(!1);const rr=async()=>{if(!er||!ye){const[$,T]=await Promise.all([ht(()=>import("./excel-pvs9swoc.js").then(X=>X.e),[]),ht(()=>import("./utils-BOnwv8s1.js").then(X=>X.F),__vite__mapDeps([0,1]))]);er=$.default,ye=T.default}},ge=$=>$?$.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-zA-Z0-9\s]/g,"").replace(/\s+/g," ").trim().toLowerCase():"",Re=$=>{if(!$)return"";const T=$.split("/");if(T.length===3){const X=T[0].padStart(2,"0"),fe=T[1].padStart(2,"0");return`${T[2]}-${fe}-${X}`}return $},Ce=$=>{const T=[],X=new Date($.fecha_inicio),fe=new Date($.fecha_fin);for(;X<=fe;){const he=X.getUTCDay();he>=1&&he<=6&&T.push(new Date(X)),X.setUTCDate(X.getUTCDate()+1)}return T},g=$=>{const T=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"];return`${$.getUTCDate()}/${T[$.getUTCMonth()]}/${$.getUTCFullYear().toString().substr(2)}`};Po(async()=>{p(L,!0);try{const[$,T,X]=await Promise.all([Uo(),Wo(),qo()]);p(Se,$),p(s,T),p(P,X)}catch($){console.error("Error cargando datos iniciales:",$)}finally{p(L,!1)}});const q=async()=>{if(await rr(),!e(we)||!e($e)||!e(Ve)){Ge.fire({icon:"warning",title:"Campos incompletos",text:"Por favor seleccione Docente, Materia y Grado."});return}const $=Vr.find(T=>T.nombre===e(nr));if(!$){Ge.fire({icon:"error",title:"Error",text:"Periodo no encontrado"});return}p(W,!0);try{const T=await gt({spreadsheetId:go,worksheetTitle:Vo});if(!T?.records||!Array.isArray(T.records))throw new Error("No se pudieron obtener los registros de inasistencias");const X=T.records.slice(1),fe=ge(e(we)),he=ge(e($e)),G=e(Ve).toString().trim(),Y=X.map(h=>{const j=h.values||[];return{fecha:j[2]||"",docente:j[1]||"",materia:j[4]||"",grado:(j[6]||"").toString().trim(),nombre:j[7]||"",motivo:j[5]||"",horas:j[3]||"0"}}).filter(h=>{const j=ge(h.docente),le=ge(h.materia),Z=h.grado,xe=j.includes(fe)||fe.includes(j),He=le.includes(he)||he.includes(le),H=Z===G||Z.startsWith(G)||G.startsWith(Z),b=Re(h.fecha),m=new Date(b),z=new Date($.fecha_inicio),ae=new Date($.fecha_fin);z.setHours(0,0,0,0),ae.setHours(23,59,59,999);const ze=m>=z&&m<=ae;return xe&&He&&H&&ze}),me=e(P).filter(h=>h.grado.toString()===e(Ve)).map(h=>h.nombre).sort();if(me.length===0)throw new Error("No hay estudiantes registrados para el grado seleccionado");const _e=Ce($).filter(h=>{const j=h.toISOString().split("T")[0];return Y.some(le=>Re(le.fecha)===j)});if(_e.length===0){Ge.fire({icon:"info",title:"Sin datos",text:"No se encontraron inasistencias para los filtros seleccionados en este periodo."}),p(W,!1);return}const De=new er.Workbook,se=De.addWorksheet("Reporte de Inasistencias"),d=_e.length+2,_=se.addRow([`REPORTE DE INASISTENCIAS - ${e($e)} - GRADO ${e(Ve)}`]);_.height=30,_.font={bold:!0,size:16,color:{argb:"FFFFFF"}},_.fill={type:"pattern",pattern:"solid",fgColor:{argb:"2E75B6"}},_.alignment={vertical:"middle",horizontal:"center"},se.mergeCells(1,1,1,d);const y=se.addRow([`Docente: ${e(we)} | Periodo: ${$.nombre} (${g($.fecha_inicio)} - ${g($.fecha_fin)})`]);y.height=20,y.font={bold:!0,size:10,color:{argb:"FFFFFF"}},y.fill={type:"pattern",pattern:"solid",fgColor:{argb:"5B9BD5"}},y.alignment={vertical:"middle",horizontal:"left"},se.mergeCells(2,1,2,d);const S=["Estudiantes",..._e.map(h=>g(h)),"Total Horas"],I=se.addRow(S);I.height=25,I.font={bold:!0,size:11,color:{argb:"FFFFFF"}},I.alignment={vertical:"middle",horizontal:"center"},se.getColumn(1).width=35,_e.forEach((h,j)=>{se.getColumn(j+2).width=22}),se.getColumn(d).width=15,I.eachCell((h,j)=>{h.fill={type:"pattern",pattern:"solid",fgColor:{argb:j===d?"FF6B6B":"4472C4"}},h.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),me.forEach(h=>{const j=[h];let le=0;_e.forEach(He=>{const H=He.toISOString().split("T")[0],b=Y.filter(m=>ge(m.nombre)===ge(h)&&Re(m.fecha)===H);if(b.length>0){const m=b[0],z=parseFloat(m.horas)||0,ae=m.motivo||"";z>0?(j.push(z.toString()),le+=z):ae?j.push(ae):j.push("X")}else j.push("‚úì")}),j.push(le.toString());const Z=se.addRow(j);Z.height=30,Z.getCell(1).font={bold:!0},Z.getCell(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"F2F2F2"}},_e.forEach((He,H)=>{const b=Z.getCell(H+2);b.alignment={horizontal:"center",vertical:"middle",wrapText:!0};const m=b.value?.toString()||"",z=parseFloat(m)||0;m==="‚úì"?b.font={color:{argb:"00AA00"}}:z>0||isNaN(z)?(b.font={color:{argb:"FF0000"},bold:!0},b.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE6E6"}}):(b.font={color:{argb:"FF0000"},bold:!0},b.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE6E6"}})});const xe=Z.getCell(d);xe.font={bold:!0,color:{argb:le>0?"FF0000":"00AA00"}},xe.alignment={horizontal:"center"},xe.fill={type:"pattern",pattern:"solid",fgColor:{argb:le>0?"FFE6E6":"E6FFE6"}},Z.eachCell(He=>{He.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})});const M=await De.xlsx.writeBuffer(),te=new Blob([M],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Fe=`Reporte_Inasistencias_${e(Ve)}_${e($e).replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.xlsx`;ye(te,Fe),Ge.fire({icon:"success",title:"Reporte generado",text:`Se ha generado el reporte con ${me.length} estudiantes.`,timer:2e3,showConfirmButton:!1})}catch(T){console.error("Error generando Excel:",T);const X=T instanceof Error?T.message:"Error desconocido";Ge.fire({icon:"error",title:"Error",text:X})}finally{p(W,!1)}};qe(()=>{},()=>{p(v,{bg:"rgb(var(--bg-primary))",text:"rgb(var(--text-primary))",label:"rgb(var(--text-secondary))",border:"rgb(var(--border-primary))",cardBg:"rgb(var(--card-bg))",cardBorder:"rgb(var(--card-border))",inputBg:"rgb(var(--bg-secondary))"})}),Lo(),Oo();var Je=Da(),Ne=mr(Je),or=o(Ne),R=o(or),pe=a(o(R),2),D=a(R,2),O=o(D);{var ue=$=>{var T=ka(),X=o(T);_t(X,{message:"Cargando datos..."}),x($,T)},Pe=$=>{var T=Sa(),X=mr(T),fe=o(X),he=o(fe),G=a(he,2),Y=o(G);Y.value=Y.__value="";var me=a(Y);ve(me,1,()=>e(Se),be,(b,m)=>{var z=wa(),ae=o(z),ze={};B(()=>{f(ae,e(m)),ze!==(ze=e(m))&&(z.value=(z.__value=e(m))??"")}),x(b,z)});var Te=a(fe,2),_e=o(Te),De=a(_e,2),se=o(De);se.value=se.__value="";var d=a(se);ve(d,1,()=>e(s),be,(b,m)=>{var z=ya(),ae=o(z),ze={};B(()=>{f(ae,(e(m),r(()=>e(m).materia))),ze!==(ze=(e(m),r(()=>e(m).materia)))&&(z.value=(z.__value=(e(m),r(()=>e(m).materia)))??"")}),x(b,z)});var _=a(Te,2),y=o(_),S=a(y,2),I=o(S);I.value=I.__value="";var M=a(I);ve(M,1,()=>(e(P),r(()=>[...new Set(e(P).map(b=>b.grado.toString()))])),be,(b,m)=>{var z=$a(),ae=o(z),ze={};B(Br=>{f(ae,Br),ze!==(ze=e(m))&&(z.value=(z.__value=e(m))??"")},[()=>(e(m),r(()=>e(m).replace(/0(\d)$/,"¬∞$1").replace(/(\d{1,2})0(\d)/,"$1¬∞$2")))]),x(b,z)});var te=a(_,2),Fe=o(te),h=a(Fe,2);ve(h,5,()=>Vr,be,(b,m)=>{var z=Ca(),ae=o(z),ze={};B(()=>{f(ae,`Periodo ${e(m),r(()=>e(m).nombre)??""}`),ze!==(ze=(e(m),r(()=>e(m).nombre)))&&(z.value=(z.__value=(e(m),r(()=>e(m).nombre)))??"")}),x(b,z)});var j=a(X,2),le=o(j),Z=a(le,2),xe=o(Z);{var He=b=>{var m=Fa();x(b,m)},H=b=>{var m=Ba();x(b,m)};ee(xe,b=>{e(W)?b(He):b(H,!1)})}B(()=>{i(he,`color: ${e(v),r(()=>e(v).label)??""};`),i(G,`background-color: ${e(v),r(()=>e(v).inputBg)??""}; border-color: ${e(v),r(()=>e(v).border)??""}; color: ${e(v),r(()=>e(v).text)??""};`),i(_e,`color: ${e(v),r(()=>e(v).label)??""};`),i(De,`background-color: ${e(v),r(()=>e(v).inputBg)??""}; border-color: ${e(v),r(()=>e(v).border)??""}; color: ${e(v),r(()=>e(v).text)??""};`),i(y,`color: ${e(v),r(()=>e(v).label)??""};`),i(S,`background-color: ${e(v),r(()=>e(v).inputBg)??""}; border-color: ${e(v),r(()=>e(v).border)??""}; color: ${e(v),r(()=>e(v).text)??""};`),i(Fe,`color: ${e(v),r(()=>e(v).label)??""};`),i(h,`background-color: ${e(v),r(()=>e(v).inputBg)??""}; border-color: ${e(v),r(()=>e(v).border)??""}; color: ${e(v),r(()=>e(v).text)??""};`),i(le,`border-color: ${e(v),r(()=>e(v).border)??""};`),Z.disabled=e(W)||!e(we)||!e($e)||!e(Ve)}),Ye(G,()=>e(we),b=>p(we,b)),Ye(De,()=>e($e),b=>p($e,b)),Ye(S,()=>e(Ve),b=>p(Ve,b)),Ye(h,()=>e(nr),b=>p(nr,b)),N("click",le,function(...b){F()?.apply(this,b)}),N("click",Z,q),x($,T)};ee(O,$=>{e(L)?$(ue):$(Pe,!1)})}var tr=a(Ne,2);{var Ae=$=>{wt($,{onClose:()=>p(c,!1),get initialDocente(){return e(we)}})};ee(tr,$=>{e(c)&&$(Ae)})}B(()=>{i(or,`background-color: ${e(v),r(()=>e(v).cardBg)??""}; border-color: ${e(v),r(()=>e(v).cardBorder)??""}; color: ${e(v),r(()=>e(v).text)??""};`),i(R,`border-color: ${e(v),r(()=>e(v).cardBorder)??""};`)}),N("click",pe,function(...$){F()?.apply(this,$)}),N("click",Ne,vt(function(...$){F()?.apply(this,$)})),N("keydown",Ne,$=>$.key==="Escape"&&F()()),x(Fr,Je),Go()}var Ea=w('<div class="absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full animate-ping svelte-gsxx31"></div> <div class="absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full svelte-gsxx31"></div>',1),Ma=w('<div class="absolute -top-1 -right-1 w-3 h-3 bg-green-500 rounded-full animate-ping svelte-gsxx31"></div> <div class="absolute -top-1 -right-1 w-3 h-3 bg-green-500 rounded-full svelte-gsxx31"></div>',1),za=_r('<svg class="w-5 h-5 text-indigo-500 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" class="svelte-gsxx31"></path></svg>'),Aa=_r('<svg class="w-5 h-5 text-amber-500 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" class="svelte-gsxx31"></path></svg>'),Ta=_r('<svg class="w-5 h-5 text-indigo-400 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" class="svelte-gsxx31"></path></svg>'),Ha=w('<div class="mb-6 p-4 rounded-xl border flex items-start gap-4 animate-fade-in relative transition-all duration-300 bg-green-50 dark:bg-indigo-900/40 border-green-200 dark:border-indigo-700 shadow-sm svelte-gsxx31"><div class="p-2 rounded-lg bg-green-100 dark:bg-indigo-800 text-green-700 dark:text-indigo-200 flex-shrink-0 svelte-gsxx31"><svg class="w-5 h-5 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-gsxx31"></path></svg></div> <div class="flex-1 pr-6 pt-0.5 svelte-gsxx31"><h4 class="text-sm font-bold mb-1 text-green-900 dark:text-indigo-100 svelte-gsxx31">Informaci√≥n</h4> <p class="text-sm leading-relaxed text-green-800 dark:text-indigo-200 svelte-gsxx31"> </p></div> <button class="absolute top-3 right-3 p-1.5 rounded-lg hover:bg-green-100 dark:hover:bg-indigo-700 text-green-600 hover:text-green-800 dark:text-indigo-400 dark:hover:text-indigo-100 transition-colors svelte-gsxx31" aria-label="Cerrar alerta"><svg class="w-4 h-4 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-gsxx31"></path></svg></button></div>'),ja=w('<option class="svelte-gsxx31"> </option>'),Ra=w('<option class="svelte-gsxx31"> </option>'),Na=w('<select><option class="svelte-gsxx31">Horas...</option><option class="svelte-gsxx31">0</option><!></select>'),Pa=w('<div><div class="flex items-center gap-1.5 svelte-gsxx31"><input type="checkbox" class="w-4 h-4 lg:w-5 lg:h-5 rounded text-indigo-500 focus:ring-indigo-500 svelte-gsxx31" style="accent-color: #6366f1;"/> <span class="text-sm lg:text-sm flex-shrink-0 svelte-gsxx31"> </span></div> <!></div>'),La=w("<div></div>"),Oa=w('<option class="svelte-gsxx31"> </option>'),Ga=w('<select id="materia" name="materia" required=""><option class="svelte-gsxx31"> </option><!></select>'),Va=w('<option class="svelte-gsxx31"> </option>'),Ua=w('<option class="svelte-gsxx31"> </option>'),Wa=w('<span><span class="mr-1.5 svelte-gsxx31"> </span> <button type="button" class="ml-1.5 hover:opacity-70 transition-opacity svelte-gsxx31" aria-label="Eliminar motivo"><svg class="w-3 h-3 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M6 18L18 6M6 6l12 12" class="svelte-gsxx31"></path></svg></button></span>'),qa=w('<option class="svelte-gsxx31"> </option>'),Ya=w('<option class="svelte-gsxx31"> </option>'),Ja=w('<div class="flex items-center gap-2 svelte-gsxx31"><button type="button" class="p-2 rounded-lg transition-colors hover:bg-black/5 dark:hover:bg-white/5 svelte-gsxx31" title="Agregar observaci√≥n"><svg class="w-5 h-5 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-gsxx31"></path></svg></button></div>'),Ka=w('<div class="px-4 pb-4 animate-fade-in svelte-gsxx31"><textarea placeholder="Escribe una observaci√≥n espec√≠fica para este estudiante..." rows="2" class="w-full px-4 py-2 rounded-xl border focus:ring-2 focus:ring-indigo-500 transition-all outline-none resize-none text-sm svelte-gsxx31"></textarea></div>'),Xa=w('<div><div class="flex-1 min-w-0 svelte-gsxx31"><span class="text-base font-medium block svelte-gsxx31"> </span> <div class="flex flex-wrap gap-2 mt-2 svelte-gsxx31"></div></div> <div class="flex flex-col sm:flex-row items-center gap-2 w-full sm:w-auto svelte-gsxx31"><div><select class="w-full appearance-none border rounded-lg px-4 py-2 pr-10 text-sm focus:ring-2 focus:ring-indigo-500 cursor-pointer transition-all outline-none svelte-gsxx31"><option class="svelte-gsxx31">Hora...</option><option class="svelte-gsxx31">0 (Sin hora)</option><!></select> <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 svelte-gsxx31"><svg class="w-4 h-4 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-gsxx31"></path></svg></div></div> <div class="relative w-full sm:w-56 svelte-gsxx31"><select class="w-full appearance-none border rounded-lg px-4 py-2 pr-10 text-sm focus:ring-2 focus:ring-indigo-500 cursor-pointer transition-all outline-none svelte-gsxx31"><option class="svelte-gsxx31">A√±adir motivo...</option><option class="svelte-gsxx31">üö´ Limpiar todo</option><!></select> <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 svelte-gsxx31"><svg class="w-4 h-4 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" class="svelte-gsxx31"></path></svg></div></div></div> <!></div> <!>',1),Za=w('<div class="text-center py-12 opacity-60 svelte-gsxx31">No hay estudiantes en este grado.</div>'),Qa=w('<div class="space-y-3 animate-fade-in svelte-gsxx31"><label class="block text-sm font-semibold uppercase tracking-wider svelte-gsxx31"> </label> <div class="space-y-2 max-h-[700px] overflow-y-auto border rounded-2xl p-4 bg-zinc-50/50 dark:bg-zinc-900/50 backdrop-blur-sm scrollbar-thin scrollbar-thumb-zinc-300 dark:scrollbar-thumb-zinc-600 svelte-gsxx31"><!> <!></div></div>'),es=_r('<svg class="animate-spin h-6 w-6 lg:h-7 lg:w-7 svelte-gsxx31" fill="none" viewBox="0 0 24 24"><circle class="opacity-25 svelte-gsxx31" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75 svelte-gsxx31" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>'),rs=_r('<svg class="h-6 w-6 lg:h-7 lg:w-7 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" class="svelte-gsxx31"></path></svg>'),os=w('<span class="absolute -top-1 -right-1 lg:-top-2 lg:-right-2 bg-red-500 text-white text-[10px] lg:text-xs font-bold rounded-full h-5 w-5 lg:h-6 lg:w-6 flex items-center justify-center ring-2 ring-white dark:ring-zinc-950 animate-bounce svelte-gsxx31"> </span>'),ts=w('<div class="min-h-screen flex flex-col lg:flex-row transition-colors duration-200 svelte-gsxx31"><aside class="w-full lg:w-80 lg:h-screen lg:sticky lg:top-0 border-b lg:border-b-0 lg:border-r transition-colors duration-200 p-6 lg:p-8 flex flex-col flex-shrink-0 z-40 svelte-gsxx31"><div class="flex flex-col lg:flex-col items-center justify-between lg:justify-start gap-4 lg:gap-8 svelte-gsxx31"><div class="flex items-center gap-4 lg:flex-col svelte-gsxx31"><img alt="EIE Logo" class="h-12 lg:h-20 w-auto svelte-gsxx31"/> <h1 class="text-xl lg:text-2xl tracking-tight font-bold lg:text-center svelte-gsxx31">Registrar Inasistencias</h1></div> <div class="flex flex-wrap justify-center lg:flex-col gap-3 w-full svelte-gsxx31"><button class="inline-flex items-center justify-center gap-2 px-3 lg:px-4 py-2 lg:py-3 border rounded-lg transition-all duration-200 hover:bg-black/5 dark:hover:bg-white/5 svelte-gsxx31" title="Abrir hoja de c√°lculo"><svg class="w-5 h-5 svelte-gsxx31" viewBox="0 0 24 24" fill="currentColor"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96z" class="svelte-gsxx31"></path></svg> <span class="text-sm font-medium hidden lg:inline svelte-gsxx31">Hoja de C√°lculo</span></button> <button id="filter-button-target" class="inline-flex items-center justify-center gap-2 px-3 lg:px-4 py-2 lg:py-3 border rounded-lg transition-all duration-200 hover:bg-black/5 dark:hover:bg-white/5 relative svelte-gsxx31" title="Abrir Looker Studio"><svg class="w-5 h-5 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" class="svelte-gsxx31"></path></svg> <span class="text-sm font-medium hidden lg:inline svelte-gsxx31">Filtros</span> <!></button> <button id="report-button-target" class="inline-flex items-center justify-center gap-2 px-3 lg:px-4 py-2 lg:py-3 border rounded-lg transition-all duration-200 hover:bg-black/5 dark:hover:bg-white/5 relative svelte-gsxx31" title="Generar reportes Excel"><svg class="w-5 h-5 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" class="svelte-gsxx31"></path></svg> <span class="text-sm font-medium hidden lg:inline svelte-gsxx31">Reporte Excel</span> <!></button> <button class="inline-flex items-center justify-center gap-2 px-3 lg:px-4 py-2 lg:py-3 border rounded-lg transition-all duration-200 hover:bg-black/5 dark:hover:bg-white/5 svelte-gsxx31" title="Ver reporte online"><svg class="w-5 h-5 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" class="svelte-gsxx31"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" class="svelte-gsxx31"></path></svg> <span class="text-sm font-medium hidden lg:inline svelte-gsxx31">Ver Online</span></button> <button class="inline-flex items-center justify-center gap-2 px-3 lg:px-4 py-2 lg:py-3 border rounded-lg transition-all duration-200 hover:bg-black/5 dark:hover:bg-white/5 svelte-gsxx31" title="Abrir Looker Studio"><svg class="w-5 h-5 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" class="svelte-gsxx31"></path></svg> <span class="text-sm font-medium hidden lg:inline svelte-gsxx31">Looker Studio</span></button> <button class="inline-flex items-center justify-center gap-2 px-3 lg:px-4 py-2 lg:py-3 border rounded-lg transition-all duration-200 hover:bg-black/5 dark:hover:bg-white/5 svelte-gsxx31" title="Volver al Dashboard"><svg class="w-5 h-5 svelte-gsxx31" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" class="svelte-gsxx31"></path></svg> <span class="text-sm font-medium hidden lg:inline svelte-gsxx31">Dashboard</span></button> <div class="relative svelte-gsxx31"><button class="inline-flex items-center justify-center gap-2 px-3 lg:px-4 py-2 lg:py-3 border rounded-lg transition-all duration-200 hover:bg-black/5 dark:hover:bg-white/5 w-full svelte-gsxx31" aria-label="Cambiar tema"><!> <span class="text-sm font-medium hidden lg:inline capitalize svelte-gsxx31"> </span></button></div></div></div></aside> <main class="flex-1 p-4 sm:p-6 lg:p-8 overflow-y-auto svelte-gsxx31"><div class="max-w-4xl mx-auto rounded-2xl p-6 lg:p-8 transition-colors duration-200 border svelte-gsxx31"><!> <!> <!> <form class="space-y-6 svelte-gsxx31"><div class="grid grid-cols-1 md:grid-cols-2 gap-6 svelte-gsxx31"><div class="space-y-2 svelte-gsxx31"><label for="docente" class="block text-sm font-medium svelte-gsxx31">Docente</label> <select id="docente" name="docente" required=""><option class="svelte-gsxx31"> </option><!></select></div> <div><div class="flex items-center justify-between svelte-gsxx31"><label for="materia" class="block text-sm font-medium svelte-gsxx31">Materia</label></div> <!></div></div> <div class="grid grid-cols-1 md:grid-cols-2 gap-6 svelte-gsxx31"><div class="space-y-2 svelte-gsxx31"><label for="horas" class="block text-sm font-medium svelte-gsxx31">Cantidad de Horas</label> <select id="horas" name="horas" required=""><option class="svelte-gsxx31">Seleccione horas</option><option class="svelte-gsxx31">Sin hora espec√≠fica</option><!></select></div> <div class="space-y-2 svelte-gsxx31"><label for="grado" class="block text-sm font-medium svelte-gsxx31">Grado</label> <select id="grado" name="grado" required=""><option class="svelte-gsxx31"> </option><!></select></div></div> <!> <div class="grid grid-cols-1 md:grid-cols-2 gap-6 svelte-gsxx31"><div class="space-y-2 svelte-gsxx31"><label for="fecha" class="block text-sm font-medium svelte-gsxx31">Fecha</label> <input type="date" id="fecha" name="fecha" required="" class="w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-indigo-500 transition-all outline-none svelte-gsxx31"/></div> <div class="space-y-2 svelte-gsxx31"><label for="observaciones" class="block text-sm font-medium svelte-gsxx31">Observaciones</label> <textarea id="observaciones" name="observaciones" rows="3" placeholder="Opcional..." class="w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-indigo-500 transition-all outline-none resize-none svelte-gsxx31"></textarea></div></div> <div class="flex items-center justify-between pt-6 border-t svelte-gsxx31"><div class="text-sm font-medium svelte-gsxx31">Inasistencias marcadas: <span class="text-indigo-500 font-bold ml-1 svelte-gsxx31"> </span></div></div></form></div></main> <button class="fixed bottom-6 right-6 lg:bottom-10 lg:right-10 bg-green-600 hover:bg-green-700 text-white p-4 lg:p-5 rounded-full shadow-2xl hover:shadow-green-500/20 transform transition-all duration-300 hover:scale-110 active:scale-95 disabled:opacity-50 disabled:grayscale disabled:cursor-not-allowed z-50 group svelte-gsxx31" title="Guardar inasistencias"><!> <!></button></div> <!> <!> <!>',1);function cs(Fr,lr){No(lr,!1);const v=()=>Mt(ft,"$theme",er),[er,ye]=zt(),F=k(),t=k(),Se=k(),s=k(),P=k(),we=k(),$e=k(),Ve="¬°Nueva funci√≥n de filtrado avanzado disponible!",nr="¬°Nueva funci√≥n de reporte en Excel disponible!";let L=Hr(lr,"onBack",8),W=k([]),c=k([]),rr=k([]),ge=k(!1),Re=k(!1),Ce=k(!1),g=k({docente:localStorage.getItem("lastDocente")||"",materia:"",horas:"",grado:"",fecha:new Date().toLocaleDateString("en-CA"),observaciones:""}),q=k([]),Je=k({}),Ne=k({}),or=k(!1),R=k(!1),pe=k([]),D=k(!1),O=k(!1),ue=k(!1);const Pe=()=>{p(D,!0)},tr=()=>{p(D,!1)},Ae=()=>{p(O,!0)},$=()=>{p(O,!1)},T=()=>{p(ue,!0)},X=()=>{p(ue,!1)};let fe=k(localStorage.getItem("dismissedInfoInasistenciaContent")!==dt),he=k(!0),G=k(!0);function Y(n){return!0}const me=()=>{localStorage.setItem("dismissedInfoInasistenciaContent",dt),p(fe,!1)},Te=()=>{localStorage.setItem("dismissedFeatureAlertFilters",new Date().toISOString()),p(he,!1)},_e=()=>{localStorage.setItem("dismissedFeatureAlertFilters",new Date().toISOString()),Pe()},De=()=>{localStorage.setItem("dismissedFeatureAlertReport",new Date().toISOString()),p(G,!1)},se=()=>{localStorage.setItem("dismissedFeatureAlertReport",new Date().toISOString()),Ae(),p(G,!1)};let d=k(JSON.parse(localStorage.getItem("docenteMaterias")||"{}"));const _=(n,l)=>{!n||!l||(e(d)[n]||Me(d,e(d)[n]=[]),e(d)[n].includes(l)||(Me(d,e(d)[n]=[...e(d)[n],l]),localStorage.setItem("docenteMaterias",JSON.stringify(e(d)))))},y=()=>`https://docs.google.com/spreadsheets/d/${go}`,S=()=>{window.open(y(),"_blank")},I=()=>{window.open(Rt,"_blank")},M=n=>{const l=n.match(/-(\d+)$/);return l?l[1]:null},te=[{value:"Sin excusa",label:"Sin excusa",icon:"üö´",bgColor:"bg-red-50",borderColor:"border-red-300",textColor:"text-red-700",darkBgColor:"dark:bg-red-950",darkBorderColor:"dark:border-red-800",darkTextColor:"dark:text-red-300",obligaHoras:!0},{value:"Excusa",label:"Excusa",icon:"üìÑ",bgColor:"bg-blue-50",borderColor:"border-blue-300",textColor:"text-blue-700",darkBgColor:"dark:bg-blue-950",darkBorderColor:"dark:border-blue-800",darkTextColor:"dark:text-blue-300",obligaHoras:!0},{value:"LLegada Tarde",label:"Llegada Tarde",icon:"‚è∞",bgColor:"bg-indigo-50",borderColor:"border-indigo-300",textColor:"text-indigo-700",darkBgColor:"dark:bg-indigo-950",darkBorderColor:"dark:border-indigo-800",darkTextColor:"dark:text-indigo-300",obligaHoras:!1},{value:"Transporte Escolar",label:"Transporte Escolar",icon:"üöå",bgColor:"bg-red-50",borderColor:"border-red-300",textColor:"text-red-700",darkBgColor:"dark:bg-red-950",darkBorderColor:"dark:border-red-800",darkTextColor:"dark:text-red-300",obligaHoras:!0},{value:"Permiso",label:"Permiso",icon:"‚úÖ",bgColor:"bg-green-50",borderColor:"border-green-300",textColor:"text-green-700",darkBgColor:"dark:bg-green-950",darkBorderColor:"dark:border-green-800",darkTextColor:"dark:text-green-300",obligaHoras:!0},{value:"No portar/sin uniforme",label:"No portar/sin uniforme",icon:"üëö",bgColor:"bg-cyan-50",borderColor:"border-cyan-300",textColor:"text-cyan-700",darkBgColor:"dark:bg-cyan-950",darkBorderColor:"dark:border-cyan-800",darkTextColor:"dark:text-cyan-300",obligaHoras:!1},{value:"Pacto de Aula",label:"Pacto de Aula",icon:"ü§ù",bgColor:"bg-purple-50",borderColor:"border-purple-300",textColor:"text-purple-700",darkBgColor:"dark:bg-purple-950",darkBorderColor:"dark:border-purple-800",darkTextColor:"dark:text-purple-300",obligaHoras:!1},{value:"Uso del celular",label:"Uso del celular",icon:"üì±",bgColor:"bg-orange-50",borderColor:"border-orange-300",textColor:"text-orange-700",darkBgColor:"dark:bg-orange-950",darkBorderColor:"dark:border-orange-800",darkTextColor:"dark:text-orange-300",obligaHoras:!1},{value:"Desorden en Clase",label:"Desorden en Clase",icon:"üîä",bgColor:"bg-yellow-50",borderColor:"border-yellow-300",textColor:"text-yellow-700",darkBgColor:"dark:bg-yellow-950",darkBorderColor:"dark:border-yellow-800",darkTextColor:"dark:text-yellow-300",obligaHoras:!1},{value:"Fuga",label:"Fuga",icon:"üèÉ‚Äç‚ôÇÔ∏è",bgColor:"bg-red-100",borderColor:"border-red-400",textColor:"text-red-800",darkBgColor:"dark:bg-red-950",darkBorderColor:"dark:border-red-800",darkTextColor:"dark:text-red-300",obligaHoras:!0},{value:"No realizaci√≥n de Aseo",label:"No realizaci√≥n de Aseo",icon:"üßπ",bgColor:"bg-teal-50",borderColor:"border-teal-300",textColor:"text-teal-700",darkBgColor:"dark:bg-teal-950",darkBorderColor:"dark:border-teal-800",darkTextColor:"dark:text-teal-300",obligaHoras:!1},{value:"Licencia por salud",label:"Licencia por salud",icon:"üè•",bgColor:"bg-cyan-50",borderColor:"border-cyan-300",textColor:"text-cyan-700",darkBgColor:"dark:bg-cyan-950",darkBorderColor:"dark:border-cyan-800",darkTextColor:"dark:text-cyan-300",obligaHoras:!0},{value:"Incapacidad",label:"Incapacidad",icon:"ü©∫",bgColor:"bg-pink-50",borderColor:"border-pink-300",textColor:"text-pink-700",darkBgColor:"dark:bg-pink-950",darkBorderColor:"dark:border-pink-800",darkTextColor:"dark:text-pink-300",obligaHoras:!0},{value:"Reuni√≥n interna",label:"Reuni√≥n interna",icon:"üë•",bgColor:"bg-zinc-50",borderColor:"border-zinc-300",textColor:"text-zinc-700",darkBgColor:"dark:bg-zinc-950",darkBorderColor:"dark:border-zinc-800",darkTextColor:"dark:text-zinc-300",obligaHoras:!1},{value:"Ignorar",label:"Ignorar",icon:"üö´",bgColor:"bg-zinc-50",borderColor:"border-zinc-300",textColor:"text-zinc-700",darkBgColor:"dark:bg-zinc-950",darkBorderColor:"dark:border-zinc-800",darkTextColor:"dark:text-zinc-300",obligaHoras:!1},{value:"Psicoorientaci√≥n",label:"Psicoorientaci√≥n",icon:"üß†",bgColor:"bg-green-50",borderColor:"border-green-300",textColor:"text-green-700",darkBgColor:"dark:bg-green-950",darkBorderColor:"dark:border-green-800",darkTextColor:"dark:text-green-300",obligaHoras:!1},{value:"Retirado por el acudiente",label:"Retirado por el acudiente",icon:"üë®",bgColor:"bg-green-50",borderColor:"border-green-300",textColor:"text-green-700",darkBgColor:"dark:bg-green-950",darkBorderColor:"dark:border-green-800",darkTextColor:"dark:text-green-300",obligaHoras:!1}],Fe=()=>{ft.update(n=>n==="light"?"dim":n==="dim"?"dark":"light")},h=async()=>{p(ge,!0),p(Re,!0),p(Ce,!0);try{const[n,l,u]=await Promise.all([Uo(),Wo(),qo()]);p(W,n),p(c,l),p(rr,u)}catch(n){console.error("Error cargando datos iniciales:",n)}finally{p(ge,!1),p(Re,!1),p(Ce,!1)}},j=(n,l)=>{p(q,e(q).filter(u=>!(u.nombre===n&&u.motivo===l)))},le=(n,l,u)=>{if(l===""||l==="Ignorar"){p(q,e(q).filter(A=>A.nombre!==n));return}const C=te.find(A=>A.value===l);if(!C)return;let V=e(Je)[n]||e(g).horas;if(C.obligaHoras||(V="0"),C.obligaHoras&&p(q,e(q).filter(A=>{if(A.nombre!==n)return!0;const K=te.find(re=>re.value===A.motivo);return K&&!K.obligaHoras})),!e(q).some(A=>A.nombre===n&&A.motivo===l)){const A=e(q).find(K=>K.nombre===n)?.observaciones||"";p(q,[...e(q),{nombre:n,motivo:l,horas:V,observaciones:A}])}},Z=(n,l)=>{p(q,e(q).map(u=>u.nombre===n?{...u,observaciones:l}:u))},xe=n=>{Me(Ne,e(Ne)[n]=!e(Ne)[n])},He=(n,l)=>{Me(Je,e(Je)[n]=l),p(q,e(q).map(u=>{if(u.nombre===n){const C=te.find(V=>V.value===u.motivo);if(C&&C.obligaHoras)return{...u,horas:l}}return u}))},H=async n=>{if(n.preventDefault(),e(or))return;p(R,!0);const l=[];if(e(g).docente||l.push({id:"docente",label:"Docente"}),e(g).fecha||l.push({id:"fecha",label:"Fecha"}),e(g).grado||l.push({id:"grado",label:"Grado"}),e(t))if(e(pe).length===0)l.push({id:"materia",label:"Materia(s)"});else{const u=e(pe).filter(C=>!C.horas);u.length>0&&l.push({id:"horas",label:`Horas para: ${u.map(C=>C.materia).join(", ")}`})}else e(g).materia||l.push({id:"materia",label:"Materia"}),e(g).horas||l.push({id:"horas",label:"Horas"});if(l.length>0){await Ge.fire({icon:"warning",title:"Campos requeridos",html:`Complete los siguientes campos:<br/><br/><strong>${l.map(C=>C.label).join("<br/>")}</strong>`,confirmButtonColor:"#6366f1"});const u=document.getElementById(l[0].id);u&&(u.scrollIntoView({behavior:"smooth",block:"center"}),u.focus());return}if(e(q).length===0){await Ge.fire({icon:"warning",title:"Sin inasistencias",text:"Debe seleccionar al menos un estudiante con un motivo de inasistencia",confirmButtonColor:"#6366f1"});return}p(or,!0);try{const u=new Date().toISOString(),C=e(t)?e(pe):[{materia:e(g).materia,horas:e(g).horas}];if(e(t)&&e(pe).length===0){await Ge.fire({icon:"warning",title:"Atenci√≥n",text:"Seleccione al menos una materia",confirmButtonColor:"#6366f1"});return}const V=C.filter(K=>!K.horas);if(V.length>0){await Ge.fire({icon:"warning",title:"Atenci√≥n",text:`Seleccione horas para: ${V.map(K=>K.materia).join(", ")}`,confirmButtonColor:"#6366f1"});return}const U=[],A=e(q).filter(K=>K.motivo&&K.motivo!=="Ignorar");for(const K of C)for(const re of A)U.push([u,e(g).docente,e(g).fecha,K.horas,K.materia,re.motivo,e(g).grado,re.nombre,re.observaciones||e(g).observaciones]);await Nt({spreadsheetId:go,worksheetTitle:Vo,inasistencias:U});for(const K of C)_(e(g).docente,K.materia);await Ge.fire({icon:"success",title:"¬°√âxito!",text:`${U.length} inasistencia(s) registrada(s) exitosamente`,timer:3e3,timerProgressBar:!0,showConfirmButton:!1,position:"top-end",toast:!0}),p(g,{...e(g),grado:"",fecha:new Date().toLocaleDateString("en-CA"),observaciones:"",horas:""}),p(q,[]),p(Je,{}),p(Ne,{}),p(pe,[]),p(R,!1)}catch(u){console.error("Error enviando:",u),await Ge.fire({icon:"error",title:"Error",text:"Error al registrar la inasistencia",confirmButtonColor:"#ef4444"})}finally{p(or,!1)}};Po(()=>{h(),p(he,Y()),p(G,Y())}),qe(()=>e(g),()=>{p(t,e(g).docente.includes("-"))}),qe(()=>(e(g),e(t),e(pe)),()=>{p(F,(()=>{const n=[];return e(g).docente||n.push("docente"),e(g).fecha||n.push("fecha"),e(g).grado||n.push("grado"),e(t)?e(pe).length===0?n.push("materias"):e(pe).filter(u=>!u.horas).length>0&&n.push("horas"):(e(g).materia||n.push("materia"),e(g).horas||n.push("horas")),n})())}),qe(()=>e(g),()=>{e(g).docente&&localStorage.setItem("lastDocente",e(g).docente)}),qe(()=>(e(g),e(c),e(d)),()=>{p(Se,e(g).docente?[...e(c)].sort((n,l)=>{const u=e(d)[e(g).docente]?.includes(n.materia),C=e(d)[e(g).docente]?.includes(l.materia);return u&&!C?-1:!u&&C?1:n.materia.localeCompare(l.materia)}):e(c))}),qe(()=>{},()=>{p(s,{bg:"rgb(var(--bg-primary))",text:"rgb(var(--text-primary))",label:"rgb(var(--text-secondary))",border:"rgb(var(--border-primary))",placeholder:"rgb(var(--text-muted))",icon:"rgb(var(--text-muted))",cardBg:"rgb(var(--card-bg))",cardBorder:"rgb(var(--card-border))",inputBg:"rgb(var(--bg-secondary))"})}),qe(()=>(e(g),e(rr)),()=>{p(P,e(g).grado?e(rr).filter(n=>n.grado.toString()===e(g).grado):[])}),qe(()=>e(g),()=>{p(we,M(e(g).docente))}),qe(()=>(e(we),e(rr)),()=>{p($e,e(we)?[...new Set(e(rr).map(n=>n.grado.toString()))].filter(n=>n.startsWith(`${e(we)}-`)):[...new Set(e(rr).map(n=>n.grado.toString()))].filter(n=>!n.includes("-")))}),Lo(),Oo();var b=ts(),m=mr(b),z=o(m),ae=o(z),ze=o(ae),Br=o(ze),po=a(Br,2),uo=a(ze,2),Sr=o(uo),kr=a(Sr,2),Yo=a(o(kr),4);{var Jo=n=>{var l=Ea();x(n,l)};ee(Yo,n=>{e(he)&&n(Jo)})}var wr=a(kr,2),Ko=a(o(wr),4);{var jr=n=>{var l=Ma();x(n,l)};ee(Ko,n=>{e(G)&&n(jr)})}var yr=a(wr,2),Ur=a(yr,2),Wr=a(Ur,2),Xo=a(Wr,2),qr=o(Xo),Yr=o(qr);{var bo=n=>{var l=za();x(n,l)},Jr=n=>{var l=Aa();x(n,l)},Zo=n=>{var l=Ta();x(n,l)};ee(Yr,n=>{v()==="dark"?n(bo):v()==="light"?n(Jr,1):n(Zo,!1)})}var Rr=a(Yr,2),Nr=o(Rr),xo=a(z,2),fo=o(xo),ho=o(fo);{var Qo=n=>{var l=Ha(),u=a(o(l),2),C=a(o(u),2),V=o(C),U=a(u,2);B(()=>f(V,dt)),N("click",U,me),x(n,l)};ee(ho,n=>{e(fe)&&n(Qo)})}var mo=a(ho,2);xt(mo,{featureMessage:Ve,description:"Ahora puedes filtrar tus datos de forma avanzada. ¬°Pru√©balo!",onTryNow:_e,onDismiss:Te,targetSelector:"#filter-button-target",showPopup:!1,colorTheme:"blue"});var Kr=a(mo,2);xt(Kr,{featureMessage:nr,description:"Ahora puedes generar reportes de inasistencias en formato Excel. ¬°Descarga y analiza tus datos!",onTryNow:se,onDismiss:De,targetSelector:"#report-button-target",showPopup:!1,colorTheme:"green"});var Dr=a(Kr,2),Ir=o(Dr),_o=o(Ir),ko=o(_o),Er=a(ko,2),Pr=o(Er),et=o(Pr);Pr.value=Pr.__value="";var wo=a(Pr);ve(wo,1,()=>e(W),be,(n,l)=>{var u=ja(),C=o(u),V={};B(()=>{f(C,e(l)),V!==(V=e(l))&&(u.value=(u.__value=e(l))??"")}),x(n,u)});var Xr=a(_o,2),Lr=o(Xr),rt=o(Lr),yo=a(Lr,2);{var Zr=n=>{var l=La();ve(l,5,()=>e(Se),be,(u,C)=>{const V=vr(()=>(e(d),e(g),e(C),r(()=>e(d)[e(g).docente]?.includes(e(C).materia)))),U=vr(()=>(e(pe),e(C),r(()=>e(pe).findIndex(Le=>Le.materia===e(C).materia)))),A=vr(()=>e(U)>=0);var K=Pa(),re=o(K),Q=o(re),ne=a(Q,2),Ue=o(ne),Xe=a(re,2);{var xr=Le=>{var Ze=Na(),ar=o(Ze);ar.value=ar.__value="";var sr=a(ar);sr.value=sr.__value="0";var gr=a(sr);ve(gr,0,()=>[1,2,3,4],be,(ir,pr)=>{var Oe=Ra(),fr=o(Oe),Ee={};B(ur=>{f(fr,`${pr??""}h`),Ee!==(Ee=ur)&&(Oe.value=(Oe.__value=ur)??"")},[()=>r(()=>pr.toString())]),x(ir,Oe)}),B((ir,pr)=>{dr(Ze,1,`w-full lg:w-16 px-2 py-1.5 lg:py-1 text-sm rounded border appearance-none cursor-pointer ${ir??""}`,"svelte-gsxx31"),i(Ze,`background-color: ${e(s),r(()=>e(s).inputBg)??""}; border-color: ${pr??""}; color: ${e(s),r(()=>e(s).text)??""};`)},[()=>(e(R),e(F),e(pe),Be(e(U)),r(()=>e(R)&&e(F).includes("horas")&&!e(pe)[e(U)].horas?"ring-2 ring-red-500 border-red-500":"")),()=>(e(R),e(F),e(pe),Be(e(U)),e(s),r(()=>e(R)&&e(F).includes("horas")&&!e(pe)[e(U)].horas?"#ef4444":e(s).border))]),Ye(Ze,()=>e(pe)[e(U)].horas,ir=>(Me(pe,e(pe)[e(U)].horas=ir),We(()=>{e(U),e(R),e(F),e(s)}))),x(Le,Ze)};ee(Xe,Le=>{e(A)&&Le(xr)})}B(()=>{dr(K,1,`flex flex-col lg:flex-row lg:items-center gap-1 lg:gap-2 px-2 py-2 lg:py-1.5 rounded-lg border transition-all ${e(A)?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/30 dark:border-indigo-500":"border-transparent"}`,"svelte-gsxx31"),i(K,`border-color: ${Be(e(A)),e(s),r(()=>e(A)?"#6366f1":e(s).border)??""};`),At(Q,e(A)),i(ne,`color: ${e(s),r(()=>e(s).text)??""};`),f(Ue,`${e(V)?"‚≠ê ":""}${e(C),r(()=>e(C).materia)??""}`)}),N("change",Q,Le=>{Le.currentTarget.checked?p(pe,[...e(pe),{materia:e(C).materia,horas:""}]):p(pe,e(pe).filter(Ze=>Ze.materia!==e(C).materia))}),x(u,K)}),B((u,C)=>{dr(l,1,`border rounded-xl p-2 lg:p-3 flex flex-col lg:flex-row lg:flex-wrap gap-2 lg:gap-2 ${u??""}`,"svelte-gsxx31"),i(l,`border-color: ${C??""}; background-color: ${e(s),r(()=>e(s).inputBg)??""};`)},[()=>(e(R),e(F),r(()=>e(R)&&e(F).includes("materias")?"ring-2 ring-red-500 border-red-500":"")),()=>(e(R),e(F),e(s),r(()=>e(R)&&e(F).includes("materias")?"#ef4444":e(s).border))]),x(n,l)},ot=n=>{var l=Ga(),u=o(l),C=o(u);u.value=u.__value="";var V=a(u);ve(V,1,()=>e(Se),be,(U,A)=>{const K=vr(()=>(e(d),e(g),e(A),r(()=>e(d)[e(g).docente]?.includes(e(A).materia))));var re=Oa(),Q=o(re),ne={};B(()=>{i(re,e(K)?"color: #6366f1; font-weight: 600;":""),f(Q,`${e(K)?"‚≠ê ":""}${e(A),r(()=>e(A).materia)??""}`),ne!==(ne=(e(A),r(()=>e(A).materia)))&&(re.value=(re.__value=(e(A),r(()=>e(A).materia)))??"")}),x(U,re)}),B((U,A)=>{l.disabled=e(Re),dr(l,1,`w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-indigo-500 transition-all outline-none appearance-none cursor-pointer disabled:opacity-50 ${U??""}`,"svelte-gsxx31"),i(l,`background-color: ${e(s),r(()=>e(s).inputBg)??""}; border-color: ${A??""}; color: ${e(s),r(()=>e(s).text)??""};`),f(C,e(Re)?"Cargando...":"Seleccione materia")},[()=>(e(R),e(F),r(()=>e(R)&&e(F).includes("materia")?"ring-2 ring-red-500 border-red-500":"")),()=>(e(R),e(F),e(s),r(()=>e(R)&&e(F).includes("materia")?"#ef4444":e(s).border))]),Ye(l,()=>e(g).materia,U=>(Me(g,e(g).materia=U),We(()=>{e(ge),e(R),e(F),e(s),e(W),e(Re),e(Se),e(d),e(Ce),e($e)}))),x(n,l)};ee(yo,n=>{e(t)?n(Zr):n(ot,!1)})}var Qr=a(Ir,2),eo=o(Qr),$o=o(eo),Or=a($o,2),ro=o(Or);ro.value=ro.__value="";var oo=a(ro);oo.value=oo.__value="0";var tt=a(oo);ve(tt,0,()=>[1,2,3,4],be,(n,l)=>{var u=Va(),C=o(u),V={};B(U=>{f(C,`${l??""} ${l===1?"Hora":"Horas"}`),V!==(V=U)&&(u.value=(u.__value=U)??"")},[()=>r(()=>l.toString())]),x(n,u)});var E=a(eo,2),J=o(E),ce=a(J,2),Ie=o(ce),Ke=o(Ie);Ie.value=Ie.__value="";var $r=a(Ie);ve($r,1,()=>e($e),be,(n,l)=>{var u=Ua(),C=o(u),V={};B(U=>{f(C,U),V!==(V=e(l))&&(u.value=(u.__value=e(l))??"")},[()=>(e(l),r(()=>e(l).replace(/0(\d)$/,"¬∞$1").replace(/(\d{1,2})0(\d)/,"$1¬∞$2")))]),x(n,u)});var Co=a(Qr,2);{var Fo=n=>{var l=Qa(),u=o(l),C=o(u),V=a(u,2),U=o(V);ve(U,1,()=>e(P),re=>re.nombre,(re,Q)=>{const ne=vr(()=>(e(q),e(Q),r(()=>e(q).filter(de=>de.nombre===e(Q).nombre)))),Ue=vr(()=>(Be(e(ne)),r(()=>e(ne).length>0))),Xe=vr(()=>(Be(e(ne)),r(()=>e(ne).some(de=>{const ie=te.find(oe=>oe.value===de.motivo);return ie&&ie.obligaHoras}))));var xr=Xa(),Le=mr(xr);let Ze;var ar=o(Le),sr=o(ar),gr=o(sr),ir=a(sr,2);ve(ir,5,()=>e(ne),be,(de,ie)=>{const oe=vr(()=>(e(ie),r(()=>te.find(Tr=>Tr.value===e(ie).motivo))));var br=mt(),Gr=mr(br);{var Ar=Tr=>{var ct=Wa(),pt=o(ct),Dt=o(pt),ut=a(pt),It=a(ut);B(()=>{dr(ct,1,(Be(e(oe)),r(()=>`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-semibold border ${e(oe).bgColor} ${e(oe).textColor} ${e(oe).borderColor} ${e(oe).darkBgColor} ${e(oe).darkTextColor} ${e(oe).darkBorderColor}`)),"svelte-gsxx31"),f(Dt,(Be(e(oe)),r(()=>e(oe).icon))),f(ut,` ${Be(e(oe)),r(()=>e(oe).label)??""} `)}),N("click",It,()=>j(e(Q).nombre,e(ie).motivo)),x(Tr,ct)};ee(Gr,Tr=>{e(oe)&&Tr(Ar)})}x(de,br)});var pr=a(ar,2),Oe=o(pr);let fr;var Ee=o(Oe),ur=o(Ee);ur.value=ur.__value="";var Qe=a(ur);Qe.value=Qe.__value="0";var je=a(Qe);ve(je,0,()=>[1,2,3,4],be,(de,ie)=>{var oe=qa(),br=o(oe),Gr={};B(Ar=>{f(br,ie),Gr!==(Gr=Ar)&&(oe.value=(oe.__value=Ar)??"")},[()=>r(()=>ie.toString())]),x(de,oe)});var ke;Tt(Ee);var cr=a(Ee,2),zr=a(Oe,2),Cr=o(zr),vo=o(Cr);vo.value=vo.__value="";var it=a(vo);it.value=it.__value="Ignorar";var yt=a(it);ve(yt,1,()=>te,be,(de,ie)=>{const oe=vr(()=>(Be(e(ne)),e(ie),r(()=>e(ne).some(Tr=>Tr.motivo===e(ie).value))));var br=Ya(),Gr=o(br),Ar={};B(()=>{br.disabled=e(oe),f(Gr,`${e(ie),r(()=>e(ie).icon)??""} ${e(ie),r(()=>e(ie).label)??""} ${e(oe)?"‚úì":""}`),Ar!==(Ar=(e(ie),r(()=>e(ie).value)))&&(br.value=(br.__value=(e(ie),r(()=>e(ie).value)))??"")}),x(de,br)}),Cr.value=Cr.__value="";var $t=a(Cr,2),Ct=a(pr,2);{var Ft=de=>{var ie=Ja(),oe=o(ie);B(()=>i(oe,`color: ${Be(e(ne)),e(s),r(()=>e(ne)[0]?.observaciones?"rgb(var(--text-primary))":e(s).icon)??""};`)),N("click",oe,()=>xe(e(Q).nombre)),x(de,ie)};ee(Ct,de=>{e(Ue)&&de(Ft)})}var Bt=a(Le,2);{var St=de=>{var ie=Ka(),oe=o(ie);B(()=>{jt(oe,(Be(e(ne)),r(()=>e(ne)[0]?.observaciones||""))),i(oe,`background-color: ${e(s),r(()=>e(s).inputBg)??""}; border-color: ${e(s),r(()=>e(s).border)??""}; color: ${e(s),r(()=>e(s).text)??""};`)}),N("input",oe,br=>Z(e(Q).nombre,br.currentTarget.value)),x(de,ie)};ee(Bt,de=>{Be(e(Ue)),e(Ne),e(Q),Be(e(ne)),r(()=>e(Ue)&&(e(Ne)[e(Q).nombre]||e(ne)[0]?.observaciones))&&de(St)})}B(de=>{Ze=dr(Le,1,"flex flex-col sm:flex-row sm:items-center justify-between p-4 border rounded-xl transition-all duration-200 gap-4 svelte-gsxx31",null,Ze,{"ring-2":e(Ue),"ring-indigo-500":e(Ue)}),i(Le,`background-color: ${e(s),r(()=>e(s).bg)??""}; border-color: ${Be(e(Ue)),e(s),r(()=>e(Ue)?"transparent":e(s).border)??""};`),i(sr,`color: ${e(s),r(()=>e(s).text)??""};`),f(gr,(e(Q),r(()=>e(Q).nombre))),fr=dr(Oe,1,"relative w-full sm:w-32 transition-opacity duration-200 svelte-gsxx31",null,fr,{"opacity-40":!e(Xe)}),Ee.disabled=!e(Xe),i(Ee,`background-color: ${e(s),r(()=>e(s).inputBg)??""}; border-color: ${e(s),r(()=>e(s).border)??""}; color: ${e(s),r(()=>e(s).text)??""};`),ke!==(ke=de)&&(Ee.value=(Ee.__value=de)??"",Ht(Ee,de)),i(cr,`color: ${e(s),r(()=>e(s).icon)??""};`),i(Cr,`background-color: ${e(s),r(()=>e(s).inputBg)??""}; border-color: ${e(s),r(()=>e(s).border)??""}; color: ${e(s),r(()=>e(s).text)??""};`),i($t,`color: ${e(s),r(()=>e(s).icon)??""};`)},[()=>(Be(e(ne)),e(Je),e(Q),e(g),r(()=>e(ne).find(de=>{const ie=te.find(oe=>oe.value===de.motivo);return ie&&ie.obligaHoras})?.horas||e(Je)[e(Q).nombre]||e(g).horas))]),N("change",Ee,de=>He(e(Q).nombre,de.currentTarget.value)),N("change",Cr,de=>{le(e(Q).nombre,de.currentTarget.value),de.currentTarget.value=""}),x(re,xr)});var A=a(U,2);{var K=re=>{var Q=Za();B(()=>i(Q,`color: ${e(s),r(()=>e(s).text)??""};`)),x(re,Q)};ee(A,re=>{e(P),r(()=>e(P).length===0)&&re(K)})}B(()=>{i(u,`color: ${e(s),r(()=>e(s).label)??""};`),f(C,`Estudiantes del Grado ${e(g),r(()=>e(g).grado)??""}`),i(V,`border-color: ${e(s),r(()=>e(s).border)??""};`)}),x(n,l)};ee(Co,n=>{e(g),r(()=>e(g).grado&&e(g).horas!=="")&&n(Fo)})}var to=a(Co,2),ao=o(to),so=o(ao),lo=a(so,2),Bo=a(ao,2),no=o(Bo),So=a(no,2),Do=a(to,2),io=o(Do),Io=a(o(io)),at=o(Io),Mr=a(xo,2),Eo=o(Mr);{var Mo=n=>{var l=es();x(n,l)},zo=n=>{var l=rs();x(n,l)};ee(Eo,n=>{e(or)?n(Mo):n(zo,!1)})}var Ao=a(Eo,2);{var To=n=>{var l=os(),u=o(l);B(()=>f(u,(e(q),r(()=>e(q).length)))),x(n,l)};ee(Ao,n=>{e(or),e(q),r(()=>!e(or)&&e(q).length>0)&&n(To)})}var co=a(m,2);{var Ho=n=>{na(n,{onClose:tr,get selectedDocente(){return e(g),r(()=>e(g).docente)}})};ee(co,n=>{e(D)&&n(Ho)})}var jo=a(co,2);{var st=n=>{Ia(n,{onClose:$,get initialDocente(){return e(g),r(()=>e(g).docente)}})};ee(jo,n=>{e(O)&&n(st)})}var lt=a(jo,2);{var nt=n=>{wt(n,{onClose:X,get initialDocente(){return e(g),r(()=>e(g).docente)}})};ee(lt,n=>{e(ue)&&n(nt)})}B((n,l,u,C,V,U)=>{i(m,`background-color: ${e(s),r(()=>e(s).bg)??""};`),i(z,`background-color: ${e(s),r(()=>e(s).cardBg)??""}; border-color: ${e(s),r(()=>e(s).cardBorder)??""};`),hr(Br,"src",kt),i(po,`color: ${e(s),r(()=>e(s).text)??""};`),i(Sr,`background-color: ${e(s),r(()=>e(s).inputBg)??""}; border-color: ${e(s),r(()=>e(s).border)??""}; color: ${e(s),r(()=>e(s).text)??""};`),i(kr,`background-color: ${e(s),r(()=>e(s).inputBg)??""}; border-color: ${e(s),r(()=>e(s).border)??""}; color: ${e(s),r(()=>e(s).text)??""};`),i(wr,`background-color: ${e(s),r(()=>e(s).inputBg)??""}; border-color: ${e(s),r(()=>e(s).border)??""}; color: ${e(s),r(()=>e(s).text)??""};`),i(yr,`background-color: ${e(s),r(()=>e(s).inputBg)??""}; border-color: ${e(s),r(()=>e(s).border)??""}; color: ${e(s),r(()=>e(s).text)??""};`),i(Ur,`background-color: ${e(s),r(()=>e(s).inputBg)??""}; border-color: ${e(s),r(()=>e(s).border)??""}; color: ${e(s),r(()=>e(s).text)??""};`),i(Wr,`background-color: ${e(s),r(()=>e(s).inputBg)??""}; border-color: ${e(s),r(()=>e(s).border)??""}; color: ${e(s),r(()=>e(s).text)??""};`),i(qr,`background-color: ${e(s),r(()=>e(s).inputBg)??""}; border-color: ${e(s),r(()=>e(s).border)??""}; color: ${e(s),r(()=>e(s).text)??""};`),f(Nr,v()),i(fo,`background-color: ${e(s),r(()=>e(s).cardBg)??""}; border-color: ${e(s),r(()=>e(s).cardBorder)??""};`),i(ko,`color: ${e(s),r(()=>e(s).label)??""};`),Er.disabled=e(ge),dr(Er,1,`w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-indigo-500 transition-all outline-none appearance-none cursor-pointer disabled:opacity-50 ${n??""}`,"svelte-gsxx31"),i(Er,`background-color: ${e(s),r(()=>e(s).inputBg)??""}; border-color: ${l??""}; color: ${e(s),r(()=>e(s).text)??""};`),f(et,e(ge)?"Cargando...":"Seleccione docente"),dr(Xr,1,`space-y-2 ${e(t)?"lg:col-span-2":""}`,"svelte-gsxx31"),i(rt,`color: ${e(s),r(()=>e(s).label)??""};`),i($o,`color: ${e(s),r(()=>e(s).label)??""};`),dr(Or,1,`w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-indigo-500 transition-all outline-none appearance-none cursor-pointer ${u??""}`,"svelte-gsxx31"),i(Or,`background-color: ${e(s),r(()=>e(s).inputBg)??""}; border-color: ${C??""}; color: ${e(s),r(()=>e(s).text)??""};`),i(J,`color: ${e(s),r(()=>e(s).label)??""};`),ce.disabled=e(Ce),dr(ce,1,`w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-indigo-500 transition-all outline-none appearance-none cursor-pointer disabled:opacity-50 ${V??""}`,"svelte-gsxx31"),i(ce,`background-color: ${e(s),r(()=>e(s).inputBg)??""}; border-color: ${U??""}; color: ${e(s),r(()=>e(s).text)??""};`),f(Ke,e(Ce)?"Cargando...":"Seleccione grado"),i(so,`color: ${e(s),r(()=>e(s).label)??""};`),i(lo,`background-color: ${e(s),r(()=>e(s).inputBg)??""}; border-color: ${e(s),r(()=>e(s).border)??""}; color: ${e(s),r(()=>e(s).text)??""};`),i(no,`color: ${e(s),r(()=>e(s).label)??""};`),i(So,`background-color: ${e(s),r(()=>e(s).inputBg)??""}; border-color: ${e(s),r(()=>e(s).border)??""}; color: ${e(s),r(()=>e(s).text)??""};`),i(Do,`border-color: ${e(s),r(()=>e(s).border)??""};`),i(io,`color: ${e(s),r(()=>e(s).label)??""};`),f(at,(e(q),r(()=>e(q).length))),Mr.disabled=e(or)},[()=>(e(R),e(F),r(()=>e(R)&&e(F).includes("docente")?"ring-2 ring-red-500 border-red-500":"")),()=>(e(R),e(F),e(s),r(()=>e(R)&&e(F).includes("docente")?"#ef4444":e(s).border)),()=>(e(R),e(F),r(()=>e(R)&&e(F).includes("horas")?"ring-2 ring-red-500 border-red-500":"")),()=>(e(R),e(F),e(s),r(()=>e(R)&&e(F).includes("horas")?"#ef4444":e(s).border)),()=>(e(R),e(F),r(()=>e(R)&&e(F).includes("grado")?"ring-2 ring-red-500 border-red-500":"")),()=>(e(R),e(F),e(s),r(()=>e(R)&&e(F).includes("grado")?"#ef4444":e(s).border))]),N("click",Sr,S),N("click",kr,Pe),N("click",wr,Ae),N("click",yr,T),N("click",Ur,I),N("click",Wr,function(...n){L()?.apply(this,n)}),N("click",qr,Fe),Ye(Er,()=>e(g).docente,n=>(Me(g,e(g).docente=n),We(()=>{e(ge),e(R),e(F),e(s),e(W),e(Re),e(Se),e(d),e(Ce),e($e)}))),Ye(Or,()=>e(g).horas,n=>(Me(g,e(g).horas=n),We(()=>{e(ge),e(R),e(F),e(s),e(W),e(Re),e(Se),e(d),e(Ce),e($e)}))),Ye(ce,()=>e(g).grado,n=>(Me(g,e(g).grado=n),We(()=>{e(ge),e(R),e(F),e(s),e(W),e(Re),e(Se),e(d),e(Ce),e($e)}))),Ro(lo,()=>e(g).fecha,n=>(Me(g,e(g).fecha=n),We(()=>{e(ge),e(R),e(F),e(s),e(W),e(Re),e(Se),e(d),e(Ce),e($e)}))),Ro(So,()=>e(g).observaciones,n=>(Me(g,e(g).observaciones=n),We(()=>{e(ge),e(R),e(F),e(s),e(W),e(Re),e(Se),e(d),e(Ce),e($e)}))),N("submit",Dr,H),N("click",Mr,H),x(Fr,b),Go(),ye()}export{cs as default};
